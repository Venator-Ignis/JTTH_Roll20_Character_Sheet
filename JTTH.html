<div class="sheet-JTTH">
    <div class="sheet-section-roll">
        <input type="hidden" name="attr_advantagetoggle" class="sheet-roll-toggle">
        <div class="sheet-section-roll-advantage">
            <label class="sheet-roll-radio">
                <input type="radio" name="attr_advantagetoggle" value="{{query=1}} {{advantage=1}} {{r2=[[@{d20}">
                <span title="@{rtype}">Advantage</span>
            </label>
            <label class="sheet-roll-radio">
                <input type="radio" name="attr_advantagetoggle" value="{{query=1}} {{normal=1}} {{r2=[[0d20" checked="checked">
				<span title="@{rtype}">Normal</span>
            </label>
            <label class="sheet-roll-radio">
                <input type="radio" name="attr_advantagetoggle" value="{{query=1}} {{disadvantage=1}} {{r2=[[@{d20}">
                <span title="@{rtype}">Disadvantage</span>
            </label>
        </div>
        <input type="hidden" name="attr_wtype" class="sheet-roll-toggle">
        <div class="sheet-section-roll-whisper">
            <label class="sheet-radio">
                <input type="radio" name="attr_wtype" value="" checked="checked">
                <span title="@{wtype}">Public</span>
            </label>
            <label class="sheet-radio">
                <input type="radio" name="attr_wtype" value="/w gm ">
                <span title="@{wtype}">To GM</span>
            </label>
        </div>
    </div>
    <div class="sheet-section-pc">
        <div class="sheet-section-pc-header">
            <div class="sheet-section-pc-header-logo">
                <div></div>
            </div>
            <div class="sheet-section-pc-header-name">
                <input type="text" name="attr_character_name" title="@{character_name}">
            </div>
            <div class="sheet-section-pc-header-details">
                <div class="sheet-checkbox-cog">
                    <input type="checkbox" name="attr_options-class-selection"><span></span>
                    <span class="sheet-toggle-icon"></span>
                </div>
                <input type="checkbox" name="attr_options-class-selection" class="sheet-toggle" hidden>
                <div class="sheet-toggle-checked">
                    <div class="sheet-form">
                        <div class="sheet-form-header">Character Details</div>
                        <div class="sheet-form-body">
                            <div class="sheet-form-group">
                                <label>Dao:</label>
                                <div class="Main-Dao">
                                    <select name="attr_class" >
                                        <option value="" selected disabled>Please select an Dao</option>
                                        <option value="Beast Tamer">Beast Tamer</option>
                                        <option value="Body Refiner">Body Refiner</option>
                                        <option value="Bow">Bow</option>
                                        <option value="Buddhist">Buddhist</option>
                                        <option value="Corpse">Corpse</option>
                                        <option value="Elemental">Elemental</option>
                                        <option value="Ghost">Ghost</option>
                                        <option value="Music">Music</option>
                                        <option value="Poison">Poison</option>
                                        <option value="Psychic">Psychic</option>
                                        <option value="Puppet">Puppet</option>
                                        <option value="Sabre">Sabre</option>
                                        <option value="Spear">Spear</option>
                                        <option value="Sword">Sword</option>
                                    </select>
                                </div>
                                <label>Dao Path:</label>
                                <div class="Main-Path">
                                    <input type="hidden" type="text" name="attr_class" class="path-hider">
                                    <div class="No-Dao-Path">
                                        <select name="attr_subclass">
                                            <option value="none" selected disabled>Choose a Dao</option>
                                        <select>
                                    </div>  
                                    <div class="Beast-Tamer-Path">
                                        <select name="attr_subclass">
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option>No Paths</option>
                                        <select>
                                    </div>   
                                    <div class="Body-Refiner-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="Speed">Speed</option>
                                            <option value="Muscle">Muscle</option>
                                            <option value="Physique">Physique</option>
                                        </select>    
                                    </div> 
                                    <div class="Bow-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>
                                        </select>
                                    </div>
                                    <div class="Buddhist-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="Warrior">Warrior</option>
                                            <option value="Scholar">Scholar</option>
                                        </select>         
                                    </div>
                                    <div class="Corpse-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>        
                                        </select>         
                                    </div> 
                                    <div class="Elemental-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="Fire">Fire</option>
                                            <option value="Earth">Earth</option>
                                            <option value="Metal">Metal</option>
                                            <option value="Water">Water</option>
                                            <option value="Wood">Wood</option>
                                        </select>         
                                    </div>
                                    <div class="Ghost-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="Elusive">Elusive Specter</option>
                                            <option value="Vanishing">Vanishing Wraith</option>
                                            <option value="Vengeful">Vengeful Ghost</option>
                                        </select>         
                                    </div>
                                    <div class="Music-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="Guqin">Guqin</option>
                                            <option value="Zither">Zither</option>
                                        </select>         
                                    </div>
                                    <div class="Poison-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>
                                        </select>         
                                    </div>
                                    <div class="Psychic-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>
                                        </select>         
                                    </div>
                                    <div class="Puppet-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>
                                        </select>         
                                    </div>
                                    <div class="Sabre-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>
                                        </select>         
                                    </div>
                                    <div class="Spear-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="No Paths">No Paths</option>
                                        </select>         
                                    </div>
                                    <div class="Sword-Path">
                                        <select name="attr_subclass"> 
                                            <option value="none" selected disabled>Choose a Path</option>
                                            <option value="Dual Wield">Dual-Wield</option>
                                            <option value="One Handed">One-Handed</option>
                                        </select>         
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-form-group">
                                <label>Major Realm</label>
                                <div class="Major-Realm">
                                    <select name="attr_major_realm"> 
                                        <option value="none" selected disabled>Major Realm</option>
                                        <option value="Qi-Gathering">Qi-Gathering</option>
                                        <option value="Foundation">Foundation</option>
                                        <option value="Core Formation">Core Formation</option>
                                        <option value="Martial Soul">Martial Soul</option>
                                        <option value="God Ascendance">God Ascendance</option>
                                    </select>         
                                </div>
                                <label>Minor Realm</label>
                                <div class="Minor-Realm">
                                    <select name="attr_minor_realm"> 
                                        <option value="none" selected disabled>Minor Realm</option>
                                        <option value="Early">Early</option>
                                        <option value="Middle">Middle</option>
                                        <option value="Late">Late</option>
                                        <option value="Peak">Peak</option>
                                    </select>         
                                </div>
                            </div>
                            <div class="sheet-form-group">
                                <label>Ancestry</label>
                                <div class="character-ancestry">
                                    <select name="attr_ancestry" title="@{ancestry}"> 
                                        <option value="none" selected disabled>Choose an Ancestry</option>
                                        <option value="Human">Human</option>
                                        <option value="Demi-Human">Demi-Human</option>
                                        <option value="Beastmen">Beastmen</option>
                                        <option value="Yokai">Yokai</option>
                                        <option value="Winged">The Winged Race</option>
                                    </select>
                                </div>
                                <input type="hidden" type="text" name="attr_ancestry" class="race-hider">
                                <div class="No-race">
                                    <input type="text" name="attr_race" value="Select an Ancestry" disabled>
                                </div>
                                <div class="Human-race" title="@{race}">
                                    <input type="text" name="attr_race" value="Bloodline Integration" disabled>
                                </div>
                                <div class="Demi-human-race">
                                    <input type="text" name="attr_race" value="" placeholder="Fox of the Blazing Path" title="@{race}">
                                </div>
                                <div class="Beastmen-race">
                                    <input type="text" name="attr_race" value="" placeholder="Fox of the Blazing Path" title="@{race}">
                                </div>
                                <div class="Yokai-race">                                    
                                    <select name="attr_race" title="@{race}"> 
                                        <option value="none" disabled selected>Choose an Lineage</option>
                                        <option value="Hososhi">Hososhi</option>
                                        <option value="Karasu Tengu">Karasu Tengu</option>
                                        <option value="Kejoro">Kejoro</option>
                                        <option value="Oni of Agility">Oni of Agility</option>
                                        <option value="Oni of Brutality">Oni of Brurality</option>
                                        <option value="Oni of Spirit">Oni of Spirituality</option>
                                        <option value="Kitsune">Kitsune</option>
                                        <option value="Wani">Wani</option>
                                    </select>
                                </div>
                                <div class="Winged-race">
                                    <input type="text" name="attr_race" value="Innate Bloodline" disabled>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-toggle-unchecked">
                    <div class="sheet-section-pc-header-details-panel">
                        <div>
                            <label>Dao and Path</label>
                            <input type="text" name="attr_class_display" title="@{class_display}">
                        </div>
                        <div>
                            <label>Major and Minor Realm</label>
                            <input type="text" name="attr_level_display" title="@{level_display}">
                        </div>
                        <div>
                            <label>Background</label>
                            <input type="text" name="attr_background" title="@{background}">
                        </div>
                        <div>
                            <label>Race</label>
                            <input type="text" name="attr_race_display" title="@{race_display}">
                        </div>
                        <div>
                            <label>Moral Compass</label>
                            <input type="text" name="attr_alignment" title="@{alignment}">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet-section-pc-body">
            <div class="sheet-tabs">
                <div class="sheet-tab sheet-tab-mortal">
                    <input type="radio" name="attr_tab" value="mortal" checked="checked">
                    <span class="sheet-tab-label">Mortal</span>
                    <div class="sheet-tab-content">
                        <div class="sheet-container-grouped-top">
                            <div class="sheet-container-well well-attributes">
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_strength" value="@{wtype}&{template:simple} {{rname=Strength}} {{mod=@{strength_mod}}} {{r1=[[@{d20}+@{strength_mod}[STR]]]}} @{rtype}+@{strength_mod}[STR]]]}} @{character_name}">Strength</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_strength_mod" title="@{strength_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_strength_base" title="@{strength}" value="10">
                                        <input type="hidden" name="attr_strength" value="10">
                                        <input type="hidden" name="attr_strength_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_strength"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_dexterity" value="@{wtype}&{template:simple} {{rname=Dexterity}} {{mod=@{dexterity_mod}}} {{r1=[[@{d20}+@{dexterity_mod}[DEX]]]}} @{rtype}+@{dexterity_mod}[DEX]]]}} @{character_name}">Dexterity</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_dexterity_mod" title="@{dexterity_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_dexterity_base" title="@{dexterity}" value="10">
                                        <input type="hidden" name="attr_dexterity" value="10">
                                        <input type="hidden" name="attr_dexterity_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_dexterity"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_constitution" value="@{wtype}&{template:simple} {{rname=Constitution}} {{mod=@{constitution_mod}}} {{r1=[[@{d20}+@{constitution_mod}[CON]]]}} @{rtype}+@{constitution_mod}[CON]]]}} @{character_name}">Constitution</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_constitution_mod" title="@{constitution_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_constitution_base" title="@{constitution}" value="10">
                                        <input type="hidden" name="attr_constitution" value="10">
                                        <input type="hidden" name="attr_constitution_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_constitution"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_intelligence" value="@{wtype}&{template:simple} {{rname=Intelligence}} {{mod=@{intelligence_mod}}} {{r1=[[@{d20}+@{intelligence_mod}[INT]]]}} @{rtype}+@{intelligence_mod}[INT]]]}} @{character_name}">Intelligence</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_intelligence_mod" title="@{intelligence_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_intelligence_base" title="@{intelligence}" value="10">
                                        <input type="hidden" name="attr_intelligence" value="10">
                                        <input type="hidden" name="attr_intelligence_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_intelligence"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_wisdom" value="@{wtype}&{template:simple} {{rname=Wisdom}} {{mod=@{wisdom_mod}}} {{r1=[[@{d20}+@{wisdom_mod}[WIS]]]}} @{rtype}+@{wisdom_mod}[WIS]]]}} @{character_name}">Wisdom</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_wisdom_mod" title="@{wisdom_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_wisdom_base" title="@{wisdom}" value="10">
                                        <input type="hidden" name="attr_wisdom" value="10">
                                        <input type="hidden" name="attr_wisdom_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_wisdom"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_charisma" value="@{wtype}&{template:simple} {{rname=Charisma}} {{mod=@{charisma_mod}}} {{r1=[[@{d20}+@{charisma_mod}[CHA]]]}} @{rtype}+@{charisma_mod}[CHA]]]}} @{character_name}">Charisma</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_charisma_mod" title="@{charisma_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_charisma_base" title="@{charisma}" value="10">
                                        <input type="hidden" name="attr_charisma" value="10">
                                        <input type="hidden" name="attr_charisma_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_charisma"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_sanity" value="@{wtype}&{template:simple} {{rname=Sanity}} {{mod=@{sanity_mod}}} {{r1=[[@{d20}+@{sanity_mod}[SAN]]]}} @{rtype}+@{sanity_mod}[SAN]]]}} @{character_name}">Sanity</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_sanity_mod" title="@{sanity_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_sanity_base" title="@{sanity}" value="10">
                                        <input type="hidden" name="attr_sanity" value="10">
                                        <input type="hidden" name="attr_sanity_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_sanity"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_honor" value="@{wtype}&{template:simple} {{rname=Honor}} {{mod=@{honor_mod}}} {{r1=[[@{d20}+@{honor_mod}[HON]]]}} @{rtype}+@{honor_mod}[HON]]]}} @{character_name}">Honor</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_honor_mod" title="@{honor_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_honor_base" title="@{honor}" value="10">
                                        <input type="hidden" name="attr_honor" value="10">
                                        <input type="hidden" name="attr_honor_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_honor"></span>
                                    </div>
                                </div>
                            </div> 
                            <div class="sheet-container-well well-saves">
                                <div class="sheet-container-bar sheet-proficiency">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_proficiency" value="@{wtype}@{template:simple} {{rname=Proficiency}} {{mod=@{pb}}} {{r1=[[@{pb}}[Proficiency Bonus]}} @{character_name}">PROFICIENCY BONUS</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_pb" title="@{pb}"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-panel sheet-panel-save">
                                    <div class="sheet-container-header">
                                        <span>Skills and Saving Throws</span>
                                    </div>
                                    <div class="sheet-container-body">
                                        <div class="sheet-container-body-save">
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_strength_save_prof" title="@{strength_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_strength_save_bonus" title="@{strength_save_bonus}">0</span>
                                                <button type="roll" name="roll_strength_save" value="@{wtype}&{template:simple} {{rname=Strength Save}} {{mod=@{strength_save_bonus}}} {{r1=[[@{d20}+@{strength_save_bonus}]]}} @{rtype}+@{strength_save_bonus}]]}} @{character_name}">Strength</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_dexterity_save_prof" title="@{dexterity_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_dexterity_save_bonus" title="@{dexterity_save_bonus}">0</span>
                                                <button type="roll" name="roll_dexterity_save" value="@{wtype}&{template:simple} {{rname=Dexterity Save}} {{mod=@{dexterity_save_bonus}}} {{r1=[[@{d20}+@{dexterity_save_bonus}]]}} @{rtype}+@{dexterity_save_bonus}]]}} @{character_name}">Dexterity</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_constitution_save_prof" title="@{constitution_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_constitution_save_bonus" title="@{constitution_save_bonus}">0</span>
                                                <button type="roll" name="roll_constitution_save" value="@{wtype}&{template:simple} {{rname=Constitution Save}} {{mod=@{constitution_save_bonus}}} {{r1=[[@{d20}+@{constitution_save_bonus}]]}} @{rtype}+@{constitution_save_bonus}]]}} @{character_name}">Constitution</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_intelligence_save_prof" title="@{intelligence_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_intelligence_save_bonus" title="@{intelligence_save_bonus}">0</span>
                                                <button type="roll" name="roll_intelligence_save" value="@{wtype}&{template:simple} {{rname=Intelligence Save}} {{mod=@{intelligence_save_bonus}}} {{r1=[[@{d20}+@{intelligence_save_bonus}]]}} @{rtype}+@{intelligence_save_bonus}]]}} @{character_name}">Intelligence</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_wisdom_save_prof" title="@{wisdom_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_wisdom_save_bonus" title="@{wisdom_save_bonus}">0</span>
                                                <button type="roll" name="roll_wisdom_save" value="@{wtype}&{template:simple} {{rname=Wisdom Save}} {{mod=@{wisdom_save_bonus}}} {{r1=[[@{d20}+@{wisdom_save_bonus}]]}} @{rtype}+@{wisdom_save_bonus}]]}} @{character_name}">Wisdom</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_charisma_save_prof" title="@{charisma_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_charisma_save_bonus" title="@{charisma_save_bonus}">0</span>
                                                <button type="roll" name="roll_charisma_save" value="@{wtype}&{template:simple} {{rname=Charisma Save}} {{mod=@{charisma_save_bonus}}} {{r1=[[@{d20}+@{charisma_save_bonus}]]}} @{rtype}+@{charisma_save_bonus}]]}} @{character_name}">Charisma</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <span name="attr_sanity_save_bonus" title="@{sanity_save_bonus}">0</span>
                                                <button type="roll" name="roll_sanity_save" value="@{wtype}&{template:simple} {{rname=Sanity Save}} {{mod=@{sanity_save_bonus}}} {{r1=[[@{d20}+@{sanity_save_bonus}]]}} @{rtype}+@{sanity_save_bonus}]]}} @{character_name}">Sanity</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <span name="attr_honor_save_bonus" title="@{honor_save_bonus}">0</span>
                                                <button type="roll" name="roll_honor_save" value="@{wtype}&{template:simple} {{rname=Honor Save}} {{mod=@{honor_save_bonus}}} {{r1=[[@{d20}+@{honor_save_bonus}]]}} @{rtype}+@{honor_save_bonus}]]}} @{character_name}">Honor</button>
                                            </div>
                                        </div>
                                        <div class="sheet-container-body-skill">
                                            <div class="sheet-container-body-skill-strength skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_athletics_prof" title="@{athletics_prof}" value="(@{pb}*@{athletics_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_athletics_bonus" title="@{athletics_bonus}">0</span>
                                                    <button type="roll" name="roll_athletics" value="@{wtype}&{template:simple} {{rname=Strength (Athletics)}} {{mod=@{athletics_bonus}}} {{r1=[[@{d20}+@{athletics_bonus}]]}} @{rtype}+@{athletics_bonus}]]}} @{character_name}">Athletics</button>
                                                    <select name="attr_athletics_attribute" title="@{athletics_attribute}" style="display:none;">
                                                        <option value="Strength" selected="selected"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-dexterity skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_acrobatics_prof" title="@{acrobatics_prof}" value="(@{pb}*@{acrobatics_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_acrobatics_bonus" title="@{acrobatics_bonus}">0</span>
                                                    <button type="roll" name="roll_acrobatics" value="@{wtype}&{template:simple} {{rname=Dexterity (Acrobatics)}} {{mod=@{acrobatics_bonus}}} {{r1=[[@{d20}+@{acrobatics_bonus}]]}} @{rtype}+@{acrobatics_bonus}]]}} @{character_name}">Acrobatics</button>
                                                    <select name="attr_acrobatics_attribute" title="@{acrobatics_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity" selected="selected"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill sheet-skill-sleight-of-hand">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_sleight_of_hand_prof" title="@{sleight_of_hand_prof}" value="(@{pb}*@{sleight_of_hand_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_sleight_of_hand_bonus" title="@{sleight_of_hand_bonus}">0</span>
                                                    <button type="roll" name="roll_sleight_of_hand" value="@{wtype}&{template:simple} {{rname=Dexterity (Sleight of Hand)}} {{mod=@{sleight_of_hand_bonus}}} {{r1=[[@{d20}+@{sleight_of_hand_bonus}]]}} @{rtype}+@{sleight_of_hand_bonus}]]}} @{character_name}">Sleight of Hand</button>
                                                    <select name="attr_sleight_of_hand_attribute" title="@{sleight_of_hand_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity" selected="selected"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_stealth_prof" title="@{stealth_prof}" value="(@{pb}*@{stealth_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_stealth_bonus" title="@{stealth_bonus}">0</span>
                                                    <button type="roll" name="roll_stealth" value="@{wtype}&{template:simple} {{rname=Dexterity (Stealth)}} {{mod=@{stealth_bonus}}} {{r1=[[@{d20}+@{stealth_bonus}]]}} @{rtype}+@{stealth_bonus}]]}} @{character_name}">Stealth</button>
                                                    <select name="attr_stealth_attribute" title="@{stealth_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity" selected="selected"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-consitution skill-group-column">

                                            </div>
                                            <div class="sheet-container-body-skill-intelligence skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_investigation_prof" title="@{investigation_prof}" value="(@{pb}*@{investigation_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_investigation_bonus" title="@{investigation_bonus}">0</span>
                                                    <button type="roll" name="roll_investigation" value="@{wtype}&{template:simple} {{rname=Intelligence (Investigation)}} {{mod=@{investigation_bonus}}} {{r1=[[@{d20}+@{investigation_bonus}]]}} @{rtype}+@{investigation_bonus}]]}} @{character_name}">Investigation</button>
                                                    <select name="attr_investigation_attribute" title="@{investigation_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_history_prof" title="@{history_prof}" value="(@{pb}*@{history_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_history_bonus" title="@{history_bonus}">0</span>
                                                    <button type="roll" name="roll_history" value="@{wtype}&{template:simple} {{rname=Intelligence (History)}} {{mod=@{history_bonus}}} {{r1=[[@{d20}+@{history_bonus}]]}} @{rtype}+@{history_bonus}]]}} @{character_name}">History</button>
                                                    <select name="attr_history_attribute" title="@{history_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_nature_prof" title="@{nature_prof}" value="(@{pb}*@{nature_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_nature_bonus" title="@{nature_bonus}">0</span>
                                                    <button type="roll" name="roll_nature" value="@{wtype}&{template:simple} {{rname=Intelligence (Nature)}} {{mod=@{nature_bonus}}} {{r1=[[@{d20}+@{nature_bonus}]]}} @{rtype}+@{nature_bonus}]]}} @{character_name}">Nature</button>
                                                    <select name="attr_nature_attribute" title="@{nature_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_religion_prof" title="@{religion_prof}" value="(@{pb}*@{religion_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_religion_bonus" title="@{religion_bonus}">0</span>
                                                    <button type="roll" name="roll_religion" value="@{wtype}&{template:simple} {{rname=Intelligence (Religion)}} {{mod=@{religion_bonus}}} {{r1=[[@{d20}+@{religion_bonus}]]}} @{rtype}+@{religion_bonus}]]}} @{character_name}">Religion</button>
                                                    <select name="attr_religion_attribute" title="@{religion_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-wisdom skill-group-column">
                                                <div class="sheet-skill sheet-skill-animal-handling">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_animal_handling_prof" title="@{animal_handling_prof}" value="(@{pb}*@{animal_handling_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_animal_handling_bonus" title="@{animal_handling_bonus}">0</span>
                                                    <button type="roll" name="roll_animal_handling" value="@{wtype}&{template:simple} {{rname=Wisdom (Animal Handling)}} {{mod=@{animal_handling_bonus}}} {{r1=[[@{d20}+@{animal_handling_bonus}]]}} @{rtype}+@{animal_handling_bonus}]]}} @{character_name}">Animal Handling</button>
                                                    <select name="attr_animal_handling_attribute" title="@{animal_handling_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_insight_prof" title="@{insight_prof}" value="(@{pb}*@{insight_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_insight_bonus" title="@{insight_bonus}">0</span>
                                                    <button type="roll" name="roll_insight" value="@{wtype}&{template:simple} {{rname=Wisdom (Insight)}} {{mod=@{insight_bonus}}} {{r1=[[@{d20}+@{insight_bonus}]]}} @{rtype}+@{insight_bonus}]]}} @{character_name}">Insight</button>
                                                    <select name="attr_insight_attribute" title="@{insight_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_medicine_prof" title="@{medicine_prof}" value="(@{pb}*@{medicine_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_medicine_bonus" title="@{medicine_bonus}">0</span>
                                                    <button type="roll" name="roll_medicine" value="@{wtype}&{template:simple} {{rname=Wisdom (Medicine)}} {{mod=@{medicine_bonus}}} {{r1=[[@{d20}+@{medicine_bonus}]]}} @{rtype}+@{medicine_bonus}]]}} @{character_name}">Medicine</button>
                                                    <select name="attr_medicine_attribute" title="@{medicine_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_perception_prof" title="@{perception_prof}" value="(@{pb}*@{perception_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_perception_bonus" title="@{perception_bonus}">0</span>
                                                    <button type="roll" name="roll_perception" value="@{wtype}&{template:simple} {{rname=Wisdom (Perception)}} {{mod=@{perception_bonus}}} {{r1=[[@{d20}+@{perception_bonus}]]}} @{rtype}+@{perception_bonus}]]}} @{character_name}">Perception</button>
                                                    <select name="attr_perception_attribute" title="@{perception_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_survival_prof" title="@{survival_prof}" value="(@{pb}*@{survival_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_survival_bonus" title="@{survival_bonus}">0</span>
                                                    <button type="roll" name="roll_survival" value="@{wtype}&{template:simple} {{rname=Wisdom (Survival)}} {{mod=@{survival_bonus}}} {{r1=[[@{d20}+@{survival_bonus}]]}} @{rtype}+@{survival_bonus}]]}} @{character_name}">Survival</button>
                                                    <select name="attr_survival_attribute" title="@{survival_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-charisma skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deception_prof" title="@{deception_prof}" value="(@{pb}*@{deception_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_deception_bonus" title="@{deception_bonus}">0</span>
                                                    <button type="roll" name="roll_deception" value="@{wtype}&{template:simple} {{rname=Charisma (Deception)}} {{mod=@{deception_bonus}}} {{r1=[[@{d20}+@{deception_bonus}]]}} @{rtype}+@{deception_bonus}]]}} @{character_name}">Deception</button>
                                                    <select name="attr_deception_attribute" title="@{deception_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_intimidation_prof" title="@{intimidation_prof}" value="(@{pb}*@{intimidation_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_intimidation_bonus" title="@{intimidation_bonus}">0</span>
                                                    <button type="roll" name="roll_intimidation" value="@{wtype}&{template:simple} {{rname=Charisma (Intimidation)}} {{mod=@{intimidation_bonus}}} {{r1=[[@{d20}+@{intimidation_bonus}]]}} @{rtype}+@{intimidation_bonus}]]}} @{character_name}">Intimidation</button>
                                                    <select name="attr_intimidation_attribute" title="@{intimidation_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_performance_prof" title="@{performance_prof}" value="(@{pb}*@{performance_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_performance_bonus" title="@{performance_bonus}">0</span>
                                                    <button type="roll" name="roll_performance" value="@{wtype}&{template:simple} {{rname=Charisma (Performance)}} {{mod=@{performance_bonus}}} {{r1=[[@{d20}+@{performance_bonus}]]}} @{rtype}+@{performance_bonus}]]}} @{character_name}">Performance</button>
                                                    <select name="attr_performance_attribute" title="@{performance_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_persuasion_prof" title="@{persuasion_prof}" value="(@{pb}*@{persuasion_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_persuasion_bonus" title="@{persuasion_bonus}">0</span>
                                                    <button type="roll" name="roll_persuasion" value="@{wtype}&{template:simple} {{rname=Charisma (Persuasion)}} {{mod=@{persuasion_bonus}}} {{r1=[[@{d20}+@{persuasion_bonus}]]}} @{rtype}+@{persuasion_bonus}]]}} @{character_name}">Persuasion</button>
                                                    <select name="attr_persuasion_attribute" title="@{persuasion_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-sanity skill-group-column">

                                            </div>
                                            <div class="sheet-container-body-skill-honor skill-group-column">

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-container-group-bottom">
                            <div class="sheet-container-grouped-left">
                                <div class="sheet-container-track-health-survival">
                                    <div class="sheet-container-well well-trackers">
                                        <div class="sheet-container-box sheet-ac">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_mortal_ac" value="@{wtype}&{template:simple} {{rname=Mortal AC}} {{mod=@{ac}}} {{r1=[[@{ac}]]}} @{character_name}">Armor Class</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_ac" title="@{ac}" value="10">
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-initiative">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_initiative" value="@{wtype}&{template:simple} {{rname=Initiative}} {{mod=@{initiative_bonus}}} {{r1=[[@{initiative_style}+@{initiative_bonus}[INIT] &{tracker}]]}} {{normal=1}} @{character_name}">Initiative</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <span name="attr_initiative_bonus" title="@{initiative_bonus}"></span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-perception">
                                            <div class="sheet-container-header">Passive Perception</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_passive_wisdom" title="@{passive_wisdom}" value="(10+@{perception_bonus}+@{passiveperceptionmod})" disabled="true" hidden>
                                                <span name="attr_passive_wisdom" title="@{passive_wisdom}"></span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-speed">
                                            <div class="sheet-container-header">Speed</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_speed" title="@{speed}" value="30">
                                            </div>
                                        </div>
                                    </div> 
                                    <div class="sheet-container-well well-health">
                                        <div class="sheet-container-box sheet-hp-max">
                                            <div class="sheet-container-header">Hit Points</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hp_max" title="@{hp_max}">
                                            </div>
                                            <div class="sheet-container-footer">Maximum</div>
                                        </div>
                                        <div class="sheet-container-box sheet-hp-current">
                                            <div class="sheet-container-header">Hit Points</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hp" title="@{hp}">
                                                <span>|</span>
                                                <input type="text" name="attr_hp_temp" title="@{hp_temp}" value="0">
                                            </div>
                                            <div class="sheet-container-footer">
                                                <span>Current</span>
                                                <span>Temporary</span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-hp-coefficient">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_hp-coef" value="@{wtype}&{template:simple} {{rname=HP Coefficient}} {{mod=@{hp_coefficient}D@{hit_dice}+[[@{hp_coefficient}*@{constitution_mod}[CON]]]}} {{r1=[[@{hp_coefficient}d@{hit_dice}+[[@{hp_coefficient}*@{constitution_mod}]][CON]]]}} {{normal=1}} @{character_name}">HP Coefficient</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hp_coefficient" title="@{hp_coefficient}" value="1">
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-hit-scale">
                                            <div class="sheet-container-header">Hit Scale</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hit_scale" title="@{hit_scale}" value="1">
                                            </div>
                                            <div class="sheet-container-footer">
                                                <span>Scale</span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-hit-dice">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_hit_dice" value="@{wtype}&{template:simple} {{rname=Hit Dice}} {{mod=@{hit_scale}D@{hit_dice}+[[@{constitution_mod}[CON]]]}} {{r1=[[@{hit_scale}d@{hit_dice}+[[@{hit_scale}*@{constitution_mod}]][CON]]]}} {{normal=1}} @{character_name}">Hit Dice</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hit_dice" title="@{hit_dice}" value="10">
                                            </div>
                                            <div class="sheet-container-footer">
                                                <span></span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-death">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_death_save" value="@{wtype}&{template:simple} {{rname=Death Save}} {{mod=@{death_save_bonus}}} {{r=[[@{d0}+@{death_save_bonus}[MOD]]]}} {{normal=1}} @{character_name}">Death Save</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <div class="sheet-death-save-success">
                                                    <span>S:</span>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_success_1" title="@{deathsave_success1}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_success_2" title="@{deathsave_success2}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_success_3" title="@{deathsave_success3}">
                                                        <span></span>
                                                    </div>
                                                </div>
                                                <div class="sheet-death-save-fail">
                                                    <span>F:</span>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_fail_1" title="@{deathsave_fail1}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_fail_2" title="@{deathsave_fail2}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_fail_3" title="@{deathsave_fail3}">
                                                        <span></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-wounds">
                                            <div class="sheet-container-header">Wounds and Injuries</div>
                                            <div class="sheet-container-body">
                                                <div class="sheet-container-body-header">
                                                    <span></span>
                                                    <span>Description</span>
                                                </div>
                                                <fieldset class="repeating_wounds">
                                                    <div class="sheet-fieldset-item">
                                                        <div class="sheet-checkbox-cog">
                                                            <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                            <span class="sheet-toggle-icon"></span>
                                                        </div>
                                                        <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden><span></span>
                                                        <div class="sheet-toggle-checked">
                                                            <div class="sheet-form">
                                                                <div class="sheet-form-header">Edit Wound/Injury</div>
                                                                <div class="sheet-form-body">
                                                                    <div class="sheet-form-group">
                                                                        <input type="text" name="attr_wound_description">
                                                                    </div>
                                                                    <div class="sheet-form-group">
                                                                        <label class="sheet-form-checkbox">
                                                                            <input type="checkbox" name="attr_wound_untreated" value="1" checked="checked">
                                                                            <span>Is untreated</span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="sheet-toggle-unchecked">
                                                            <div class="sheet-pc-wound">
                                                                <div class="sheet-checkbox-image">
                                                                    <input type="checkbox" name="attr_wound_untreated" value="1" checked="checked">
                                                                    <span></span>
                                                                </div>
                                                                <span name="attr_wound_description"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </fieldset>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="sheet-container-well well-survival">
                                        <div class="sheet-container-panel">
                                            <div class="sheet-container-header">
                                                <span>Hunger</span>
                                                <span>Thirst</span>
                                                <span>Fatigue</span>
                                                <span>Temperature</span>
                                            </div>
                                            <div class="sheet-container-body">
                                                <ul class="sheet-list-survival">
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="0" title="@{hunger}">
                                                            <span title="@{hunger}">Stuffed</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="1" title="@{hunger}">
                                                            <span title="@{hunger}">Satiated</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="2" title="@{hunger}">
                                                            <span title="@{hunger}">Well-fed</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="3" checked="checked" title="@{hunger}">
                                                            <span title="@{hunger}">Ok</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="4" title="@{hunger}">
                                                            <span title="@{hunger}">Hungry</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="5" title="@{hunger}">
                                                            <span title="@{hunger}">Ravenous</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_hunger" value="6" title="@{hunger}">
                                                            <span title="@{hunger}">Starving</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                                <ul class="sheet-list-survival">
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="0" title="@{thirst}">
                                                            <span title="@{thirst}">Quenched</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="1" title="@{thirst}">
                                                            <span title="@{thirst}">Satisfied</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="2" title="@{thirst}">
                                                            <span title="@{thirst}">Refreshed</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="3" checked="checked" title="@{thirst}">
                                                            <span title="@{thirst}">Ok</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="4" title="@{thirst}">
                                                            <span title="@{thirst}">Thirsty</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="5" title="@{thirst}">
                                                            <span title="@{thirst}">Dry</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_thirst" value="6" title="@{thirst}">
                                                            <span title="@{thirst}">Dehydrated</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                                <ul class="sheet-list-survival">
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="0" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Energised</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="1" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Well-rested</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="2" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Rested</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="3" checked="checked" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Ok</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="4" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Sleepy</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="5" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Very sleepy</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_stamina_state" value="6" title="@{stamina_state}">
                                                            <span title="@{stamina_state}">Barely awake</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                                <ul class="sheet-list-survival">
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="0" title="@{temperature}">
                                                            <span title="@{temperature}">Perfect</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="1" title="@{temperature}">
                                                            <span title="@{temperature}">Relaxing</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="2" title="@{temperature}">
                                                            <span title="@{temperature}">Comfortable</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="3" checked="checked" title="@{temperature}">
                                                            <span title="@{temperature}">Ok</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="4" title="@{temperature}">
                                                            <span title="@{temperature}">Uncomfortable</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="5" title="@{temperature}">
                                                            <span title="@{temperature}">Overwhelming</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_temperature" value="6" title="@{temperature}">
                                                            <span title="@{temperature}">Unbearable</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div> 
                                    <div class="sheet-col sheet-column-tool-martial">
                                        <div class="sheet-container-well well-tools">
                                            <div class="sheet-container-panel sheet-pc-tools">
                                                <div class="sheet-container-header">Tools</div>
                                                <div class="sheet-container-body">
                                                    <div class="sheet-container-body-header">
                                                        <span>Mod</span>
                                                        <span>Tool</span>
                                                    </div>
                                                    <fieldset class="repeating_tool">
                                                        <div class="sheet-fieldset-item sheet-fieldset-item-tool">
                                                            <div class="sheet-checkbox-cog">
                                                                <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                                <span class="sheet-toggle-icon"></span>
                                                            </div>
                                                            <input type="checkbox" name="attr_options-flag" checked="checked" hidden class="sheet-toggle">
                                                            <div class="sheet-toggle-checked">
                                                                <div class="sheet-form">
                                                                    <div class="sheet-form-header">Edit Proficiency</div>
                                                                    <div class="sheet-form-body">
                                                                        <div class="sheet-form-group">
                                                                            <label>Name:</label>
                                                                            <input type="text" name="attr_toolname">
                                                                        </div>
                                                                        <div class="sheet-form-group">
                                                                            <label>Proficiency Bonus:</label>
                                                                            <select name="attr_toolbonus_base">
                                                                                <option value="(@{pb})" selected="selected">PROFICIENT</option>
                                                                                <option value="(@{pb}*2)">EXPERTISE</option>
                                                                                <option value="0">NONE</option>
                                                                            </select>
                                                                        </div>
                                                                        <div class="sheet-form-group">
                                                                            <label>Attribute:</label>
                                                                            <select name="attr_toolattr_base">
                                                                                <option value="@{strength_mod}" selected="selected">STR</option>
                                                                                <option value="@{dexterity_mod}">DEX</option>
                                                                                <option value="@{constitution_mod}">CON</option>
                                                                                <option value="@{intelligence_mod}">INT</option>
                                                                                <option value="@{wisdom_mod}">WIS</option>
                                                                                <option value="@{charisma_mod}">CHA</option>
                                                                                <option value="0">NONE</option>
                                                                            </select>
                                                                            <label>Mods:</label>
                                                                            <input type="text" name="attr_tool_mod" title="@{tool_mod}" value="0">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sheet-toggle-unchecked">
                                                                <div class="sheet-tool">
                                                                    <button type="roll" name="roll_tool" value="@{wtype}&{template:simple} {{rname=@{toolname}}} {{mod=@{toolbonus}}} {{r1=[[@{d20}+@{toolbonus}]]}} @{rtype}+@{toolbonus}]]}} @{character_name}">
                                                                        <span></span>
                                                                        <span name="attr_toolbonus_display"></span>
                                                                        <span name="attr_toolname"></span>
                                                                        <input type="hidden" name="attr_toolbonus">
                                                                        <span name="attr_toolattr"></span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div> 
                                        <div class="sheet-container-well well-martial-arts">
                                            <div class="sheet-container-panel sheet-martial-arts">
                                                <div class="sheet-container-header">Martial Arts</div>
                                                <div class="sheet-container-body">
                                                    <div class="sheet-container-body-header">
                                                        <span>Type</span>
                                                        <span>Name</span>
                                                    </div>
                                                    <input type="hidden" name="attr_simple_martial_arts" value="complex">
                                                    <textarea name="attr_other_martial_arts" hidden></textarea>
                                                    <fieldset class="repeating_martial-arts">
                                                        <div class="sheet-fieldset-item sheet-fieldset-item-martial-art">
                                                            <div class="sheet-checkbox-cog">
                                                                <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                                <span class="sheet-toggle-icon"></span>
                                                            </div>
                                                            <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
                                                            <div class="sheet-toggle-checked">
                                                                <div class="sheet-form">
                                                                    <div class="sheet-form-header">Edit Martial Arts</div>
                                                                    <div class="sheet-form-body">
                                                                        <div class="sheet-form-group">
                                                                            <select name="attr_martial_type">
                                                                                <option value="Martial Art" selected="selected">Martial Arts</option>
                                                                                <option value="Form">Form</option>
                                                                            </select>
                                                                            <input type="text" name="attr_martial_name">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sheet-toggle-unchecked">
                                                                <div class="sheet-martial-art">
                                                                    <button type="roll" name="roll_output" value="@{wtype}&{template:traits} @{character_name} {{name=@{martial_type}}} {{description=@{martial_name}}}">
                                                                        <span name="attr_martial_type"></span>
                                                                        <span name="attr_martial_name"></span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div> 
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-container-grouped-right">
                                <div class="sheet-container-well well-attacks">
                                    <div class="sheet-container-box sheet-mortal-qi">
                                        <div class="sheet-container-header">Mortal Qi Capacity</div>
                                        <div class="sheet-container-body">
                                            <input type="text" name="attr_mortal_qi" title="@{mortal_qi}" value="0">
                                            <span>/</span>
                                            <input type="text" name="attr_mortal_qi_max" title="@{mortal_qi_max}" value="0">
                                        </div>
                                    </div>
                                    <div class="sheet-container-panel sheet-attacks">
                                        <div class="sheet-container-header">Attacks & Techniques</div>
                                        <div class="sheet-container-body">
                                            <fieldset class="repeating_attack">
                                                <div class="sheet-fieldset-item">
                                                    <div class="sheet-checkbox-cog">
                                                        <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                        <span class="sheet-toggle-icon"></span>
                                                    </div>
                                                    <input type="checkbox" name="attr_options-flag" checked="checked" hidden class="sheet-toggle">
                                                    <div class="sheet-toggle-checked">
                                                        <div class="sheet-form">
                                                            <div class="sheet-form-header">Edit Attack</div>
                                                            <div class="sheet-form-body">
                                                                <div class="sheet-form-group">
                                                                    <label>Name:</label>
                                                                    <input type="text" name="attr_atkname">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_atkflag" value="{{attack=1}}" checked="checked">
                                                                        <span>Attack:</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <select name="attr_atkattr_base">
                                                                        <option value="@{strength_mod}" selected="selected">STR</option>
                                                                        <option value="@{dexterity_mod}">DEX</option>
                                                                        <option value="@{constitution_mod}">CON</option>
                                                                        <option value="@{intelligence_mod}">INT</option>
                                                                        <option value="@{wisdom_mod}">WIS</option>
                                                                        <option value="@{charisma_mod}">CHA</option>
                                                                        <option value="0">-</option>
                                                                    </select>
                                                                    <span>+</span>
                                                                    <input type="text" name="attr_atkmod" placeholder="0">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_atkprofflag" value="(@{pb})" checked="checked">
                                                                        <span>Proficient</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Range:</label>
                                                                    <input type="text" name="attr_atkrange">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Attack Bonus</label>
                                                                    <input type="text" name="attr_atkmagic">
                                                                    <label>Crit Range:</label>
                                                                    <input type="text" name="attr_atkcritrange" value="20">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_dmgflag" value="{{damage=1}} {{dmg1flag=1}}" checked="checked">
                                                                        <span>Damage 1</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>DMG</label>
                                                                    <input type="text" name="attr_dmgbase">
                                                                    <span>+</span>
                                                                    <select name="attr_dmgattr">
                                                                        <option value="@{strength_mod}" selected="selected">STR</option>
                                                                        <option value="@{dexterity_mod}">DEX</option>
                                                                        <option value="@{constitution_mod}">CON</option>
                                                                        <option value="@{intelligence_mod}">INT</option>
                                                                        <option value="@{wisdom_mod}">WIS</option>
                                                                        <option value="@{charisma_mod}">CHA</option>
                                                                        <option value="0">-</option>
                                                                    </select>
                                                                    <span>+</span>
                                                                    <label>Mod</label>
                                                                    <input type="text" name="attr_dmgmod">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Type:</label>
                                                                    <input type="text" name="attr_dmgtype">
                                                                    <label>Crit:</label>
                                                                    <input type="text" name="attr_dmgcustcrit">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_dmg2flag" value="{{damage=1}} {{dmg2flag=1}}">
                                                                        <span>Damage 2</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Dmg</label>
                                                                    <input type="text" name="attr_dmg2base">
                                                                    <span>+</span>
                                                                    <select name="attr_dmg2attr">
                                                                        <option value="@{strength_mod}">STR</option>
                                                                        <option value="@{dexterity_mod}">DEX</option>
                                                                        <option value="@{constitution_mod}">CON</option>
                                                                        <option value="@{intelligence_mod}">INT</option>
                                                                        <option value="@{wisdom_mod}">WIS</option>
                                                                        <option value="@{charisma_mod}">CHA</option>
                                                                        <option value="0" selected="selected">-</option>
                                                                    </select>
                                                                    <span>+</span>
                                                                    <label>Mod</label>
                                                                    <input type="text" name="attr_dmg2mod">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Type:</label>
                                                                    <input type="text" name="attr_dmg2type">
                                                                    <label>Crit:</label>
                                                                    <input type="text" name="attr_dmg2custcrit">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_saveflag" value="{{save=1}} {{saveattr=@{saveattr}}} {{savedesc=@{saveeffect}}} {{savedc=[[[[@{savedc}]][SAVE]]]}}">
                                                                        <span>Saving Throw</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <select name="attr_saveattr">
                                                                        <option value="Strength" selected="selected">STR</option>
                                                                        <option value="Dexterity">DEX</option>
                                                                        <option value="Constitution">CON</option>
                                                                        <option value="Intelligence">INT</option>
                                                                        <option value="Wisdom">WIS</option>
                                                                        <option value="Charisma">CHA</option>
                                                                    </select>
                                                                    <label>vs DC:</label>
                                                                    <select name="attr_savedc">
                                                                        <option value="(@{strength_mod}+8+@{pb})">STR</option>
                                                                        <option value="(@{dexterity_mod}+8+@{pb})">DEX</option>
                                                                        <option value="(@{constitution_mod}+8+@{pb})">CON</option>
                                                                        <option value="(@{intelligence_mod}+8+@{pb})">INT</option>
                                                                        <option value="(@{wisdom_mod}+8+@{pb})">WIS</option>
                                                                        <option value="(@{charisma_mod}+8+@{pb})">CHA</option>
                                                                        <option value="(@{saveflat})">FLAT</option>
                                                                    </select>
                                                                    <input type="hidden" name="attr_savedc">
                                                                    <input type="text" name="attr_saveflat" value="10">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Save Effect:</label>
                                                                    <input type="text" name="attr_saveeffect">
                                                                </div>
                                                                <div class="sheet-form-group sheet-form-group-column">
                                                                    <label>Description:</label>
                                                                    <textarea name="attr_atk_desc"></textarea>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="sheet-toggle-unchecked">
                                                        <div class="sheet-attack">
                                                            <input type="text" name="attr_atkbonus" class="sheet-hidden" value="">
                                                            <input type="text" name="attr_atkdmgtype" class="sheet-hidden" value="">
                                                            <button type="roll" name="roll_attack" value="@{rollbase}" class="sheet-attack-button">
                                                                <span name="attr_atkname"></span>
                                                                <span name="attr_atkbonus"></span>
                                                                <span name="attr_atkdmgtype"></span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" name="attr_rollbase">
                                                <input type="hidden" name="attr_rollbase_dmg">
                                                <input type="hidden" name="attr_rollbase_crit">
                                                <input type="hidden" name="attr_hldmg">
                                                <input type="hidden" name="attr_itemid">
                                                <button type="roll" name="roll_attack_dmg" value="@{rollbase_dmg}" class="sheet-hidden"></button>
                                                <button type="roll" name="roll_attack_crit" value="@{rollbase_crit}" class="sheet-hidden"></button>
                                            </fieldset>
                                        </div>
                                    </div>
                                </div> 
                                <div class="sheet-col sheet-container-effects">
                                    <div class="sheet-container-well well-strain">
                                        <div class="sheet-container-box sheet-stress">
                                            <div class="sheet-container-header">Stress</div>
                                            <div class="sheet-container-body">
                                                <span name="attr_stress_max" class="sheet-calculated sheet-hidden">10</span>
                                                <input type="text" name="attr_stress" title="@{stress}" value="0">
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-stress-levels">
                                            <div class="sheet-container-header">Stress Levels</div>
                                            <div class="sheet-container-body">
                                                <ul>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_stress_state_4" value="1" title="@{stress_state_4}">
                                                            <span title="@{stress_state_4}"><strong>4:</strong> Affliction</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_stress_state_6" value="1" title="@{stress_state_6}">
                                                            <span title="@{stress_state_6}"><strong>6:</strong> Affliction</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_stress_state_8" value="1" title="@{stress_state_8}">
                                                            <span title="@{stress_state_8}"><strong>8:</strong> Affliction</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_stress_state_10" value="1" title="@{stress_state_10}">
                                                            <span title="@{stress_state_10}"><strong>10:</strong> Breakpoint</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-afflictions">
                                            <div class="sheet-container-header">Afflictions</div>
                                            <div class="sheet-container-body">
                                                <div class="sheet-container-body-header">
                                                    <span>Affliction</span>
                                                    <span>Effect</span>
                                                </div>
                                                <fieldset class="repeating_afflictions">
                                                    <div class="sheet-fieldset-item">
                                                        <div class="sheet-checkbox-cog">
                                                            <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                            <span class="sheet-toggle-icon"></span>
                                                        </div>
                                                        <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
                                                        <div class="sheet-toggle-checked">
                                                            <div class="sheet-form">
                                                                <div class="sheet-form-header">Edit Affliction</div>
                                                                <div class="sheet-form-body">
                                                                    <div class="sheet-form-group">
                                                                        <select name="attr_affliction">
                                                                            <option value="Fearful: Disadvantage on Sanity checks/saves">Fearful</option>
                                                                            <option value="Hopelessness: Disadvantage on STR checks/saves">Hopelessness</option>
                                                                            <option value="Hypochondria: Hit point maximum is halved">Hypochondria</option>
                                                                            <option value="Irrational: Disadvantage on Sanity checks/saves">Irrational</option>
                                                                            <option value="Mania: Disadvantage on attack rolls">Mania</option>
                                                                            <option value="Masochistic: Disadvantage on CON checks/saves">Masochistic</option>
                                                                            <option value="Narcissistic: Disadvantage on ability checks">Narcissistic</option>
                                                                            <option value="Panic: Disadvantage on DEX checks/saves">Panic</option>
                                                                            <option value="Paranoid: Speed is halved">Paranoid</option>
                                                                            <option value="Selfish: Disadvantage on Honor checks/saves">Selfish</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="sheet-toggle-unchecked">
                                                            <div class="sheet-pc-affliction">
                                                                <span name="attr_affliction"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </fieldset>
                                            </div>
                                        </div>
                                    </div> 
                                    <div class="sheet-container-well well-effects">
                                        <div class="sheet-container-effects sheet-container-well-effects">
                                            <div class="sheet-container-panel sheet-effects">
                                                <div class="sheet-container-header">Effects & Conditions</div>
                                                <div class="sheet-container-body">
                                                    <div class="sheet-container-body-header">
                                                        <span></span>
                                                        <span>Description</span>
                                                    </div>
                                                    <fieldset class="repeating_effects-conditions">
                                                        <div class="sheet-fieldset-item">
                                                            <div class="sheet-checkbox-cog">
                                                                <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                                <span class="sheet-toggle-icon"></span>
                                                            </div>
                                                            <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
                                                            <div class="sheet-toggle-checked">
                                                                <div class="sheet-form">
                                                                    <div class="sheet-form-header">Edit Effect</div>
                                                                    <div class="sheet-form-body">
                                                                        <div class="sheet-form-group">
                                                                            <input type="text" name="attr_description">
                                                                        </div>
                                                                        <div class="sheet-form-group">
                                                                            <label class="sheet-form-checkbox">
                                                                                <input type="checkbox" name="attr_active" value="1" checked="checked">
                                                                                <span>Active</span>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sheet-toggle-unchecked">
                                                                <div class="sheet-pc-effect">
                                                                    <div class="sheet-checkbox-image">
                                                                        <input type="checkbox" name="attr_active" value="1" checked="checked">
                                                                        <span></span>
                                                                    </div>
                                                                    <span name="attr_description"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div>
                                    </div> 
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-tab sheet-tab-cultivator">
                    <input type="radio" name="attr_tab" value="cultivator">
                    <span class="sheet-tab-label">Cultivator</span>
                    <div class="sheet-tab-content">
                        <div class="sheet-container-grouped-top">
                            <div class="sheet-container-well well-attributes">
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_strength" value="@{wtype}&{template:simple} {{rname=Strength}} {{mod=@{strength_mod}}} {{r1=[[@{d20}+@{strength_mod}[STR]]]}} @{rtype}+@{strength_mod}[STR]]]}} @{character_name}">Strength</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_strength_mod" title="@{strength_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_strength_base" title="@{strength}" value="10">
                                        <input type="hidden" name="attr_strength" value="10">
                                        <input type="hidden" name="attr_strength_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_strength"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_dexterity" value="@{wtype}&{template:simple} {{rname=Dexterity}} {{mod=@{dexterity_mod}}} {{r1=[[@{d20}+@{dexterity_mod}[DEX]]]}} @{rtype}+@{dexterity_mod}[DEX]]]}} @{character_name}">Dexterity</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_dexterity_mod" title="@{dexterity_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_dexterity_base" title="@{dexterity}" value="10">
                                        <input type="hidden" name="attr_dexterity" value="10">
                                        <input type="hidden" name="attr_dexterity_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_dexterity"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_constitution" value="@{wtype}&{template:simple} {{rname=Constitution}} {{mod=@{constitution_mod}}} {{r1=[[@{d20}+@{constitution_mod}[CON]]]}} @{rtype}+@{constitution_mod}[CON]]]}} @{character_name}">Constitution</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_constitution_mod" title="@{constitution_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_constitution_base" title="@{constitution}" value="10">
                                        <input type="hidden" name="attr_constitution" value="10">
                                        <input type="hidden" name="attr_constitution_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_constitution"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_intelligence" value="@{wtype}&{template:simple} {{rname=Intelligence}} {{mod=@{intelligence_mod}}} {{r1=[[@{d20}+@{intelligence_mod}[INT]]]}} @{rtype}+@{intelligence_mod}[INT]]]}} @{character_name}">Intelligence</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_intelligence_mod" title="@{intelligence_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_intelligence_base" title="@{intelligence}" value="10">
                                        <input type="hidden" name="attr_intelligence" value="10">
                                        <input type="hidden" name="attr_intelligence_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_intelligence"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_wisdom" value="@{wtype}&{template:simple} {{rname=Wisdom}} {{mod=@{wisdom_mod}}} {{r1=[[@{d20}+@{wisdom_mod}[WIS]]]}} @{rtype}+@{wisdom_mod}[WIS]]]}} @{character_name}">Wisdom</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_wisdom_mod" title="@{wisdom_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_wisdom_base" title="@{wisdom}" value="10">
                                        <input type="hidden" name="attr_wisdom" value="10">
                                        <input type="hidden" name="attr_wisdom_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_wisdom"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_charisma" value="@{wtype}&{template:simple} {{rname=Charisma}} {{mod=@{charisma_mod}}} {{r1=[[@{d20}+@{charisma_mod}[CHA]]]}} @{rtype}+@{charisma_mod}[CHA]]]}} @{character_name}">Charisma</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_charisma_mod" title="@{charisma_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_charisma_base" title="@{charisma}" value="10">
                                        <input type="hidden" name="attr_charisma" value="10">
                                        <input type="hidden" name="attr_charisma_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_charisma"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_sanity" value="@{wtype}&{template:simple} {{rname=Sanity}} {{mod=@{sanity_mod}}} {{r1=[[@{d20}+@{sanity_mod}[SAN]]]}} @{rtype}+@{sanity_mod}[SAN]]]}} @{character_name}">Sanity</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_sanity_mod" title="@{sanity_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_sanity_base" title="@{sanity}" value="10">
                                        <input type="hidden" name="attr_sanity" value="10">
                                        <input type="hidden" name="attr_sanity_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_sanity"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-attribute">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_honor" value="@{wtype}&{template:simple} {{rname=Honor}} {{mod=@{honor_mod}}} {{r1=[[@{d20}+@{honor_mod}[HON]]]}} @{rtype}+@{honor_mod}[HON]]]}} @{character_name}">Honor</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_honor_mod" title="@{honor_mod}">0</span>
                                    </div>
                                    <div class="sheet-container-footer">
                                        <input type="text" name="attr_honor_base" title="@{honor}" value="10">
                                        <input type="hidden" name="attr_honor" value="10">
                                        <input type="hidden" name="attr_honor_flag" value="0" class="sheet-field-toggle">
                                        <span name="attr_honor"></span>
                                    </div>
                                </div>
                            </div> 
                            <div class="sheet-container-well well-saves">
                                <div class="sheet-container-bar sheet-proficiency">
                                    <div class="sheet-container-header">
                                        <button type="roll" name="roll_proficiency" value="@{wtype}@{template:simple} {{rname=Proficiency}} {{mod=@{pb}}} {{r1=[[@{pb}}[Proficiency Bonus]}} @{character_name}">PROFICIENCY BONUS</button>
                                    </div>
                                    <div class="sheet-container-body">
                                        <span name="attr_pb" title="@{pb}"></span>
                                    </div>
                                </div>
                                <div class="sheet-container-panel sheet-panel-save">
                                    <div class="sheet-container-header">
                                        <span>Skills and Saving Throws</span>
                                    </div>
                                    <div class="sheet-container-body">
                                        <div class="sheet-container-body-save">
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_strength_save_prof" title="@{strength_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_strength_save_bonus" title="@{strength_save_bonus}">0</span>
                                                <button type="roll" name="roll_strength_save" value="@{wtype}&{template:simple} {{rname=Strength Save}} {{mod=@{strength_save_bonus}}} {{r1=[[@{d20}+@{strength_save_bonus}]]}} @{rtype}+@{strength_save_bonus}]]}} @{character_name}">Strength</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_dexterity_save_prof" title="@{dexterity_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_dexterity_save_bonus" title="@{dexterity_save_bonus}">0</span>
                                                <button type="roll" name="roll_dexterity_save" value="@{wtype}&{template:simple} {{rname=Dexterity Save}} {{mod=@{dexterity_save_bonus}}} {{r1=[[@{d20}+@{dexterity_save_bonus}]]}} @{rtype}+@{dexterity_save_bonus}]]}} @{character_name}">Dexterity</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_constitution_save_prof" title="@{constitution_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_constitution_save_bonus" title="@{constitution_save_bonus}">0</span>
                                                <button type="roll" name="roll_constitution_save" value="@{wtype}&{template:simple} {{rname=Constitution Save}} {{mod=@{constitution_save_bonus}}} {{r1=[[@{d20}+@{constitution_save_bonus}]]}} @{rtype}+@{constitution_save_bonus}]]}} @{character_name}">Constitution</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_intelligence_save_prof" title="@{intelligence_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_intelligence_save_bonus" title="@{intelligence_save_bonus}">0</span>
                                                <button type="roll" name="roll_intelligence_save" value="@{wtype}&{template:simple} {{rname=Intelligence Save}} {{mod=@{intelligence_save_bonus}}} {{r1=[[@{d20}+@{intelligence_save_bonus}]]}} @{rtype}+@{intelligence_save_bonus}]]}} @{character_name}">Intelligence</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_wisdom_save_prof" title="@{wisdom_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_wisdom_save_bonus" title="@{wisdom_save_bonus}">0</span>
                                                <button type="roll" name="roll_wisdom_save" value="@{wtype}&{template:simple} {{rname=Wisdom Save}} {{mod=@{wisdom_save_bonus}}} {{r1=[[@{d20}+@{wisdom_save_bonus}]]}} @{rtype}+@{wisdom_save_bonus}]]}} @{character_name}">Wisdom</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <div class="sheet-checkbox-image">
                                                    <input type="checkbox" name="attr_charisma_save_prof" title="@{charisma_save_prof}" value="(@{pb})">
                                                    <span></span>
                                                </div>
                                                <span name="attr_charisma_save_bonus" title="@{charisma_save_bonus}">0</span>
                                                <button type="roll" name="roll_charisma_save" value="@{wtype}&{template:simple} {{rname=Charisma Save}} {{mod=@{charisma_save_bonus}}} {{r1=[[@{d20}+@{charisma_save_bonus}]]}} @{rtype}+@{charisma_save_bonus}]]}} @{character_name}">Charisma</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <span name="attr_sanity_save_bonus" title="@{sanity_save_bonus}">0</span>
                                                <button type="roll" name="roll_sanity_save" value="@{wtype}&{template:simple} {{rname=Sanity Save}} {{mod=@{sanity_save_bonus}}} {{r1=[[@{d20}+@{sanity_save_bonus}]]}} @{rtype}+@{sanity_save_bonus}]]}} @{character_name}">Sanity</button>
                                            </div>
                                            <div class="sheet-saving-throw">
                                                <span name="attr_honor_save_bonus" title="@{honor_save_bonus}">0</span>
                                                <button type="roll" name="roll_honor_save" value="@{wtype}&{template:simple} {{rname=Honor Save}} {{mod=@{honor_save_bonus}}} {{r1=[[@{d20}+@{honor_save_bonus}]]}} @{rtype}+@{honor_save_bonus}]]}} @{character_name}">Honor</button>
                                            </div>
                                        </div>
                                        <div class="sheet-container-body-skill">
                                            <div class="sheet-container-body-skill-strength skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_athletics_prof" title="@{athletics_prof}" value="(@{pb}*@{athletics_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_athletics_bonus" title="@{athletics_bonus}">0</span>
                                                    <button type="roll" name="roll_athletics" value="@{wtype}&{template:simple} {{rname=Strength (Athletics)}} {{mod=@{athletics_bonus}}} {{r1=[[@{d20}+@{athletics_bonus}]]}} @{rtype}+@{athletics_bonus}]]}} @{character_name}">Athletics</button>
                                                    <select name="attr_athletics_attribute" title="@{athletics_attribute}" style="display:none;">
                                                        <option value="Strength" selected="selected"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-dexterity skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_acrobatics_prof" title="@{acrobatics_prof}" value="(@{pb}*@{acrobatics_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_acrobatics_bonus" title="@{acrobatics_bonus}">0</span>
                                                    <button type="roll" name="roll_acrobatics" value="@{wtype}&{template:simple} {{rname=Dexterity (Acrobatics)}} {{mod=@{acrobatics_bonus}}} {{r1=[[@{d20}+@{acrobatics_bonus}]]}} @{rtype}+@{acrobatics_bonus}]]}} @{character_name}">Acrobatics</button>
                                                    <select name="attr_acrobatics_attribute" title="@{acrobatics_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity" selected="selected"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill sheet-skill-sleight-of-hand">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_sleight_of_hand_prof" title="@{sleight_of_hand_prof}" value="(@{pb}*@{sleight_of_hand_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_sleight_of_hand_bonus" title="@{sleight_of_hand_bonus}">0</span>
                                                    <button type="roll" name="roll_sleight_of_hand" value="@{wtype}&{template:simple} {{rname=Dexterity (Sleight of Hand)}} {{mod=@{sleight_of_hand_bonus}}} {{r1=[[@{d20}+@{sleight_of_hand_bonus}]]}} @{rtype}+@{sleight_of_hand_bonus}]]}} @{character_name}">Sleight of Hand</button>
                                                    <select name="attr_acrobatics_attribute" title="@{acrobatics_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity" selected="selected"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_stealth_prof" title="@{stealth_prof}" value="(@{pb}*@{stealth_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_stealth_bonus" title="@{stealth_bonus}">0</span>
                                                    <button type="roll" name="roll_stealth" value="@{wtype}&{template:simple} {{rname=Dexterity (Stealth)}} {{mod=@{stealth_bonus}}} {{r1=[[@{d20}+@{stealth_bonus}]]}} @{rtype}+@{stealth_bonus}]]}} @{character_name}">Stealth</button>
                                                    <select name="attr_acrobatics_attribute" title="@{acrobatics_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity" selected="selected"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-consitution skill-group-column">

                                            </div>
                                            <div class="sheet-container-body-skill-intelligence skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_absorb_cult_prof" title="@{absorb_cult_prof}" value="(@{pb}*@{absorb_cult_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_absorb_cult_bonus" title="@{absorb_cult_bonus}">0</span>
                                                    <button type="roll" name="roll_absorb_cult" value="@{wtype}&{template:simple} {{rname=Intelligence (Absorb / Cultivate)}} {{mod=@{absorb_cult_bonus}}} {{r1=[[@{d20}+@{absorb_cult_bonus}]]}} @{rtype}+@{absorb_cult_bonus}]]}} @{character_name}">Cultivate / Absorb</button>
                                                    <select name="attr_absorb_cult_attribute" title="@{absorb_cult_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_investigation_prof" title="@{investigation_prof}" value="(@{pb}*@{investigation_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_investigation_bonus" title="@{investigation_bonus}">0</span>
                                                    <button type="roll" name="roll_investigation" value="@{wtype}&{template:simple} {{rname=Intelligence (Investigation)}} {{mod=@{investigation_bonus}}} {{r1=[[@{d20}+@{investigation_bonus}]]}} @{rtype}+@{investigation_bonus}]]}} @{character_name}">Investigation</button>
                                                    <select name="attr_investigation_attribute" title="@{investigation_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_history_prof" title="@{history_prof}" value="(@{pb}*@{history_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_history_bonus" title="@{history_bonus}">0</span>
                                                    <button type="roll" name="roll_history" value="@{wtype}&{template:simple} {{rname=Intelligence (History)}} {{mod=@{history_bonus}}} {{r1=[[@{d20}+@{history_bonus}]]}} @{rtype}+@{history_bonus}]]}} @{character_name}">History</button>
                                                    <select name="attr_investigation_attribute" title="@{investigation_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_nature_prof" title="@{nature_prof}" value="(@{pb}*@{nature_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_nature_bonus" title="@{nature_bonus}">0</span>
                                                    <button type="roll" name="roll_nature" value="@{wtype}&{template:simple} {{rname=Intelligence (Nature)}} {{mod=@{nature_bonus}}} {{r1=[[@{d20}+@{nature_bonus}]]}} @{rtype}+@{nature_bonus}]]}} @{character_name}">Nature</button>
                                                    <select name="attr_investigation_attribute" title="@{investigation_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_religion_prof" title="@{religion_prof}" value="(@{pb}*@{religion_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_religion_bonus" title="@{religion_bonus}">0</span>
                                                    <button type="roll" name="roll_religion" value="@{wtype}&{template:simple} {{rname=Intelligence (Religion)}} {{mod=@{religion_bonus}}} {{r1=[[@{d20}+@{religion_bonus}]]}} @{rtype}+@{religion_bonus}]]}} @{character_name}">Religion</button>
                                                    <select name="attr_investigation_attribute" title="@{investigation_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_spirit_prof" title="@{spirit_prof}" value="(@{pb}*@{spirit_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_spirit_bonus" title="@{spirit_bonus}">0</span>
                                                    <button type="roll" name="roll_spirit" value="@{wtype}&{template:simple} {{rname=Intelligence (Spiritual Sense)}} {{mod=@{spirit_bonus}}} {{r1=[[@{d20}+@{spirit_bonus}]]}} @{rtype}+@{spirit_bonus}]]}} @{character_name}">Spiritual Sense</button>
                                                    <select name="attr_spirit_attribute" title="@{spirit_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence" selected="selected"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-wisdom skill-group-column">
                                                <div class="sheet-skill sheet-skill-animal-handling">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_animal_handling_prof" title="@{animal_handling_prof}" value="(@{pb}*@{animal_handling_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_animal_handling_bonus" title="@{animal_handling_bonus}">0</span>
                                                    <button type="roll" name="roll_animal_handling" value="@{wtype}&{template:simple} {{rname=Wisdom (Animal Handling)}} {{mod=@{animal_handling_bonus}}} {{r1=[[@{d20}+@{animal_handling_bonus}]]}} @{rtype}+@{animal_handling_bonus}]]}} @{character_name}">Animal Handling</button>
                                                    <select name="attr_animal_handling_attribute" title="@{animal_handling_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_comprehension_prof" title="@{comprehension_prof}" value="(@{pb}*@{comprehension_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_comprehension_bonus" title="@{comprehension_bonus}">0</span>
                                                    <button type="roll" name="roll_comprehension" value="@{wtype}&{template:simple} {{rname=Wisdom (Comprehension)}} {{mod=@{comprehension_bonus}}} {{r1=[[@{d20}+@{comprehension_bonus}]]}} @{rtype}+@{comprehension_bonus}]]}} @{character_name}">Comprehension</button>
                                                    <select name="attr_comprehension_attribute" title="@{comprehension_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_insight_prof" title="@{insight_prof}" value="(@{pb}*@{insight_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_insight_bonus" title="@{insight_bonus}">0</span>
                                                    <button type="roll" name="roll_insight" value="@{wtype}&{template:simple} {{rname=Wisdom (Insight)}} {{mod=@{insight_bonus}}} {{r1=[[@{d20}+@{insight_bonus}]]}} @{rtype}+@{insight_bonus}]]}} @{character_name}">Insight</button>
                                                    <select name="attr_animal_handling_attribute" title="@{animal_handling_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_medicine_prof" title="@{medicine_prof}" value="(@{pb}*@{medicine_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_medicine_bonus" title="@{medicine_bonus}">0</span>
                                                    <button type="roll" name="roll_medicine" value="@{wtype}&{template:simple} {{rname=Wisdom (Medicine)}} {{mod=@{medicine_bonus}}} {{r1=[[@{d20}+@{medicine_bonus}]]}} @{rtype}+@{medicine_bonus}]]}} @{character_name}">Medicine</button>
                                                    <select name="attr_animal_handling_attribute" title="@{animal_handling_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_perception_prof" title="@{perception_prof}" value="(@{pb}*@{perception_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_perception_bonus" title="@{perception_bonus}">0</span>
                                                    <button type="roll" name="roll_perception" value="@{wtype}&{template:simple} {{rname=Wisdom (Perception)}} {{mod=@{perception_bonus}}} {{r1=[[@{d20}+@{perception_bonus}]]}} @{rtype}+@{perception_bonus}]]}} @{character_name}">Perception</button>
                                                    <select name="attr_animal_handling_attribute" title="@{animal_handling_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_qi_control_prof" title="@{qi_control_prof}" value="(@{pb}*@{qi_control_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_qi_control_bonus" title="@{qi_control_bonus}">0</span>
                                                    <button type="roll" name="roll_qi_control" value="@{wtype}&{template:simple} {{rname=Wisdom (Qi Control)}} {{mod=@{qi_control_bonus}}} {{r1=[[@{d20}+@{qi_control_bonus}]]}} @{rtype}+@{qi_control_bonus}]]}} @{character_name}">Qi Control</button>
                                                    <select name="attr_qi_control_attribute" title="@{qi_control_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_survival_prof" title="@{survival_prof}" value="(@{pb}*@{survival_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_survival_bonus" title="@{survival_bonus}">0</span>
                                                    <button type="roll" name="roll_survival" value="@{wtype}&{template:simple} {{rname=Wisdom (Survival)}} {{mod=@{survival_bonus}}} {{r1=[[@{d20}+@{survival_bonus}]]}} @{rtype}+@{survival_bonus}]]}} @{character_name}">Survival</button>
                                                    <select name="attr_animal_handling_attribute" title="@{animal_handling_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom" selected="selected"></option>
                                                        <option value="Charisma"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-charisma skill-group-column">
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deception_prof" title="@{deception_prof}" value="(@{pb}*@{deception_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_deception_bonus" title="@{deception_bonus}">0</span>
                                                    <button type="roll" name="roll_deception" value="@{wtype}&{template:simple} {{rname=Charisma (Deception)}} {{mod=@{deception_bonus}}} {{r1=[[@{d20}+@{deception_bonus}]]}} @{rtype}+@{deception_bonus}]]}} @{character_name}">Deception</button>
                                                    <select name="attr_persuasion_attribute" title="@{persuasion_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_intimidation_prof" title="@{intimidation_prof}" value="(@{pb}*@{intimidation_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_intimidation_bonus" title="@{intimidation_bonus}">0</span>
                                                    <button type="roll" name="roll_intimidation" value="@{wtype}&{template:simple} {{rname=Charisma (Intimidation)}} {{mod=@{intimidation_bonus}}} {{r1=[[@{d20}+@{intimidation_bonus}]]}} @{rtype}+@{intimidation_bonus}]]}} @{character_name}">Intimidation</button>
                                                    <select name="attr_persuasion_attribute" title="@{persuasion_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_performance_prof" title="@{performance_prof}" value="(@{pb}*@{performance_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_performance_bonus" title="@{performance_bonus}">0</span>
                                                    <button type="roll" name="roll_performance" value="@{wtype}&{template:simple} {{rname=Charisma (Performance)}} {{mod=@{performance_bonus}}} {{r1=[[@{d20}+@{performance_bonus}]]}} @{rtype}+@{performance_bonus}]]}} @{character_name}">Performance</button>
                                                    <select name="attr_persuasion_attribute" title="@{persuasion_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                                <div class="sheet-skill">
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_persuasion_prof" title="@{persuasion_prof}" value="(@{pb}*@{persuasion_type})">
                                                        <span></span>
                                                    </div>
                                                    <span name="attr_persuasion_bonus" title="@{persuasion_bonus}">0</span>
                                                    <button type="roll" name="roll_persuasion" value="@{wtype}&{template:simple} {{rname=Charisma (Persuasion)}} {{mod=@{persuasion_bonus}}} {{r1=[[@{d20}+@{persuasion_bonus}]]}} @{rtype}+@{persuasion_bonus}]]}} @{character_name}">Persuasion</button>
                                                    <select name="attr_persuasion_attribute" title="@{persuasion_attribute}" style="display:none;">
                                                        <option value="Strength"></option>
                                                        <option value="Dexterity"></option>
                                                        <option value="Constitution"></option>
                                                        <option value="Intelligence"></option>
                                                        <option value="Wisdom"></option>
                                                        <option value="Charisma" selected="selected"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="sheet-container-body-skill-sanity skill-group-column">

                                            </div>
                                            <div class="sheet-container-body-skill-honor skill-group-column">

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-container-group-bottom">
                            <div class="sheet-container-grouped-left">
                                <div class="sheet-container-track-health-survival">
                                    <div class="sheet-container-well well-trackers">
                                        <div class="sheet-container-box sheet-eac">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_eac" value="@{wtype}&{template:simple} {{rname=EAC}} {{mod=@{eac}}} {{r1=[[@{eac}]]}} @{character_name}">Evasive AC</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_eac" title="@{eac}">
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-passive-eac">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_passive-eac" value="@{wtype}&{template:simple} {{rname=Passive EAC}} {{mod=@{passive-eac}}} {{r1=[[@{passive-eac}]]}} @{character_name}">Passive Evasive AC</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_passive-eac" title="@{passive-eac}" value="(round(@{eac}/2))" disabled>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-dac">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_dac" value="@{wtype}&{template:simple} {{rname=DAC}} {{mod=@{dac}}} {{r1=[[@{dac}]]}} @{character_name}">Defensive AC</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_dac" title="@{dac}" value="10">
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-initiative">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_initiative" value="@{wtype}&{template:simple} {{rname=Initiative}} {{mod=@{initiative_bonus}}} {{r1=[[@{initiative_style}+@{initiative_bonus}[INIT] &{tracker}]]}} {{normal=1}} @{character_name}">Initiative</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <span name="attr_initiative_bonus" title="@{initiative_bonus}"></span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-perception">
                                            <div class="sheet-container-header">Passive Perception</div>
                                        <div class="sheet-container-body">
                                            <input type="text" name="attr_passive_wisdom" title="@{passive_wisdom}" value="(10+@{perception_bonus}+@{passiveperceptionmod})" disabled="true" hidden>
                                            <span name="attr_passive_wisdom" title="@{passive_wisdom}"></span>
                                        </div>
                                        </div>
                                        <div class="sheet-container-box sheet-speed">
                                            <div class="sheet-container-header">Speed</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_speed" title="@{speed}" value="30">
                                            </div>
                                        </div>
                                    </div> 
                                    <div class="sheet-container-well well-health">
                                        <div class="sheet-container-box sheet-soul-max">
                                            <div class="sheet-container-header">Soul Damage</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_soul_max" title="@{soul_max}" value="0">
                                            </div>
                                            <div class="sheet-container-footer"></div>
                                        </div>
                                        <div class="sheet-container-box sheet-hp-max">
                                            <div class="sheet-container-header">Hit Points</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hp_max" title="@{hp_max}">
                                            </div>
                                            <div class="sheet-container-footer">Maximum</div>
                                        </div>
                                        <div class="sheet-container-box sheet-hp-current">
                                            <div class="sheet-container-header">Hit Points</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hp" title="@{hp}">
                                                <span>|</span>
                                                <input type="text" name="attr_regen" title="@{hp_regen}" value="0">
                                                <span>|</span>
                                                <input type="text" name="attr_hp_temp" title="@{hp_temp}" value="0">
                                            </div>
                                            <div class="sheet-container-footer">
                                                <span>Current</span>
                                                <span>Regen</span>
                                                <span>Temporary</span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-hp-coefficient">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_hp-coef" value="@{wtype}&{template:simple} {{rname=HP Coefficient}} {{mod=@{hp_coefficient}D@{hit_dice}+[[@{hp_coefficient}*@{constitution_mod}[CON]]]+[[@{hp_coefficient}*@{hit_bonus}]]}} {{r1=[[@{hp_coefficient}d@{hit_dice}+[[@{hp_coefficient}*@{constitution_mod}]][CON]]]}} {{normal=1}} @{character_name}">HP Coefficient</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hp_coefficient" title="@{hp_coefficient}" value="1">
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-hit-scale">
                                            <div class="sheet-container-header">Hit Scale</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hit_scale" title="@{hit_scale}" value="1">
                                            </div>
                                            <div class="sheet-container-footer">
                                                <span>Scale</span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-hit-dice">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_hit_dice" value="@{wtype}&{template:simple} {{rname=Hit Dice}} {{mod=@{hit_scale}D@{hit_dice}+[[@{hit_scale}*@{constitution_mod}[CON]]]+[[@{hit_scale}*@{hit_bonus}]]}} {{r1=[[@{hit_scale}d@{hit_dice}+[[@{hit_scale}*@{constitution_mod}]][CON]+[[@{hit_scale}*@{hit_bonus}]][Hit Bonus]]]}} {{normal=1}} @{character_name}">Hit Dice</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_hit_dice" title="@{hit_dice}" value="10">
                                                <span>|</span>
                                                <input type="text" name="attr_hit_bonus" title="@{hit_bonus}" value="(round(@{hit_dice}/2))" disabled>
                                            </div>
                                            <div class="sheet-container-footer">
                                                <span></span>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-death">
                                            <div class="sheet-container-header">
                                                <button type="roll" name="roll_death_save" value="@{wtype}&{template:simple} {{rname=Death Save}} {{mod=@{death_save_bonus}}} {{r=[[@{d0}+@{death_save_bonus}[MOD]]]}} {{normal=1}} @{character_name}">Death Save</button>
                                            </div>
                                            <div class="sheet-container-body">
                                                <div class="sheet-death-save-success">
                                                    <span>S:</span>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_success_1" title="@{deathsave_success1}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_success_2" title="@{deathsave_success2}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_success_3" title="@{deathsave_success3}">
                                                        <span></span>
                                                    </div>
                                                </div>
                                                <div class="sheet-death-save-fail">
                                                    <span>F:</span>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_fail_1" title="@{deathsave_fail1}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_fail_2" title="@{deathsave_fail2}">
                                                        <span></span>
                                                    </div>
                                                    <div class="sheet-checkbox-image">
                                                        <input type="checkbox" name="attr_deathsave_fail_3" title="@{deathsave_fail3}">
                                                        <span></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-wounds">
                                            <div class="sheet-container-header">Wounds and Injuries</div>
                                            <div class="sheet-container-body">
                                                <div class="sheet-container-body-header">
                                                    <span></span>
                                                    <span>Description</span>
                                                </div>
                                                <fieldset class="repeating_wounds">
                                                    <div class="sheet-fieldset-item">
                                                        <div class="sheet-checkbox-cog">
                                                            <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                            <span class="sheet-toggle-icon"></span>
                                                        </div>
                                                        <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden><span></span>
                                                        <div class="sheet-toggle-checked">
                                                            <div class="sheet-form">
                                                                <div class="sheet-form-header">Edit Wound/Injury</div>
                                                                <div class="sheet-form-body">
                                                                    <div class="sheet-form-group">
                                                                        <input type="text" name="attr_wound_description">
                                                                    </div>
                                                                    <div class="sheet-form-group">
                                                                        <label class="sheet-form-checkbox">
                                                                            <input type="checkbox" name="attr_wound_untreated" value="1" checked="checked">
                                                                            <span>Is untreated</span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="sheet-toggle-unchecked">
                                                            <div class="sheet-pc-wound">
                                                                <div class="sheet-checkbox-image">
                                                                    <input type="checkbox" name="attr_wound_untreated" value="1" checked="checked">
                                                                    <span></span>
                                                                </div>
                                                                <span name="attr_wound_description"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </fieldset>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="sheet-container-well well-survival">
                                        <div class="sheet-container-panel">
                                            <div class="sheet-container-header">
                                                <span>Temperature</span>
                                                <span> </span>
                                                <span> </span>
                                                <span> </span>
                                            </div>
                                            <div class="sheet-container-body">
                                                <ul class="sheet-list-survival">
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="0" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Perfect</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="1" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Relaxing</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="2" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Comfortable</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="3" checked="checked" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Ok</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="4" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Uncomfortable</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="5" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Overwhelming</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-radio">
                                                            <input type="radio" name="attr_cult_temperature" value="6" title="@{cult_temperature}">
                                                            <span title="@{cult_temperature}">Unbearable</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                                <ul class="sheet-list-survival">
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                </ul>
                                                <ul class="sheet-list-survival">
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                </ul>
                                                <ul class="sheet-list-survival">
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                    <li></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div> 
                                    <div class="sheet-col sheet-column-tool-martial">
                                        <div class="sheet-container-well well-tools">
                                            <div class="sheet-container-panel sheet-pc-tools">
                                                <div class="sheet-container-header">Tools</div>
                                                <div class="sheet-container-body">
                                                    <div class="sheet-container-body-header">
                                                        <span>Mod</span>
                                                        <span>Tool</span>
                                                    </div>
                                                    <fieldset class="repeating_tool">
                                                        <div class="sheet-fieldset-item sheet-fieldset-item-tool">
                                                            <div class="sheet-checkbox-cog">
                                                                <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                                <span class="sheet-toggle-icon"></span>
                                                            </div>
                                                            <input type="checkbox" name="attr_options-flag" checked="checked" hidden class="sheet-toggle">
                                                            <div class="sheet-toggle-checked">
                                                                <div class="sheet-form">
                                                                    <div class="sheet-form-header">Edit Proficiency</div>
                                                                    <div class="sheet-form-body">
                                                                        <div class="sheet-form-group">
                                                                            <label>Name:</label>
                                                                            <input type="text" name="attr_toolname">
                                                                        </div>
                                                                        <div class="sheet-form-group">
                                                                            <label>Proficiency Bonus:</label>
                                                                            <select name="attr_toolbonus_base">
                                                                                <option value="(@{pb})" selected="selected">PROFICIENT</option>
                                                                                <option value="(@{pb}*2)">EXPERTISE</option>
                                                                                <option value="0">NONE</option>
                                                                            </select>
                                                                        </div>
                                                                        <div class="sheet-form-group">
                                                                            <label>Attribute:</label>
                                                                            <select name="attr_toolattr_base">
                                                                                <option value="@{strength_mod}" selected="selected">Str</option>
                                                                                <option value="@{dexterity_mod}">Dex</option>
                                                                                <option value="@{constitution_mod}">Con</option>
                                                                                <option value="@{intelligence_mod}">Int</option>
                                                                                <option value="@{wisdom_mod}">Wis</option>
                                                                                <option value="@{charisma_mod}">Cha</option>
                                                                            </select>
                                                                            <label>Mods:</label>
                                                                            <input type="text" name="attr_tool_mod" title="@{tool_mod}" value="0">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sheet-toggle-unchecked">
                                                                <div class="sheet-tool">
                                                                    <button type="roll" name="roll_tool" value="@{wtype}&{template:simple} {{rname=@{toolname}}} {{mod=@{toolbonus}}} {{r1=[[@{d20}+@{toolbonus}]]}} @{rtype}+@{toolbonus}]]}} @{character_name}">
                                                                        <span></span>
                                                                        <span name="attr_toolbonus_display"></span>
                                                                        <span name="attr_toolname"></span>
                                                                        <input type="hidden" name="attr_toolbonus">
                                                                        <span name="attr_toolattr"></span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div> 
                                        <div class="sheet-container-well well-martial-arts">
                                            <div class="sheet-container-panel sheet-martial-arts">
                                                <div class="sheet-container-header">Martial Arts</div>
                                                <div class="sheet-container-body">
                                                    <div class="sheet-container-body-header">
                                                        <span>Type</span>
                                                        <span>Name</span>
                                                    </div>
                                                    <input type="hidden" name="attr_simple_martial_arts" value="complex">
                                                    <textarea name="attr_other_martial_arts" hidden></textarea>
                                                    <fieldset class="repeating_martial-arts">
                                                        <div class="sheet-fieldset-item sheet-fieldset-item-martial-art">
                                                            <div class="sheet-checkbox-cog">
                                                                <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                                <span class="sheet-toggle-icon"></span>
                                                            </div>
                                                            <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
                                                            <div class="sheet-toggle-checked">
                                                                <div class="sheet-form">
                                                                    <div class="sheet-form-header">Edit Martial Arts</div>
                                                                    <div class="sheet-form-body">
                                                                        <div class="sheet-form-group">
                                                                            <select name="attr_martial_type">
                                                                                <option value="Martial Art" selected="selected">Martial Arts</option>
                                                                                <option value="Form">Form</option>
                                                                            </select>
                                                                            <input type="text" name="attr_martial_name">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sheet-toggle-unchecked">
                                                                <div class="sheet-martial-art">
                                                                    <button type="roll" name="roll_output" value="@{wtype}&{template:traits} @{character_name} {{name=@{martial_type} Martial Arts}} {{description=@{martial_name}}}">
                                                                        <span name="attr_martial_type"></span>
                                                                        <span name="attr_martial_name"></span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div> 
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-container-grouped-right">
                                <div class="sheet-container-well well-attacks">
                                    <div class="sheet-container-box sheet-qi">
                                        <div class="sheet-container-header">Qi Capacity</div>
                                        <div class="sheet-container-body">
                                            <input type="text" name="attr_qi" title="@{qi}">
                                            <span>/</span>
                                            <input type="text" name="attr_qi_max" title="@{qi_max}" disabled="true" hidden>
                                            <span name="attr_qi_max" title="@{qi_max}" style="width:200px"></span>
                                        </div>
                                    </div>
                                    <div class="sheet-container-box sheet-qi-deprivation">
                                        <div class="sheet-container-header">Qi Deprivation</div>
                                        <div class="sheet-container-body">
                                            <input type="text" name="attr_qi_deprivation" title="@{qi_deprivation}" disabled="true" hidden>
                                            <span name="attr_qi_deprivation" title="@{qi_deprivation}"></span>
                                            <ul>
                                                <li>
                                                    <label class="sheet-checkbox">
                                                        <input type="checkbox" name="attr_qi_deprivation_state" value="1" title="@{qi_deprivation}">
                                                        <span title="@{qi_deprivation_state}"><strong>State of Deprivation</strong></span>
                                                    </label>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="sheet-container-panel sheet-attacks">
                                        <div class="sheet-container-header">Attacks & Techniques</div>
                                        <div class="sheet-container-body">
                                            <fieldset class="repeating_attack">
                                                <div class="sheet-fieldset-item">
                                                    <div class="sheet-checkbox-cog">
                                                        <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                        <span class="sheet-toggle-icon"></span>
                                                    </div>
                                                    <input type="checkbox" name="attr_options-flag" checked="checked" hidden class="sheet-toggle">
                                                    <div class="sheet-toggle-checked">
                                                        <div class="sheet-form">
                                                            <div class="sheet-form-header">Edit Attack</div>
                                                            <div class="sheet-form-body">
                                                                <div class="sheet-form-group">
                                                                    <label>Name:</label>
                                                                    <input type="text" name="attr_atkname">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_atkflag" value="{{attack=1}}" checked="checked">
                                                                        <span>Attack:</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <select name="attr_atkattr_base">
                                                                        <option value="@{strength_mod}" selected="selected">STR</option>
                                                                        <option value="@{dexterity_mod}">DEX</option>
                                                                        <option value="@{constitution_mod}">CON</option>
                                                                        <option value="@{intelligence_mod}">INT</option>
                                                                        <option value="@{wisdom_mod}">WIS</option>
                                                                        <option value="@{charisma_mod}">CHA</option>
                                                                        <option value="0">-</option>
                                                                    </select>
                                                                    <span>+</span>
                                                                    <input type="text" name="attr_atkmod" placeholder="0">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_atkprofflag" value="(@{pb})" checked="checked">
                                                                        <span>Proficient</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Range:</label>
                                                                    <input type="text" name="attr_atkrange">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Attack Bonus</label>
                                                                    <input type="text" name="attr_atkmagic">
                                                                    <label>Crit Range:</label>
                                                                    <input type="text" name="attr_atkcritrange" value="20">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_dmgflag" value="{{damage=1}} {{dmg1flag=1}}" checked="checked">
                                                                        <span>Damage 1</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>DMG</label>
                                                                    <input type="text" name="attr_dmgbase">
                                                                    <span>+</span>
                                                                    <select name="attr_dmgattr">
                                                                        <option value="@{strength_mod}" selected="selected">STR</option>
                                                                        <option value="@{dexterity_mod}">DEX</option>
                                                                        <option value="@{constitution_mod}">CON</option>
                                                                        <option value="@{intelligence_mod}">INT</option>
                                                                        <option value="@{wisdom_mod}">WIS</option>
                                                                        <option value="@{charisma_mod}">CHA</option>
                                                                        <option value="0">-</option>
                                                                    </select>
                                                                    <span>+</span>
                                                                    <label>Mod</label>
                                                                    <input type="text" name="attr_dmgmod">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Type:</label>
                                                                    <input type="text" name="attr_dmgtype">
                                                                    <label>Crit:</label>
                                                                    <input type="text" name="attr_dmgcustcrit">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_dmg2flag" value="{{damage=1}} {{dmg2flag=1}}">
                                                                        <span>Damage 2</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Dmg</label>
                                                                    <input type="text" name="attr_dmg2base">
                                                                    <span>+</span>
                                                                    <select name="attr_dmg2attr">
                                                                        <option value="@{strength_mod}">STR</option>
                                                                        <option value="@{dexterity_mod}">DEX</option>
                                                                        <option value="@{constitution_mod}">CON</option>
                                                                        <option value="@{intelligence_mod}">INT</option>
                                                                        <option value="@{wisdom_mod}">WIS</option>
                                                                        <option value="@{charisma_mod}">CHA</option>
                                                                        <option value="0" selected="selected">-</option>
                                                                    </select>
                                                                    <span>+</span>
                                                                    <label>Mod</label>
                                                                    <input type="text" name="attr_dmg2mod">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Type:</label>
                                                                    <input type="text" name="attr_dmg2type">
                                                                    <label>Crit:</label>
                                                                    <input type="text" name="attr_dmg2custcrit">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label class="sheet-form-checkbox">
                                                                        <input type="checkbox" name="attr_saveflag" value="{{save=1}} {{saveattr=@{saveattr}}} {{savedesc=@{saveeffect}}} {{savedc=[[[[@{savedc}]][SAVE]]]}}">
                                                                        <span>Saving Throw</span>
                                                                    </label>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <select name="attr_saveattr">
                                                                        <option value="Strength" selected="selected">STR</option>
                                                                        <option value="Dexterity">DEX</option>
                                                                        <option value="Constitution">CON</option>
                                                                        <option value="Intelligence">INT</option>
                                                                        <option value="Wisdom">WIS</option>
                                                                        <option value="Charisma">CHA</option>
                                                                    </select>
                                                                    <label>vs DC:</label>
                                                                    <select name="attr_savedc">
                                                                        <option value="(@{strength_mod}+8+@{pb})">STR</option>
                                                                        <option value="(@{dexterity_mod}+8+@{pb})">DEX</option>
                                                                        <option value="(@{constitution_mod}+8+@{pb})">CON</option>
                                                                        <option value="(@{intelligence_mod}+8+@{pb})">INT</option>
                                                                        <option value="(@{wisdom_mod}+8+@{pb})">WIS</option>
                                                                        <option value="(@{charisma_mod}+8+@{pb})">CHA</option>
                                                                        <option value="(@{saveflat})">FLAT</option>
                                                                    </select>
                                                                    <input type="hidden" name="attr_savedc">
                                                                    <input type="text" name="attr_saveflat" value="10">
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Save Effect:</label>
                                                                    <input type="text" name="attr_saveeffect">
                                                                </div>
                                                                <div class="sheet-form-group sheet-form-group-column">
                                                                    <label>Description:</label>
                                                                    <textarea name="attr_atk_desc"></textarea>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="sheet-toggle-unchecked">
                                                        <div class="sheet-attack">
                                                            <input type="text" name="attr_atkbonus" class="sheet-hidden" value="">
                                                            <input type="text" name="attr_atkdmgtype" class="sheet-hidden" value="">
                                                            <button type="roll" name="roll_attack" value="@{rollbase}" class="sheet-attack-button">
                                                                <span name="attr_atkname"></span>
                                                                <span name="attr_atkbonus"></span>
                                                                <span name="attr_atkdmgtype"></span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" name="attr_rollbase">
                                                <input type="hidden" name="attr_rollbase_dmg">
                                                <input type="hidden" name="attr_rollbase_crit">
                                                <input type="hidden" name="attr_hldmg">
                                                <input type="hidden" name="attr_itemid">
                                                <button type="roll" name="roll_attack_dmg" value="@{rollbase_dmg}" class="sheet-hidden"></button>
                                                <button type="roll" name="roll_attack_crit" value="@{rollbase_crit}" class="sheet-hidden"></button>
                                            </fieldset>
                                        </div>
                                    </div>
                                </div> 
                                <div class="sheet-col sheet-container-effects">
                                    <div class="sheet-container-well well-strain">
                                        <div class="sheet-container-box sheet-stress">
                                            <div class="sheet-container-header">Pathway Damage</div>
                                            <div class="sheet-container-body">
                                                <input type="text" name="attr_pathway" title="@{pathway}" value="0">
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-stress-levels">
                                            <div class="sheet-container-header">Pathway Damage Levels</div>
                                            <div class="sheet-container-body">
                                                <ul>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pathway_state_4" value="1" title="@{pathway_state_4}">
                                                            <span title="@{pathway_state_4}"><strong>4:</strong> Affliction</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pathway_state_6" value="1" title="@{pathway_state_6}">
                                                            <span title="@{pathway_state_6}"><strong>6:</strong> Affliction</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pathway_state_8" value="1" title="@{pathway_state_8}">
                                                            <span title="@{pathway_state_8}"><strong>8:</strong> Affliction</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pathway_state_10" value="1" title="@{pathway_state_10}">
                                                            <span title="@{pathway_state_10}"><strong>10:</strong> Breakpoint</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="sheet-container-box sheet-pill_poison">
                                            <div class="sheet-container-header">Pill Poison</div>
                                            <div class="sheet-container-body">
                                                <span name="attr_pill_poison_max" class="sheet-calculated sheet-hidden">400</span>
                                                <input type="text" name="attr_pill_poison" title="@{pill_poison}" value="0">
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-pill_poison-levels">
                                            <div class="sheet-container-header">Pill Poison Levels</div>
                                            <div class="sheet-container-body">
                                                <ul>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pill_poison_state_100" value="1" title="@{pill_poison_state_100}">
                                                            <span title="@{pill_poison_state_100}"><strong>100:</strong>Stage 1</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pill_poison_state_200" value="1" title="@{pill_poison_state_200}">
                                                            <span title="@{pill_poison_state_200}"><strong>200:</strong> Stage 2</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pill_poison_state_300" value="1" title="@{pill_poison_state_300}">
                                                            <span title="@{pill_poison_state_300}"><strong>300:</strong> Stage 3</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label class="sheet-checkbox">
                                                            <input type="checkbox" name="attr_pill_poison_state_400" value="1" title="@{pill_poison_state_400}">
                                                            <span title="@{pill_poison_state_400}"><strong>400:</strong> Death</span>
                                                        </label>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="sheet-container-panel sheet-afflictions">
                                            <div class="sheet-container-header">Afflictions</div>
                                            <div class="sheet-container-body">
                                                <div class="sheet-container-body-header">
                                                    <span>Affliction</span>
                                                    <span>Effect</span>
                                                </div>
                                                <fieldset class="repeating_afflictions">
                                                    <div class="sheet-fieldset-item">
                                                        <div class="sheet-checkbox-cog">
                                                            <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                            <span class="sheet-toggle-icon"></span>
                                                        </div>
                                                        <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
                                                        <div class="sheet-toggle-checked">
                                                            <div class="sheet-form">
                                                                <div class="sheet-form-header">Edit Affliction</div>
                                                                <div class="sheet-form-body">
                                                                    <div class="sheet-form-group">
                                                                        <select name="attr_affliction">
                                                                            <option value="Fearful: Disadvantage on Sanity checks/saves">Fearful</option>
                                                                            <option value="Hopelessness: Disadvantage on STR checks/saves">Hopelessness</option>
                                                                            <option value="Hypochondria: Hit point maximum is halved">Hypochondria</option>
                                                                            <option value="Irrational: Disadvantage on Sanity checks/saves">Irrational</option>
                                                                            <option value="Mania: Disadvantage on attack rolls">Mania</option>
                                                                            <option value="Masochistic: Disadvantage on CON checks/saves">Masochistic</option>
                                                                            <option value="Narcissistic: Disadvantage on ability checks">Narcissistic</option>
                                                                            <option value="Panic: Disadvantage on DEX checks/saves">Panic</option>
                                                                            <option value="Paranoid: Speed is halved">Paranoid</option>
                                                                            <option value="Selfish: Disadvantage on Honor checks/saves">Selfish</option>
                                                                            <option value="Stage 1 Pill Poison: Bad Things">Stage 1 Pill Poison</option>
                                                                            <option value="Stage 2 Pill Poison: Very Bad Things">Stage 2 Pill Poison</option>
                                                                            <option value="Stage 3 Pill Poison: Super Very Bad Things">Stage 3 Pill Poison</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="sheet-toggle-unchecked">
                                                            <div class="sheet-pc-affliction">
                                                                <span name="attr_affliction"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </fieldset>
                                            </div>
                                        </div>
                                    </div> 
                                    <div class="sheet-container-well well-effects">
                                        <div class="sheet-container-effects sheet-container-well-effects">
                                            <div class="sheet-container-panel sheet-effects">
                                                <div class="sheet-container-header">Effects & Conditions</div>
                                                <div class="sheet-container-body">
                                                    <div class="sheet-container-body-header">
                                                        <span></span>
                                                        <span>Description</span>
                                                    </div>
                                                    <fieldset class="repeating_effects-conditions">
                                                        <div class="sheet-fieldset-item">
                                                            <div class="sheet-checkbox-cog">
                                                                <input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
                                                                <span class="sheet-toggle-icon"></span>
                                                            </div>
                                                            <input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
                                                            <div class="sheet-toggle-checked">
                                                                <div class="sheet-form">
                                                                    <div class="sheet-form-header">Edit Effect</div>
                                                                    <div class="sheet-form-body">
                                                                        <div class="sheet-form-group">
                                                                            <input type="text" name="attr_description">
                                                                        </div>
                                                                        <div class="sheet-form-group">
                                                                            <label class="sheet-form-checkbox">
                                                                                <input type="checkbox" name="attr_active" value="1" checked="checked">
                                                                                <span>Active</span>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="sheet-toggle-unchecked">
                                                                <div class="sheet-pc-effect">
                                                                    <div class="sheet-checkbox-image">
                                                                        <input type="checkbox" name="attr_active" value="1" checked="checked">
                                                                        <span></span>
                                                                    </div>
                                                                    <span name="attr_description"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div>
                                    </div> 
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-tab sheet-tab-features">
                    <input type="radio" name="attr_tab" value="features">
                    <span class="sheet-tab-label">Features</span>
                    <div class="sheet-tab-content">
                        <div class="sheet-container-well sheet-container-well-details">
							<div class="sheet-container-panel sheet-pc-details">
								<div class="sheet-container-header">Character Details</div>
								<div class="sheet-container-body">
									<div class="sheet-pc-detail">
										<label>Age</label>
										<input type="text" name="attr_character_age_detail" title="@{character_age_detail}">
									</div>
									<div class="sheet-pc-detail">
										<label>Height</label>
										<input type="text" name="attr_character_height_detail" title="@{character_height_detail}">
									</div>
									<div class="sheet-pc-detail">
										<label>Weight</label>
										<input type="text" name="attr_character_weight_detail" title="@{character_weight_detail}">
									</div>
									<div class="sheet-pc-detail sheet-pc-detail-habit">
										<label>Habit</label>
										<div class="sheet-pc-detail-column">
											<input type="text" name="attr_character_habit_detail" title="@{character_habit_detail}">
										</div>
									</div>
									<div class="sheet-pc-detail">
										<label>Family</label>
										<select name="attr_character_family" title="@{character_family}">
											<option value=""></option>
											<option value="none">None</option>
											<option value="small">Small</option>
											<option value="average">Average</option>
											<option value="large">Large</option>
											<option value="disowned">Disowned</option>
										</select>
									</div>
									<div class="sheet-pc-detail">
										<label>Raised By</label>
										<select name="attr_character_raised_by" title="@{character_raised_by}">
											<option value=""></option>
											<option value="natural_parents">Natural parent(s)</option>
											<option value="close_family">Close family</option>
											<option value="adopted">Adopted parent(s)</option>
											<option value="institution">An institution</option>
											<option value="yourself">Yourself</option>
										</select>
									</div>
								</div>
							</div>
							<div class="sheet-container-box sheet-pc-gimmick">
								<div class="sheet-container-header">Gimmick</div>
								<div class="sheet-container-body">
									<textarea name="attr_gimmick" title="@{gimmick}" placeholder="Examples of Gimmicks: Quick to Anger, Scaredy Cat, Jokester, Absolute Idiot, Know-it-All, Excessively Naive, Prissy Noble, Morbid and Creepy, Compulsive Liar."></textarea>
								</div>
							</div>
							<div class="sheet-container-box sheet-pc-values">
								<div class="sheet-container-header">Values</div>
								<div class="sheet-container-body">
									<textarea name="attr_values" title="@{values}" placeholder="Examples of Values: Accomplishment, Brilliance, Daring, Elegance, Harmony, Loyalty, Prudence."></textarea>
								</div>
							</div>
							<div class="sheet-container-box sheet-pc-conflict">
								<div class="sheet-container-header">Conflict</div>
								<div class="sheet-container-body">
									<textarea name="attr_conflict" title="@{conflict}" placeholder="Conflicts include: being persecuted for a crime they did not commit; evading authorities; being disowned by their family; losing a loved one; suffering a great injustice; being the subject of a prophecy; and discovering a mystery."></textarea>
								</div>
							</div>
							<div class="sheet-container-box sheet-pc-wants">
								<div class="sheet-container-header">Wants</div>
								<div class="sheet-container-body">
									<textarea name="attr_wants" title="@{wants}" placeholder="Example of wants: I want to find out who my parents are; I want to become strong enough so that I dont rely on anyone else again; I want those that wronged me to suffer; I want to be rich; I want to bring a loved one back from the dead;"></textarea>
								</div>
							</div>
                        </div>
                        <div class="sheet-container-well sheet-container-well-memories">
							<div class="sheet-container-panel sheet-pc-memories">
								<div class="sheet-container-header">Memories & Events</div>
								<div class="sheet-container-body">
									<fieldset class="repeating_memories">
										<div class="sheet-fieldset-item">
											<div class="sheet-checkbox-cog">
												<input type="checkbox" name="attr_options-flag" checked="checked">
												<span class="sheet-toggle-icon"></span>
											</div>
											<input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
											<div class="sheet-toggle-checked">
												<div class="sheet-form">
													<div class="sheet-form-header">Edit Memory</div>
													<div class="sheet-form-body">
														<div class="sheet-form-group">
															<label>Memory or Event:</label>
															<input type="text" name="attr_memory_name">
														</div>
														<div class="sheet-form-group">
															<textarea name="attr_memory_description"></textarea>
														</div>
													</div>
												</div>
											</div>
											<div class="sheet-toggle-unchecked">
												<div class="sheet-pc-memory">
													<span name="attr_memory_name"></span>
													<span name="attr_memory_description"></span>
												</div>
											</div>
										</div>
									</fieldset>
								</div>
							</div>
							<div class="sheet-container-panel sheet-pc-notes">
								<div class="sheet-container-header">Additional Notes</div>
								<div class="sheet-container-body">
									<fieldset class="repeating_notes">
										<div class="sheet-fieldset-item">
											<div class="sheet-checkbox-cog">
												<input type="checkbox" name="attr_options-flag" checked="checked">
												<span class="sheet-toggle-icon"></span>
											</div>
											<input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
											<div class="sheet-toggle-checked">
												<div class="sheet-form">
													<div class="sheet-form-header">Edit Note</div>
													<div class="sheet-form-body">
														<div class="sheet-form-group">
															<label>Note:</label>
															<input type="text" name="attr_note_name">
														</div>
														<div class="sheet-form-group">
															<textarea name="attr_note_description"></textarea>
														</div>
													</div>
												</div>
											</div>
											<div class="sheet-toggle-unchecked">
												<div class="sheet-pc-note">
													<span name="attr_note_name"></span>
													<span name="attr_note_description"></span>
												</div>
											</div>
										</div>
									</fieldset>
								</div>
							</div>
                        </div>
                        <div class="sheet-container-well sheet-container-well-features">
							<div class="sheet-container-panel sheet-pc-features">
								<div class="sheet-container-header">Features & Talents</div>
								<div class="sheet-container-body">
									<fieldset class="repeating_traits">
										<div class="sheet-fieldset-item">
											<div class="sheet-checkbox-cog">
												<input type="checkbox" name="attr_options-flag" checked="checked">
												<span class="sheet-toggle-icon"></span>
											</div>
											<input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
											<div class="sheet-toggle-checked">
												<div class="sheet-form">
													<div class="sheet-form-header">Edit Feature</div>
													<div class="sheet-form-body">
														<div class="sheet-form-group">
															<label>Name:</label>
															<input type="text" name="attr_name" placeholder="Duty Of The Mighty">
														</div>
														<div class="sheet-form-group">
															<label>Source:</label>
															<select name="attr_source">
																<option selected="selected">Class</option>
																<option>Racial</option>
																<option>Background</option>
																<option>Talent</option>
																<option>Other</option>
															</select>
														</div>
														<div class="sheet-form-group">
															<label>Source Type:</label>
															<input type="text" name="attr_source_type" placeholder="Body Refiner">
														</div>
														<div class="sheet-form-group">
															<textarea name="attr_description" placeholder="When an enemy attempts to attack an ally, and if you are within 5ft of the enemy or that ally, intercept and take the attack for the aforementioned ally."></textarea>
														</div>
														<div class="sheet-form-group">
															<label class="sheet-form-checkbox">
																<input type="checkbox" name="attr_hide_details" value="1">
																<span>Hide Details</span>
															</label>
														</div>
													</div>
												</div>
											</div>
											<div class="sheet-toggle-unchecked">
												<div class="sheet-pc-feature">
													<button type="roll" name="roll_output" value="@{wtype}&{template:traits} @{character_name} {{name=@{name}}} {{source=@{source}: @{source_type}}} {{description=@{description}}}">
														<div class="sheet-pc-feature-name">
															<span name="attr_name"></span>
														</div>
														<input type="hidden" name="attr_hide_details" class="sheet-field-untoggle">
														<div class="sheet-pc-feature-details">
															<span class="sheet-pc-feature-source">
																<span name="attr_source"></span>
																<span name="attr_source_type"></span>
															</span>
															<span name="attr_description"></span>
														</div>
													</button>
												</div>
											</div>
										</div>
									</fieldset>
								</div>
							</div>
                        </div>
                    </div>
                </div>
                <div class="sheet-tab sheet-tab-notes">
                    <input type="radio" name="attr_tab" value="notes">
                    <span class="sheet-tab-label">Notes</span>
                    <div class="sheet-tab-content">
                        <div class="sheet-pc-notes">
                            <div class="sheet-container-well well-backstory">
                                <div class="sheet-container-panel">
                                    <div class="sheet-container-header">Character Backstory</div>
                                    <div class="sheet-container-body">
                                        <textarea name="attr_character_backstory"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-container-well well-additional_features">
                                <div class="sheet-container-panel">
                                    <div class="sheet-container-header">Additional Notes</div>
                                    <div class="sheet-container-body">
                                        <textarea name="attr_additional_features_and_traits"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-container-well well-ally_org">
                                <div class="sheet-container-panel">
                                    <div class="sheet-container-header">Allies & Organisations</div>
                                    <div class="sheet-container-body">
                                        <textarea name="attr_allies_and_organisations"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-container-well well-treasure">
                                <div class="sheet-container-panel">
                                    <div class="sheet-container-header">Treasures</div>
                                    <div class="sheet-container-body">
                                        <textarea name="attr_treasures"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-container-well well-jade-slip">
                                <div class="sheet-container-panel">
                                    <div class="sheet-container-header">Jade Slip</div>
                                    <div class="sheet-container-body">
                                        <textarea name="attr_jade_slip"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-tab sheet-tab-equipment">
					<input type="radio" name="attr_tab" value="equipment">
					<span class="sheet-tab-label">Equipment</span>
					<div class="sheet-tab-content">
						<div class="sheet-container-well sheet-container-well-equipment-supplies">
							<div class="sheet-container-bar sheet-pc-rations">
								<div class="sheet-container-header">Rations</div>
								<div class="sheet-container-body">
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_ration_1" title="@{ration_1}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_ration_2" title="@{ration_2}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_ration_3" title="@{ration_3}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_ration_4" title="@{ration_4}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_ration_5" title="@{ration_5}">
										<span></span>
									</div>
								</div>
							</div>
							<div class="sheet-container-bar sheet-pc-water">
								<div class="sheet-container-header">Waterskin</div>
								<div class="sheet-container-body">
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_waterskin_1" title="@{waterskin_1}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_waterskin_2" title="@{waterskin_2}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_waterskin_3" title="@{waterskin_3}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_waterskin_4" title="@{waterskin_4}">
										<span></span>
									</div>
									<div class="sheet-checkbox-image">
										<input type="checkbox" name="attr_waterskin_5" title="@{waterskin_5}">
										<span></span>
									</div>
								</div>
							</div>
						</div>
						<div class="sheet-container-well sheet-container-well-equipment-purse">
							<div class="sheet-container-bar sheet-pc-purse-cp">
								<div class="sheet-container-header">
									<input type="text" name="attr_cp_title" title="@{cp_title}" value="COPPER" disabled>
								</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_cp" title="@{cp}">
								</div>
							</div>
							<div class="sheet-container-bar sheet-pc-purse-sp">
								<div class="sheet-container-header">
									<input type="text" name="attr_sp_title" title="@{sp_title}" value="SILVER" disabled>
								</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_sp" title="@{sp}">
								</div>
							</div>
							<div class="sheet-container-bar sheet-pc-purse-gp">
								<div class="sheet-container-header">
									<input type="text" name="attr_gp_title" title="@{gp_title}" value="GOLD" disabled>
								</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_gp" title="@{gp}">
								</div>
							</div>
							<div class="sheet-container-bar sheet-pc-purse-ctrb">
								<div class="sheet-container-header">
									<input type="text" name="attr_ctrb_title" title="@{ctrb_title}" value="CONTRIBUTION" disabled>
								</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_ctrb" title="@{ctrb}">
								</div>
							</div>
							<div class="sheet-container-bar sheet-pc-purse-ss">
								<div class="sheet-container-header">
									<input type="text" name="attr_ss_title" title="@{ss_title}" value="SPIRIT STONES" disabled>
								</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_ss" title="@{ss}">
								</div>
							</div>
							<div class="sheet-container-bar sheet-pc-purse-other" >
								<div class="sheet-container-header">
									<input type="text" name="attr_currency" title="@{currency}" placeholder="Jade Stars">
								</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_currency_value" title="@{currency_value}">
								</div>
							</div>
						</div>
						<div class="sheet-container-well sheet-container-well-equipment-encumberance">
							<div class="sheet-container-box sheet-pc-weight">
								<div class="sheet-container-header">Weight</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_weighttotal" title="@{weighttotal}">
									<span>/</span>
									<span name="attr_weightmaximum" title="@{weightmaximum}"></span>
								</div>
								<div class="sheet-container-footer">
									<span>Current</span>
									<span>Maximum</span>
								</div>
							</div>
							<input type="hidden" name="attr_use_inventory_slots" value="1" class="sheet-field-toggle">
							<div class="sheet-container-box sheet-pc-slots">
								<div class="sheet-container-header">Inventory Slots</div>
								<div class="sheet-container-body">
									<input type="text" name="attr_slotstotal" title="@{slotstotal}">
									<span>/</span>
									<span name="attr_slotsmaximum" title="@{slotsmaximum}"></span>
								</div>
								<div class="sheet-container-footer">
									<span>Current</span>
									<span>Maximum</span>
								</div>
							</div>
                            <div class="sheet-pc-carrying-status">
                                <input type="hidden" class="sheet-pc-encumberance" name="attr_encumberance">
                                <span class="sheet-pc-unencumbered">Unencumbered</span>
                                <span class="sheet-pc-encumbered">Encumbered</span>
                                <span class="sheet-pc-heavily">Heavily encumbered</span>
                                <span class="sheet-pc-immobile">Immobile</span>
                                <span class="sheet-pc-over">Over carrying capacity</span>
                            </div>
						</div>
						<div class="sheet-container-well sheet-container-well-equipment-general">
							<div class="sheet-container-panel sheet-pc-equipment-other">
								<div class="sheet-container-header">Key Items</div>
								<div class="sheet-container-body">
									<fieldset class="repeating_otheritems">
										<div class="sheet-fieldset-item">
											<div class="sheet-checkbox-cog">
												<input type="checkbox" name="attr_options-flag" checked="checked"><span></span>
												<span class="sheet-toggle-icon"></span>
											</div>
											<input type="checkbox" name="attr_options-flag" checked="checked" hidden class="sheet-toggle">
											<div class="sheet-toggle-checked">
												<div class="sheet-form">
													<div class="sheet-form-header">Edit Item</div>
													<div class="sheet-form-body">
														<div class="sheet-form-group">
															<label>Name:</label>
															<input type="text" name="attr_otheritem-name">
														</div>
														<div class="sheet-form-group">
															<textarea name="attr_otheritem-description"></textarea>
														</div>
													</div>
												</div>
											</div>
											<div class="sheet-toggle-unchecked">
												<div class="sheet-pc-otheritem">
													<span name="attr_otheritem-name"></span><span name="attr_otheritem-description"></span>
												</div>
											</div>
										</div>
									</fieldset>
								</div>
							</div>
						</div>
						<div class="sheet-container-well sheet-container-well-equipment">
							<div class="sheet-container-panel sheet-pc-equipment">
								<div class="sheet-container-header">Equipment & Holdings</div>
								<div class="sheet-container-body">
									<input type="hidden" name="attr_use_inventory_slots" class="sheet-toggle-slots" value="1">
									<input type="hidden" name="attr_armorwarningflag" class="sheet-field-toggle">
									<fieldset class="repeating_inventory">
										<div class="sheet-fieldset-item">
											<div class="sheet-checkbox-cog">
												<input type="checkbox" name="attr_options-flag" checked="checked">
												<span class="sheet-toggle-icon"></span>
											</div>
											<input type="checkbox" name="attr_options-flag" checked="checked" class="sheet-toggle" hidden>
											<div class="sheet-toggle-checked">
												<div class="sheet-form sheet-form-item">
													<div class="sheet-form-header">Edit Item</div>
													<div class="sheet-form-body">
														<input type="hidden" name="attr_equipped">
														<input type="hidden" name="attr_carried">
														<input type="hidden" name="attr_inventorysubflag">
														<input type="hidden" name="attr_itemattackid">
														<input type="hidden" name="attr_itemresourceid">
														<div class="sheet-item-contents">
															<div class="sheet-form-group">
																<label>Name:</label>
																<input type="text" name="attr_itemname">
															</div>
															<input type="checkbox" name="attr_itemcontainer" value="1" class="sheet-toggle" hidden>
															<div class="sheet-toggle-unchecked">
																<div class="sheet-form-group">
																	<label>Quantity</label>
																	<input type="text" name="attr_itemcount" value="1">
																</div>
																<div class="sheet-form-group">
																	<label>Weight:</label>
																	<input type="text" name="attr_itemweight">
																	<label class="sheet-form-checkbox">
																		<input type="checkbox" name="attr_itemweightfixed" value="1">
																		<span>Fixed (Ignore quantity)</span>
																	</label>
																</div>
																<div class="sheet-form-group">
																	<label>Size:</label>
																	<select name="attr_itemsize">
																		<option value="0.2">Tiny (0.2 slots)</option>
																		<option value="1" selected>Small (1 slot)</option>
																		<option value="2">Medium (2 slots)</option>
																		<option value="3">Large (3 slots)</option>
																		<option value="6">X-Large (6 slots)</option>
																		<option value="9">XX-Large (9 slots)</option>
																		<option value="12">XXX-Large (12 slots)</option>
																		<option value="15">XXXX-Large (15 slots)</option>
																		<option value="18">XXXXX-Large (18 slots)</option>
																	</select>
																	<label class="sheet-form-checkbox">
																		<input type="checkbox" name="attr_itemslotsfixed" value="1">
																		<span>Fixed (Ignore quantity)</span>
																	</label>
																</div>
																<div class="sheet-form-group sheet-item-columns-2">
																	<div class="sheet-form-group">
																		<label>Notches:</label>
																		<input type="text" name="attr_itemnotches" value="0">
																	</div>
																	<div class="sheet-form-group">
																		<label>Quality:</label>
																		<select name="attr_itemquality">
																			<option value="" selected="selected"></option>
																			<option value="pristine">Pristine</option>
																			<option value="worn">Worn</option>
																			<option value="wellworn">Well-worn</option>
																			<option value="scarred">Scarred</option>
																			<option value="broken">Broken</option>
																		</select>
																	</div>
																</div>
                                                                <div class="sheet-form-group">
                                                                    <label>Equipped in Slot:</label>
                                                                    <select name="attr_itemequipedslot">
                                                                        <option value="" selected="selected"></option>
                                                                        <option value="(Helmet Slot)">Helmet</option>
                                                                        <option value="(Earring Slot)">Earring</option>
                                                                        <option value="(Necklace Slot)">Necklace</option>
                                                                        <option value="(Shoulders Slot)">Shoulders</option>
                                                                        <option value="(Cloak Slot)">Cloack</option>
                                                                        <option value="(Chest Slot)">Chest</option>
                                                                        <option value="(Robe Slot)">Robe</option>
                                                                        <option value="(Wrist Slot)">Wrist</option>
                                                                        <option value="(Glove Slot)">Glove</option>
                                                                        <option value="(Ring Slot)">Ring</option>
                                                                        <option value="(Belt Slot)">Belt</option>
                                                                        <option value="(Boots Slot)">Boots</option>
                                                                    </select>
                                                                </div>
																<div class="sheet-form-group">
																	<label>Properties:</label>
																	<input type="text" name="attr_itemproperties">
																</div>
																<div class="sheet-form-group">
																	<label>Modifiers:</label>
																	<input type="text" name="attr_itemmodifiers">
																</div>
																<div class="sheet-form-group">
																	<label>Description:</label>
																	<textarea name="attr_itemcontent"></textarea>
																</div>
															</div>
															<div class="sheet-toggle-checked">
																<div class="sheet-item-columns-2">
																	<div class="sheet-form-group">
																		<label>Type:</label>
																		<select name="attr_itemcontainer_type">
																			<option value="bag" selected="selected">Bag</option>
																			<option value="belt">Belt</option>
																			<option value="pouch">Pouch</option>
																			<option value="quiver">Quiver</option>
																			<option value="sheath">Sheath</option>
																			<option value="stash">Stash</option>
																			<option value="property">Property</option>
																			<option value="vehicle">Vehicle</option>
																			<option value="worn">Worn</option>
																		</select>
																	</div>
																	<div class="sheet-form-group">
																		<label>Max. Capacity (Slots):</label>
																		<input type="text" name="attr_itemcontainer_slots" value="3">
																	</div>
																</div>
																<div class="sheet-form-group">
																	<label>Inventory Slots Modifier:</label>
																	<input type="text" name="attr_itemcontainer_slots_modifier">
																</div>
															</div>
														</div>
														<div class="sheet-item-options">
															<div class="sheet-form-group">
																<label class="sheet-form-checkbox">
																	<input type="checkbox" name="attr_equipped" value="1" checked="checked">
																	<span>Equipped</span>
																</label>
															</div>
															<div class="sheet-form-group">
																<label class="sheet-form-checkbox">
																	<input type="checkbox" name="attr_carried" value="1" checked="checked">
																	<span>Carried</span>
																</label>
															</div>
															<div class="sheet-form-group">
																<label class="sheet-form-checkbox">
																	<input type="checkbox" name="attr_itemcontainer" value="1">
																	<span>Container</span>
																</label>
															</div>
															<input type="checkbox" name="attr_itemcontainer" value="1" class="sheet-toggle" hidden>
														</div>
													</div>
												</div>
											</div>
											<div class="sheet-toggle-unchecked">
												<input type="checkbox" name="attr_itemcontainer" value="1" class="sheet-toggle" hidden>
												<div class="sheet-toggle-unchecked">
													<div class="sheet-pc-item">
														<div class="sheet-pc-item-header">
															<span>Item Name</span>
															<span>Quantity</span>
															<span>Weight</span>
															<span>Slots</span>
															<span>Notches</span>
														</div>
														<div class="sheet-pc-item-content">
															<span class="sheet-pc-item-name">
																<input type="hidden" name="attr_equipped" value="1" class="sheet-field-toggle">
																<span class="sheet-pc-item-equipped"><strong>E</strong></span>
																<input type="hidden" name="attr_carried" value="1" class="sheet-field-toggle">
																<span class="sheet-pc-item-carried"><strong>C</strong></span>
																<span name="attr_itemname"></span>
                                                                <span name="attr_itemequipedslot"></span>
															</span>
															<span class="sheet-pc-item-quantity">
																<input type="text" name="attr_itemcount">
															</span>
															<span class="sheet-pc-item-weight">
																<input type="text" name="attr_itemweight">
																<span name="attr_itemweight"></span>
															</span>
															<span class="sheet-pc-item-slots">
																<input type="text" name="attr_itemsize">
															</span>
															<span class="sheet-pc-item-notches">
																<input type="text" name="attr_itemnotches">
															</span>
														</div>
													</div>
												</div>
												<div class="sheet-toggle-checked">
													<div class="sheet-pc-equipment-container">
														<input type="hidden" name="attr_equipped" value="1" class="sheet-field-toggle">
														<span class="sheet-pc-item-equipped"><strong>E</strong></span>
														<input type="hidden" name="attr_carried" value="1" class="sheet-field-toggle">
														<span class="sheet-pc-item-carried"><strong>C</strong></span>
														<span name="attr_itemname"></span>
														<span class="sheet-pc-equipment-container-slots">
															(
															<span name="attr_itemcontainer_type"></span>
															<input type="hidden" name="attr_itemcontainer_slots" class="sheet-field-toggle">
															<span> capacity <span name="attr_itemcontainer_slots"></span></span>
															<input type="hidden" name="attr_itemcontainer_slots_modifier" class="sheet-field-toggle">
															<span> extra slots <span name="attr_itemcontainer_slots_modifier"></span></span>
															)
														</span>
													</div>
													<div class="sheet-pc-equipment-container-footer">
														<span>Item Name</span>
														<span>Quantity</span>
														<span>Weight</span>
														<span>Slots</span>
														<span>Notches</span>
													</div>
												</div>
											</div>
										</div>
									</fieldset>
								</div>
							</div>
						</div>
					</div>
                </div>
                <div class="sheet-tab sheet-tab-options">
                    <input type="radio" name="attr_tab" value="options">
                    <span class="sheet-tab-label">Options</span>
                    <div class="sheet-tab-content">
						<div class="sheet-container-well sheet-pc-options">
                            <div class="sheet-pc-option-left">
                                <div class="sheet-container-panel sheet-pc-option-general">
                                    <div class="sheet-container-header">General Options</div>
                                    <div class="sheet-container-body">
                                        <div class="sheet-form sheet-form-borderless">
                                            <div class="sheet-form-body">
                                                <div class="sheet-form-group">
                                                    <label>Version:</label>
                                                    <input type="text" name="attr_version" value="1.2.8.6" hidden disabled>
                                                    <span name="attr_version"></span>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Roll Queries:</label>
                                                    <select name="attr_rtype" title="@{rtype}">
                                                        <option value="{{always=1}} {{r2=[[@{d20}">Always Roll Advantage</option>
                                                        <option value="@{advantagetoggle}">Advantage Toggle</option>
                                                        <option value="{{query=1}} ?{Advantage?|Normal Roll,&#123&#123normal=1&#125&#125 &#123&#123r2=[[0d20|Advantage,&#123&#123advantage=1&#125&#125 &#123&#123r2=[[@{d20}|Disadvantage,&#123&#123disadvantage=1&#125&#125 &#123&#123r2=[[@{d20}}">Query Advantage</option>
                                                        <option value="{{normal=1}} {{r2=[[0d20">Never Roll Advantage</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Whisper Rolls to GM:</label>
                                                    <select name="attr_wtype" title="@{wtype}">
                                                        <option value="">Never Whisper Rolls</option>
                                                        <option value="@{whispertoggle}">Whisper Toggle</option>
                                                        <option value="?{Whisper?|Public Roll,|Whisper Roll,/w gm }">Query Whisper</option>
                                                        <option value="/w gm ">Always Whisper Rolls</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Auto Damage Roll:</label>
                                                    <select name="attr_dtype" title="@{dtype}">
                                                        <option value="pick">Don't Auto Roll Damage</option>
                                                        <option value="full">Auto Roll Damage & Crit</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="sheet-container-panel sheet-pc-option-attribute">
                                    <div class="sheet-container-header">Attribute Options</div>
                                    <div class="sheet-container-body">
                                        <div class="sheet-form sheet-form-borderless">
                                            <div class="sheet-form-body">
                                                <div class="sheet-form-group">
                                                    <label>Strength Modifier:</label>
                                                    <input type="text" name="attr_strength_bonus" placeholder="0" title="@{strength_bonus}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Dexterity Modifier:</label>
                                                    <input type="text" name="attr_dexterity_bonus" placeholder="0" title="@{dexterity_bonus}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Constitution Modifier:</label>
                                                    <input type="text" name="attr_constitution_bonus" placeholder="0" title="@{constitution_bonus}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Intelligence Modifier:</label>
                                                    <input type="text" name="attr_intelligence_bonus" placeholder="0" title="@{intelligence_bonus}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Wisdom Modifier:</label>
                                                    <input type="text" name="attr_wisdom_bonus" placeholder="0" title="@{wisdom_bonus}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Charisma Modifier:</label>
                                                    <input type="text" name="attr_charisma_bonus" placeholder="0" title="@{charisma_bonus}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Initiative Modifier:</label>
                                                    <input type="text" name="attr_initmod" placeholder="0" title="@{initmod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Initiative Style:</label>
                                                    <select name="attr_initiative_style" title="@{initiative_style}">
                                                        <option value="@{d20}" selected="selected">Normal</option>
                                                        <option value="{@{d20},@{d20}}kh1">Advantage</option>
                                                        <option value="{@{d20},@{d20}}kl1">Disadvantage</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Armor Class Tracking:</label>
                                                    <select name="attr_custom_ac_flag" title="@{custom_ac_flag}">
                                                        <option value="0" selected="selected">Automatic</option>
                                                        <option value="2">Off</option>
                                                    </select>
                                                </div>
                                                <input type="hidden" name="attr_custom_ac_flag" class="sheet-field-toggle">
                                                <div class="sheet-form-fieldset sheet-form-fieldset-hp-modifiers">
                                                    <div class="sheet-form-fieldset-header">HP MODIFIERS</div>
                                                    <div class="sheet-form-fieldset-body">
                                                        <fieldset class="repeating_hpmod">
                                                            <div class="sheet-fieldset-item">
                                                                <div class="sheet-form-group">
                                                                    <label>Level:</label>
                                                                    <select name="attr_levels">
                                                                        <option value="total" selected="selected">Total level</option>
                                                                        <option value="base">Main class level</option>
                                                                        <option value="multiclass1">Class 2 level</option>
                                                                        <option value="multiclass2">Class 3 level</option>
                                                                        <option value="multiclass3">Class 4 level</option>
                                                                    </select>
                                                                </div>
                                                                <div class="sheet-form-group">
                                                                    <label>Source:</label>
                                                                    <input type="text" name="attr_source">
                                                                    <label>Mod:</label>
                                                                    <input type="text" name="attr_mod">
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="sheet-pc-option-right">
                                <div class="sheet-container-panel sheet-pc-option-save">
                                    <div class="sheet-container-header">Saving Throw Options</div>
                                    <div class="sheet-container-body">
                                        <div class="sheet-form sheet-form-borderless">
                                            <div class="sheet-form-body">
                                                <div class="sheet-form-group">
                                                    <label>Strength Save Modifier:</label>
                                                    <input type="text" name="attr_strength_save_mod" placeholder="0" title="@{strength_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Dexterity Save Modifier:</label>
                                                    <input type="text" name="attr_dexterity_save_mod" placeholder="0" title="@{dexterity_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Constitution Save Modifier:</label>
                                                    <input type="text" name="attr_constitution_save_mod" placeholder="0" title="@{constitution_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Intelligence Save Modifier:</label>
                                                    <input type="text" name="attr_intelligence_save_mod" placeholder="0" title="@{intelligence_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Wisdom Save Modifier:</label>
                                                    <input type="text" name="attr_wisdom_save_mod" placeholder="0" title="@{wisdom_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Charisma Save Modifier:</label>
                                                    <input type="text" name="attr_charisma_save_mod" placeholder="0" title="@{charisma_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Sanity Save Modifier:</label>
                                                    <input type="text" name="attr_sanity_save_mod" placeholder="0" title="@{sanity_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Honor Save Modifier:</label>
                                                    <input type="text" name="attr_honor_save_mod" placeholder="0" title="@{honor_save_mod}">
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Death Save Modifier:</label>
                                                    <input type="text" name="attr_death_save_mod" placeholder="0" title="@{death_save_mod}">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="sheet-container-panel sheet-pc-option-skill">
                                    <div class="sheet-container-header">Skill Options</div>
                                    <div class="sheet-container-body">
                                        <div class="sheet-form sheet-form-borderless">
                                            <div class="sheet-form-borderless">
                                                <div class="sheet-form-group">
                                                    <label>Acrobatics Modifier:</label>
                                                    <input type="text" name="attr_acrobatics_flat" placeholder="0" title="@{acrobatics_flat}">
                                                    <select name="attr_acrobatics_type" title="@{acrobatics_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Animal Handling Modifier:</label>
                                                    <input type="text" name="attr_animal_handling_flat" placeholder="0" title="@{animal_handling_flat}">
                                                    <select name="attr_animal_handling_type" title="@{animal_handling_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Arcana Modifier:</label>
                                                    <input type="text" name="attr_arcana_flat" placeholder="0" title="@{arcana_flat}">
                                                    <select name="attr_arcana_type" title="@{arcana_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Athletics Modifier:</label>
                                                    <input type="text" name="attr_athletics_flat" placeholder="0" title="@{athletics_flat}">
                                                    <select name="attr_athletics_type" title="@{athletics_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Deception Modifier:</label>
                                                    <input type="text" name="attr_deception_flat" placeholder="0" title="@{deception_flat}">
                                                    <select name="attr_deception_type" title="@{deception_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>History Modifier:</label>
                                                    <input type="text" name="attr_history_flat" placeholder="0" title="@{history_flat}">
                                                    <select name="attr_history_type" title="@{history_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Insight Modifier:</label>
                                                    <input type="text" name="attr_insight_flat" placeholder="0" title="@{insight_flat}">
                                                    <select name="attr_insight_type" title="@{insight_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Intimidation Modifier:</label>
                                                    <input type="text" name="attr_intimidation_flat" placeholder="0" title="@{intimidation_flat}">
                                                    <select name="attr_intimidation_type" title="@{intimidation_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Investigation Modifier:</label>
                                                    <input type="text" name="attr_investigation_flat" placeholder="0" title="@{investigation_flat}">
                                                    <select name="attr_investigation_type" title="@{investigation_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Medicine Modifier:</label>
                                                    <input type="text" name="attr_medicine_flat" placeholder="0" title="@{medicine_flat}">
                                                    <select name="attr_medicine_type" title="@{medicine_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Nature Modifier:</label>
                                                    <input type="text" name="attr_nature_flat" placeholder="0" title="@{nature_flat}">
                                                    <select name="attr_nature_type" title="@{nature_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Perception Modifier:</label>
                                                    <input type="text" name="attr_perception_flat" placeholder="0" title="@{perception_flat}">
                                                    <select name="attr_perception_type" title="@{perception_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Performance Modifier:</label>
                                                    <input type="text" name="attr_performance_flat" placeholder="0" title="@{performance_flat}">
                                                    <select name="attr_performance_type" title="@{performance_typ}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Persuasion Modifier:</label>
                                                    <input type="text" name="attr_persuasion_flat" placeholder="0" title="@{persuasion_flat}">
                                                    <select name="attr_persuasion_type" title="@{persuasion_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Religion Modifier:</label>
                                                    <input type="text" name="attr_religion_flat" placeholder="0" title="@{religion_flat}">
                                                    <select name="attr_religion_type" title="@{religion_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Sleight of Hand Modifier:</label>
                                                    <input type="text" name="attr_sleight_of_hand_flat" placeholder="0" title="@{sleight_of_hand_flat}">
                                                    <select name="attr_sleight_of_hand_type" title="@{sleight_of_hand_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Stealth Modifier:</label>
                                                    <input type="text" name="attr_stealth_flat" placeholder="0" title="@{stealth_flat}">
                                                    <select name="attr_stealth_type" title="@{stealth_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Survival Modifier:</label>
                                                    <input type="text" name="attr_survival_flat" placeholder="0" title="@{survival_flat}">
                                                    <select name="attr_survival_type" title="@{survival_type}">
                                                        <option value="1" selected="selected">Normal</option>
                                                        <option value="2">Expertise</option>
                                                    </select>
                                                </div>
                                                <div class="sheet-form-group">
                                                    <label>Passive Perception Modifier:</label>
                                                    <input type="text" name="attr_passiveperceptionmod" placeholder="0" title="@{passiveperceptionmod}">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
						</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet-section-pc-footer">
            <p> Journey To The Heavens Character Sheet</p>
        </div>
    </div>
    <div class="sheet-section-fields">
		<input type="hidden" name="attr_d20" value="1d20">

		<input type="hidden" name="attr_level" value="1">
		<input type="hidden" name="attr_pb" value="2">

		<input type="hidden" name="attr_major" value="">
		<input type="hidden" name="attr_minor" value="">

		<input type="hidden" name="attr_ancestry" value="">
		<input type="hidden" name="attr_race" value="">

		<input type="hidden" name="attr_hp_coefficient" value="1">
		<input type="hidden" name="attr_hit_scale" value="1">
		<input type="hidden" name="attr_hit_dice" value="10">

		<input type="hidden" name="attr_passive_wisdom" value="10">
		<input type="hidden" name="attr_death_save_bonus" value="0">
		<input type="hidden" name="attr_initiative_bonus" value="0">

		<input type="hidden" name="attr_ac" value="10">
		<input type="hidden" name="attr_eac" value="10">
		<input type="hidden" name="attr_dac" value="10">
		<input type="hidden" name="attr_cultivator_base" value="10">

		<input type="hidden" name="attr_stress" value="0">
		<input type="hidden" name="attr_pill_poison" value="0">
		<input type="hidden" name="attr_pathway" value="0">

		<input type="hidden" name="attr_strength_mod" value="0">
		<input type="hidden" name="attr_dexterity_mod" value="0">
		<input type="hidden" name="attr_constitution_mod" value="0">
		<input type="hidden" name="attr_intelligence_mod" value="0">
		<input type="hidden" name="attr_wisdom_mod" value="0">
		<input type="hidden" name="attr_charisma_mod" value="0">
		<input type="hidden" name="attr_sanity_mod" value="0">
		<input type="hidden" name="attr_honor_mod" value="0">

		<input type="hidden" name="attr_strength_save_bonus" value="0">
		<input type="hidden" name="attr_dexterity_save_bonus" value="0">
		<input type="hidden" name="attr_constitution_save_bonus" value="0">
		<input type="hidden" name="attr_intelligence_save_bonus" value="0">
		<input type="hidden" name="attr_wisdom_save_bonus" value="0">
		<input type="hidden" name="attr_charisma_save_bonus" value="0">
		<input type="hidden" name="attr_sanity_save_bonus" value="0">
		<input type="hidden" name="attr_honor_save_bonus" value="0">

		<input type='hidden' name='attr_acrobatics_bonus' value='0'>
		<input type='hidden' name='attr_animal_handling_bonus' value='0'>
		<input type='hidden' name='attr_athletics_bonus' value='0'>
		<input type='hidden' name='attr_deception_bonus' value='0'>
		<input type='hidden' name='attr_history_bonus' value='0'>
		<input type='hidden' name='attr_insight_bonus' value='0'>
		<input type='hidden' name='attr_intimidation_bonus' value='0'>
		<input type='hidden' name='attr_investigation_bonus' value='0'>
		<input type='hidden' name='attr_medicine_bonus' value='0'>
		<input type='hidden' name='attr_nature_bonus' value='0'>
		<input type='hidden' name='attr_perception_bonus' value='0'>
		<input type='hidden' name='attr_performance_bonus' value='0'>
		<input type='hidden' name='attr_persuasion_bonus' value='0'>
		<input type='hidden' name='attr_religion_bonus' value='0'>
		<input type='hidden' name='attr_sleight_of_hand_bonus' value='0'>
		<input type='hidden' name='attr_stealth_bonus' value='0'>
		<input type='hidden' name='attr_survival_bonus' value='0'>

        <input type='hidden' name='attr_spirit_bonus' value='0'>
        <input type='hidden' name='attr_absorb_cult_bonus' value='0'>
        <input type='hidden' name='attr_comprehension_bonus' value='0'>
        <input type='hidden' name='attr_qi_control_bonus' value='0'>
        
		<input type='hidden' name='attr_use_inventory_slots' value='1'>
		<input type='hidden' name='attr_simpleinventory' value="complex">

        <input type="hidden" name="attr_global_damage_mod_crit" value="0">
		<input type="hidden" name="attr_global_damage_mod_roll" value="0">
        <input type="hidden" name="attr_global_damage_mod_type" value="">
    </div>
    <div class="sheet-section-templates">
        <div class="sheet-roll-templates">
            <rolltemplate class="sheet-rolltemplate-atk">
                <div class="container">
                    <div class="result">
                        {{#always}}
                            <div class="adv">
                                <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                            </div>
                            <div class="advspacer"></div>
                            <div class="adv">
                                <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                            </div>
                        {{/always}}
                        {{#normal}}
                            <div class="solo">
                                <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                            </div>
                        {{/normal}}
                        {{#advantage}}
                            {{#rollLess() r1 r2}}
                                <div class="adv">
                                    <span class="grey">{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/rollLess() r1 r2}}
                            {{#rollTotal() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/rollTotal() r1 r2}}
                            {{#rollGreater() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span class="grey">{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/rollGreater() r1 r2}}
                        {{/advantage}}
                        {{#disadvantage}}
                            {{#rollLess() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span class="grey">{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/rollLess() r1 r2}}
                            {{#rollTotal() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/rollTotal() r1 r2}}
                            {{#rollGreater() r1 r2}}
                                <div class="adv">
                                    <span class="grey">{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/rollGreater() r1 r2}}
                        {{/disadvantage}}
                    </div>
                    {{#range}}
                        <div class="sublabel">
                            <span>{{range}}</span>
                        </div>
                    {{/range}}
                    <div class="label">
                        {{#normal}}
                            {{#rollWasCrit() r1}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r1}}
                            {{#^rollWasCrit() r1}}<span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/^rollWasCrit() r1}}
                        {{/normal}}
                        {{#always}}
                            {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                            {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                            {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                            {{#^rollWasCrit() r1}}{{#^rollWasCrit() r2}}<span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/^rollWasCrit() r2}}{{/^rollWasCrit() r1}}
                        {{/always}}
                        {{#advantage}}
                            {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                            {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                            {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                            {{#^rollWasCrit() r1}}{{#^rollWasCrit() r2}}<span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/^rollWasCrit() r2}}{{/^rollWasCrit() r1}}
                        {{/advantage}}
                        {{#disadvantage}}
                            {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span>{{rnamec}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                            {{#rollTotal() r1 r2}}{{#^rollWasCrit() r1}}<span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/^rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                            {{#rollLess() r1 r2}}<span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollLess() r1 r2}}
                            {{#rollGreater() r1 r2}}<span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}} <span>({{mod}})</span></span>{{/rollGreater() r1 r2}}
                        {{/disadvantage}}
                    </div>
                    {{#charname}}
                        <div class="charname">
                            <span>{{charname}}</span>
                        </div>
                    {{/charname}}
                </div>
                {{#desc}}
                    <div class="desc info">
                        <span>
                            <span class="top"></span><span class="middle">{{desc}}</span><span class="bottom"></span>
                        </span>
                    </div>
                {{/desc}}
            </rolltemplate>

            <rolltemplate class="sheet-rolltemplate-atkdmg">
                {{#attack}}
                    <div class="container atk">
                        <div class="result">
                            {{#always}}
                                <div class="adv">
                                    <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/always}}
                            {{#normal}}
                                <div class="solo">
                                    <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                </div>
                            {{/normal}}
                            {{#advantage}}
                                {{#rollLess() r1 r2}}
                                    <div class="adv">
                                        <span class="grey">{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                {{/rollLess() r1 r2}}
                                {{#rollTotal() r1 r2}}
                                    <div class="adv">
                                        <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                {{/rollTotal() r1 r2}}
                                {{#rollGreater() r1 r2}}
                                    <div class="adv">
                                        <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span class="grey">{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                {{/rollGreater() r1 r2}}
                            {{/advantage}}
                            {{#disadvantage}}
                                {{#rollLess() r1 r2}}
                                    <div class="adv">
                                        <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span class="grey">{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                {{/rollLess() r1 r2}}
                                {{#rollTotal() r1 r2}}
                                    <div class="adv">
                                        <span>{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                {{/rollTotal() r1 r2}}
                                {{#rollGreater() r1 r2}}
                                    <div class="adv">
                                        <span class="grey">{{r1}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span>{{r2}}{{#globalattack}} + {{globalattack}}{{/globalattack}}</span>
                                    </div>
                                {{/rollGreater() r1 r2}}
                            {{/disadvantage}}
                        </div>
                        {{#range}}
                            <div class="sublabel">
                                <span>{{range}}</span>
                            </div>
                        {{/range}}
                        <div class="label">
                            <span>{{rname}}{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}}{{#attack}} <span>({{mod}})</span>{{/attack}}</span>
                        </div>
                        {{#charname}}
                            <div class="charname">
                                <span>{{charname}}</span>
                            </div>
                        {{/charname}}
                    </div>
                {{/attack}}
                {{#save}}
                    <div class="container {{#attack}}desc{{/attack}}{{^attack}}atk{{/attack}} save">
                        <div class="savedc">
                            <span class="rolltemplate-inline">DC</span>
                            <span class="rolltemplate-inline">{{savedc}}</span>
                        </div>
                        {{#savedesc}}
                            <div class="sublabel">
                                <span>{{savedesc}}</span>
                            </div>
                        {{/savedesc}}
                        <div class="label">
                            <span class="rolltemplate-inline">{{saveattr}}</span> <span class="rolltemplate-inline">Save</span>
                        </div>
                    </div>
                {{/save}}
                {{#desc}}
                    <div class="desc info">
                        <span>
                            <span class="top"></span><span class="middle">{{desc}}</span><span class="bottom"></span>
                        </span>
                    </div>
                {{/desc}}
                {{#globaldamage}}
                    {{#^rollTotal() globaldamage 0}}
                        <div class="desc">
                            <span>
                                {{globaldamage}}
                                {{#attack}}
                                    {{#normal}}
                                        {{#rollWasCrit() r1}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r1}}
                                    {{/normal}}
                                    {{#always}}
                                        {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                        {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                        {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                    {{/always}}
                                    {{#advantage}}
                                        {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                        {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                        {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                    {{/advantage}}
                                    {{#disadvantage}}
                                        {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{globaldamagecrit}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                    {{/disadvantage}}
                                {{/attack}}
                            </span>
                            <span class="sublabel">{{globaldamagetype}}</span>
                        </div>
                    {{/^rollTotal() globaldamage 0}}
                {{/globaldamage}}
                {{#hldmg}}
                    {{#^rollTotal() hldmg 0}}
                        <div class="desc">
                            <span>
                                {{hldmg}}
                                
                                {{#attack}}
                                    {{#normal}}
                                        {{#rollWasCrit() r1}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r1}}
                                    {{/normal}}
                                    {{#always}}
                                        {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                        {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                        {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                    {{/always}}
                                    {{#advantage}}
                                        {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                        {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                        {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                    {{/advantage}}
                                    {{#disadvantage}}
                                        {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}<span class="plus"> + </span>{{hldmgcrit}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                    {{/disadvantage}}
                                {{/attack}}
                            </span>
                            <span class="sublabel">{{dmg1type}}</span>
                            <div class="label">
                                <span>Higher Level Cast</span>
                            </div>
                        </div>
                    {{/^rollTotal() hldmg 0}}
                {{/hldmg}}
                {{#damage}}
                    <div class="container damagetemplate">
                        <div class="result">
                            {{#dmg1flag}}
                                {{^dmg2flag}}
                                    <div class="solo">
                                        <span class="damage">
                                            {{dmg1}}
                                            {{#attack}}
                                                {{#normal}}
                                                    {{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}
                                                {{/normal}}
                                                {{#always}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit1}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/always}}
                                                {{#advantage}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit1}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/advantage}}
                                                {{#disadvantage}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                {{/disadvantage}}
                                            {{/attack}}
                                        </span>
                                        <span class="sublabel">{{dmg1type}}</span>
                                    </div>
                                {{/dmg2flag}}
                            {{/dmg1flag}}
                            {{#dmg2flag}}
                                {{^dmg1flag}}
                                    <div class="solo">
                                        <span class="damage">
                                            {{dmg2}}
                                            {{#attack}}
                                                {{#normal}}
                                                    {{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}
                                                {{/normal}}
                                                {{#always}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit2}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/always}}
                                                {{#advantage}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit2}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/advantage}}
                                                {{#disadvantage}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                {{/disadvantage}}
                                            {{/attack}}
                                        </span>
                                        <span class="sublabel">{{dmg2type}}</span>
                                    </div>
                                {{/dmg1flag}}
                            {{/dmg2flag}}
                            {{#dmg1flag}}
                                {{#dmg2flag}}
                                    <div class="adv">
                                        <span class="damage">
                                            {{dmg1}}
                                            {{#attack}}
                                                {{#normal}}
                                                    {{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}
                                                {{/normal}}
                                                {{#always}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit1}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/always}}
                                                {{#advantage}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit1}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/advantage}}
                                                {{#disadvantage}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit1}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                {{/disadvantage}}
                                            {{/attack}}
                                        </span>
                                        <span class="sublabel">{{dmg1type}}</span>
                                    </div>
                                    <div class="advspacer"></div>
                                    <div class="adv">
                                        <span>
                                            {{dmg2}}
                                            {{#attack}}
                                                {{#normal}}
                                                    {{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}
                                                {{/normal}}
                                                {{#always}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit2}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/always}}
                                                {{#advantage}}
                                                    {{#rollLess() r1 r2}}{{#rollWasCrit() r2}}+ {{crit2}}{{/rollWasCrit() r2}}{{/rollLess() r1 r2}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                    {{#rollGreater() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollGreater() r1 r2}}
                                                {{/advantage}}
                                                {{#disadvantage}}
                                                    {{#rollTotal() r1 r2}}{{#rollWasCrit() r1}}+ {{crit2}}{{/rollWasCrit() r1}}{{/rollTotal() r1 r2}}
                                                {{/disadvantage}}
                                            {{/attack}}
                                        </span>
                                        <span class="sublabel">{{dmg2type}}</span>
                                    </div>
                                {{/dmg2flag}}
                            {{/dmg1flag}}
                        </div>
                        {{^attack}}
                            {{#range}}
                                <div class="sublabel">
                                    <span>{{range}}</span>
                                </div>
                            {{/range}}
                            <div class="label">
                                <span>{{rname}}</span>{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}}
                            </div>
                            {{#charname}}
                                <div class="charname">
                                    <span>{{charname}}</span>
                                </div>
                            {{/charname}}
                        {{/attack}}
                    </div>
                {{/damage}}
            </rolltemplate>

            <rolltemplate class="sheet-rolltemplate-dmg">
                {{#save}}
                    <div class="{{#attack}}desc{{/attack}}{{^attack}}atk{{/attack}} save">
                        <div class="savedc">
                            <span class="rolltemplate-inline">DC</span>
                            <span class="rolltemplate-inline">{{savedc}}</span>
                        </div>
                        {{#savedesc}}
                            <div class="sublabel">
                                <span>{{savedesc}}</span>
                            </div>
                        {{/savedesc}}
                        <div class="label">
                            <span class="rolltemplate-inline">{{saveattr}}</span> <span class="rolltemplate-inline">Save</span>
                        </div>
                    </div>
                {{/save}}
                {{^attack}}
                    {{#desc}}
                        <div class="desc info">
                            <span>
                                <span class="top"></span><span class="middle">{{desc}}</span><span class="bottom"></span>
                            </span>
                        </div>
                    {{/desc}}
                {{/attack}}
                {{#globaldamage}}
                    {{#^rollTotal() globaldamage 0}}
                        <div class="desc">
                            <span>{{globaldamage}}{{#globaldamagecrit}}<span class="plus"> + </span>{{globaldamagecrit}}{{/globaldamagecrit}}</span>
                            <span class="sublabel">{{globaldamagetype}}</span>
                        </div>
                    {{/^rollTotal() globaldamage 0}}
                {{/globaldamage}}
                {{#hldmg}}
                    {{#^rollTotal() hldmg 0}}
                        <div class="desc">
                            <span>{{hldmg}}{{#hldmgcrit}}<span class="plus"> + </span>{{hldmgcrit}}{{/hldmgcrit}}</span>
                            <span class="sublabel">{{dmg1type}}</span>
                            <div class="label">
                                <span>Higher Level Cast</span>
                            </div>
                        </div>
                    {{/^rollTotal() hldmg 0}}
                {{/hldmg}}
            
                <div class="container damagetemplate">
                    <div class="result">
                        {{#dmg1flag}}
                            {{^dmg2flag}}
                                <div class="solo">
                                    <span class="damage">{{dmg1}}{{#crit}} + {{crit1}}{{/crit}}</span>
                                    <span class="sublabel">{{dmg1type}}</span>
                                </div>
                            {{/dmg2flag}}
                        {{/dmg1flag}}
                        {{#dmg2flag}}
                            {{^dmg1flag}}
                                <div class="solo">
                                    <span class="damage">{{dmg2}}{{#crit}} + {{crit2}}{{/crit}}</span>
                                    <span class="sublabel">{{dmg2type}}</span>
                                </div>
                            {{/dmg1flag}}
                        {{/dmg2flag}}
                        {{#dmg1flag}}
                            {{#dmg2flag}}
                                <div class="adv">
                                    <span class="damage">{{dmg1}}{{#crit}} + {{crit1}}{{/crit}}</span>
                                    <span class="sublabel">{{dmg1type}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span class="damage">{{dmg2}}{{#crit}} + {{crit2}}{{/crit}}</span>
                                    <span class="sublabel">{{dmg2type}}</span>
                                </div>
                            {{/dmg2flag}}
                        {{/dmg1flag}}
                    </div>
                    {{^attack}}
                        {{#range}}
                            <div class="sublabel" style="color: black;">
                                <span>{{range}}</span>
                            </div>
                        {{/range}}
                        <div class="label">
                            <span>{{rname}}</span>{{#innate}}<span class="grey">, {{innate}}</span>{{/innate}}
                        </div>
                        {{#charname}}
                            <div class="charname">
                                <span>{{charname}}</span>
                            </div>
                        {{/charname}}
                    {{/attack}}
                </div>
            </rolltemplate>

            <rolltemplate class="sheet-rolltemplate-simple">
                <div class="container">
                    <div class="result">
                        {{#always}}
                            <div class="adv">
                                <span>{{r1}}{{#global}} + {{global}}{{/global}}</span>
                            </div>
                            <div class="advspacer"></div>
                            <div class="adv">
                                <span>{{r2}}{{#global}} + {{global}}{{/global}}</span>
                            </div>
                        {{/always}}
                        {{#normal}}
                            <div class="solo">
                                <span>{{r1}}{{#global}} + {{global}}{{/global}}</span>
                            </div>
                        {{/normal}}
                        {{#advantage}}
                            {{#rollLess() r1 r2}}
                                <div class="adv">
                                    <span class="grey">{{r1}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                            {{/rollLess() r1 r2}}
                            {{#rollTotal() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                            {{/rollTotal() r1 r2}}
                            {{#rollGreater() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span class="grey">{{r2}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                            {{/rollGreater() r1 r2}}
                        {{/advantage}}
                        {{#disadvantage}}
                            {{#rollLess() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span class="grey">{{r2}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                            {{/rollLess() r1 r2}}
                            {{#rollTotal() r1 r2}}
                                <div class="adv">
                                    <span>{{r1}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                            {{/rollTotal() r1 r2}}
                            {{#rollGreater() r1 r2}}
                                <div class="adv">
                                    <span class="grey">{{r1}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                                <div class="advspacer"></div>
                                <div class="adv">
                                    <span>{{r2}}{{#global}} + {{global}}{{/global}}</span>
                                </div>
                            {{/rollGreater() r1 r2}}
                        {{/disadvantage}}
                    </div>
                    <div class="label">
                        <span>{{rname}}{{#mod}} <span>({{mod}})</span>{{/mod}}</span>
                    </div>
                    {{#charname}}
                        <div class="charname">
                            <span>{{charname}}</span>
                        </div>
                    {{/charname}}
                </div>
            </rolltemplate>

            <rolltemplate class="sheet-rolltemplate-desc">
                <div class="desc info">
                    <span>
                        <span class="top"></span><span class="middle">{{desc}}</span><span class="bottom"></span>
                    </span>
                </div>
            </rolltemplate>

            <rolltemplate class="sheet-rolltemplate-traits">
                <div class="row header">
                    <span>{{name}}</span>
                </div>
                {{#source}}
                <div class="row subheader">
                    <span class="italics">{{#charname}}{{charname}} {{/charname}}{{source}}</span>
                </div>
                {{/source}}
                {{#description}}
                    <div class="row">
                        <span class="desc">{{description}}</span>
                    </div>
                {{/description}}
            </rolltemplate>
        </div>
    </div>

    <script type="text/worker">
        // <!-- MAIN ATTRIBUTE CHANGE -->
        
        ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma', 'sanity', 'honor'].forEach(attr => {
            on(`change:${attr}_base change:${attr}_bonus`, function(){
                update_attr(`${attr}`);
            });
        });
        
        ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma', 'sanity', 'honor'].forEach(attr => {
            on(`change:${attr}`, function() {
                update_mod(`${attr}`);
        
                const cap = attr.charAt(0).toUpperCase() + attr.slice(1);
                check_customac(cap);
        
                (attr === "strength") ? update_weight(): false;
                (attr === "dexterity") ? update_initiative(): false;
            });
        });
        
        ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma', 'sanity', 'honor'].forEach(attr => {
            on(`change:${attr}_mod`, function() {
                update_save(`${attr}`);
                update_attacks(`${attr}`);
                update_tool(`${attr}`);
        
                switch (`${attr}`) {
                    case "strength":
                        update_skills(["athletics"]);
                        break;
                    case "dexterity":
                        update_skills(["acrobatics", "sleight_of_hand", "stealth"]);
                        update_ac();
                        update_initiative();
                        break;
                    case "intelligence":
                        update_skills(["absorb_cult", "history", "investigation", "nature", "religion", "spirit"]);
                        update_initiative();
                        break;
                    case "wisdom":
                        update_skills(["animal_handling", "comprehension", "insight", "medicine", "perception", "qi_control", "survival"]);
                        break;
                    case "charisma":
                        update_skills(["deception", "intimidation", "performance", "persuasion"]);
                        break;
                    default:
                        false;
                }
            });
        });
        
        ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma'].forEach(attr => {
            on(`change:${attr}_save_prof change:${attr}_save_mod`, function(eventinfo) {
                if (eventinfo.sourceType === "sheetworker") {
                    return;
                };
                update_save(`${attr}`);
            });
        });
        
        ['acrobatics', 'animal_handling', 'absorb_cult', 'spirit', 'comprehension', 'qi_control', 'athletics', 'deception', 'history', 'insight', 'intimidation', 'investigation', 'medicine', 'nature', 'perception', 'performance', 'persuasion', 'religion', 'sleight_of_hand', 'stealth', 'survival'].forEach(attr => {
            on(`change:${attr}_prof change:${attr}_type change:${attr}_flat change:${attr}_attribute`, function(eventinfo) {
                if (eventinfo.sourceType === "sheetworker") {
                    return;
                };
                update_skills([`${attr}`]);
            });
        });
        
        [`ac`, `attack`, 'save', 'skill', ].forEach(attr => {
            on(`change:global_${attr}_mod_flag`, (eventinfo) => {
                const mod = (attr === "attack") ? "tohitmod" : `${attr}mod`;
                if (eventinfo.newValue === "1") {
                    const firstAttr = (attr === "ac") ? "val" : "roll";
                    const firstAttrValue = (attr === "ac") ? 1 : "1d4";
                    const secondAttrValue = (attr === "ac") ? "Defense" : (attr === "skill") ? "GUIDANCE" : "BLESS";
        
                    getSectionIDs(mod, (ids) => {
                        if (!ids || ids.length === 0) {
                            var update = {};
                            var rowid = generateRowID();
                            update[`repeating_${mod}_${rowid}_global_${attr}_${firstAttr}`] = `${firstAttrValue}`;
                            update[`repeating_${mod}_${rowid}_global_${attr}_name`] = `${secondAttrValue}`;
                            update[`repeating_${mod}_${rowid}_global_${attr}_active_flag`] = "1";
                            setAttrs(update);
                        }
                    });
                } else {
                    getSectionIDs(mod, function(ids) {
                        var update = {};
                        var rowid = generateRowID();
                        _.each(ids, function(rowid) {
                            update[`repeating_${mod}_${rowid}_global_${attr}_active_flag`] = "0";
                        });
                        setAttrs(update);
                    });
                }
            });
        });
        
        on("change:death_save_mod", function(eventinfo) {
            if (eventinfo.sourceType === "sheetworker") {
                return;
            };
            update_save("death");
        });
        
        on("change:repeating_tool:toolname change:repeating_tool:toolbonus_base change:repeating_tool:toolattr_base change:repeating_tool:tool_mod", function(eventinfo) {
            if (eventinfo.sourceType === "sheetworker") {
                return;
            }
            var tool_id = eventinfo.sourceAttribute.substring(15, 35);
            update_tool(tool_id);
        });
        
        on("change:repeating_attack:atkname change:repeating_attack:atkflag change:repeating_attack:atkattr_base change:repeating_attack:atkmod change:repeating_attack:atkmagic change:repeating_attack:atkprofflag change:repeating_attack:dmgflag change:repeating_attack:dmgbase change:repeating_attack:dmgattr change:repeating_attack:dmgmod change:repeating_attack:dmgtype change:repeating_attack:dmg2flag change:repeating_attack:dmg2base change:repeating_attack:dmg2attr change:repeating_attack:dmg2mod change:repeating_attack:dmg2type change:repeating_attack:saveflag change:repeating_attack:savedc change:repeating_attack:saveflat change:repeating_attack:dmgcustcrit change:repeating_attack:dmg2custcrit change:repeating_attack:ammo change:repeating_attack:saveattr change:repeating_attack:atkrange", function(eventinfo) {
            if (eventinfo.sourceType === "sheetworker") {
                return;
            }
        
            var source = eventinfo.sourceAttribute.substr(38);
            var attackid = eventinfo.sourceAttribute.substring(17, 37);
            if (source == "atkattr_base" || source == "savedc") {
                getAttrs(["repeating_attack_spellid", "repeating_attack_spelllevel"], function(v) {
                    set = {};
                    if (v.repeating_attack_spellid && v.repeating_attack_spellid != "" && v.repeating_attack_spelllevel && v.repeating_attack_spelllevel != "") {
                        var newVal = _.last(eventinfo.newValue.split("_")[0].split("{"));
                        console.log(newVal);
                        console.log("@{" + newVal + "_mod}");
                        console.log("(@{" + newVal + "_mod}+8+@{pb})");
                        set["repeating_attack_atkattr_base"] = "@{" + newVal + "_mod}";
                        set["repeating_attack_savedc"] = "(@{" + newVal + "_mod}+8+@{pb})";
                    }
                    setAttrs(set, function() {
                        update_attacks(attackid);
                    });
                });
            } else {
                update_attacks(attackid);
            }
        });
        
        on("change:repeating_damagemod remove:repeating_damagemod", function(eventinfo) {
            update_globaldamage();
        });
        
        on("change:ancestry change:race", function(eventinfo) {
            update_race_display();
        });
        
        on("change:repeating_inventory:itemcontainer change:repeating_inventory:equipped change:repeating_inventory:carried change:repeating_inventory:itemweight change:repeating_inventory:itemcount change:cp change:sp change:ep change:gp change:pp change:currency_other change:encumberance_setting change:size change:carrying_capacity_mod change:use_inventory_slots change:inventory_slots_mod change:repeating_inventory:itemweightfixed change:repeating_inventory:itemslotsfixed change:repeating_inventory:itemsize change:repeating_inventory:itemcontainer_slots_modifier", function() {
            update_weight();
        });
        
        on("change:repeating_inventory:itemmodifiers change:repeating_inventory:equipped change:repeating_inventory:carried", function(eventinfo) {
            if (eventinfo.sourceType && eventinfo.sourceType === "sheetworker") {
                return;
            }
            var itemid = eventinfo.sourceAttribute.substring(20, 40);
            getAttrs(["repeating_inventory_" + itemid + "_itemmodifiers"], function(v) {
                if (v["repeating_inventory_" + itemid + "_itemmodifiers"]) {
                    check_itemmodifiers(v["repeating_inventory_" + itemid + "_itemmodifiers"], eventinfo.previousValue);
                };
            });
        });
        
        on("change:custom_ac_flag change:custom_ac_base change:custom_ac_part1 change:custom_ac_part2 change:custom_ac_shield", function(eventinfo) {
            if (eventinfo.sourceType && eventinfo.sourceType === "sheetworker") {
                return;
            }
            update_ac();
        });
        
        on("change:class change:subclass change:major_realm change:minor_realm", function(eventinfo) {
            if (eventinfo.sourceType && eventinfo.sourceType === "sheetworker") {
                return;
            }
            update_ac();
            set_level();
        });
        
        on("change:dtype", function(eventinfo) {
            if (eventinfo.sourceType && eventinfo.sourceType === "sheetworker") {
                return;
            }
            update_attacks("all");
        });
        
        on("change:initmod", function(eventinfo) {
            if (eventinfo.sourceType && eventinfo.sourceType === "sheetworker") {
                return;
            }
            update_initiative();
        });
        
        on("change:repeating_acmod remove:repeating_acmod", function(eventinfo) {
            update_ac();
        });
        
        on("change:passiveperceptionmod", function(eventinfo) {
            update_passive_perception();
        });
        
        on("remove:repeating_inventory", function(eventinfo) {
            var itemid = eventinfo.sourceAttribute.substring(20, 40);
            var attackids = eventinfo.removedInfo && eventinfo.removedInfo["repeating_inventory_" + itemid + "_itemattackid"] ? eventinfo.removedInfo["repeating_inventory_" + itemid + "_itemattackid"] : undefined;
            var resourceid = eventinfo.removedInfo && eventinfo.removedInfo["repeating_inventory_" + itemid + "_itemresourceid"] ? eventinfo.removedInfo["repeating_inventory_" + itemid + "_itemresourceid"] : undefined;
        
            if (attackids) {
                _.each(attackids.split(","), function(value) {
                    remove_attack(value);
                });
            }
            if (resourceid) {
                remove_resource(resourceid);
            }
        
            if (eventinfo.removedInfo && eventinfo.removedInfo["repeating_inventory_" + itemid + "_itemmodifiers"]) {
                check_itemmodifiers(eventinfo.removedInfo["repeating_inventory_" + itemid + "_itemmodifiers"]);
            }
        
            update_ac();
            update_weight();
        });

        on("remove:repeating_attack", function(eventinfo) {
            var attackid = eventinfo.sourceAttribute.substring(17, 37);
            var itemid = eventinfo.removedInfo["repeating_attack_" + attackid + "_itemid"];
            if (itemid) {
                getAttrs(["repeating_inventory_" + itemid + "_hasattack"], function(v) {
                    if (v["repeating_inventory_" + itemid + "_hasattack"] && v["repeating_inventory_" + itemid + "_hasattack"] == 1) {
                        var update = {};
                        update["repeating_inventory_" + itemid + "_itemattackid"] = "";
                        update["repeating_inventory_" + itemid + "_hasattack"] = 0;
                        setAttrs(update, {
                            silent: true
                        });
                    }
                });
            };
        });
        
        on("change:stress", function(eventinfo) {
            let stress = toInt(eventinfo.newValue);
            let update = {};
            if (stress >= 4) {
                update["stress_state_4"] = 1;
            }
            if (stress >= 6) {
                update["stress_state_6"] = 1;
            }
            if (stress >= 8) {
                update["stress_state_8"] = 1;
            }
            if (stress >= 10) {
                update["stress_state_10"] = 1;
            }
            setAttrs(update);
        });

        on("change:pill_poison", function(eventinfo) {
            let poison = toInt(eventinfo.newValue);
            let update = {};
            if (poison < 100) {
                update["pill_poison_state_100"] = 0;
                update["pill_poison_state_200"] = 0;
                update["pill_poison_state_300"] = 0;
                update["pill_poison_state_400"] = 0;
            }
            if ((poison < 200) && (poison >= 100)) {
                update["pill_poison_state_100"] = 1;
                update["pill_poison_state_200"] = 0;
                update["pill_poison_state_300"] = 0;
                update["pill_poison_state_400"] = 0;
            }
            if ((poison < 300) && (poison >= 200)) {
                update["pill_poison_state_100"] = 1;
                update["pill_poison_state_200"] = 1;
                update["pill_poison_state_300"] = 0;
                update["pill_poison_state_400"] = 0;
            }
            if ((poison < 400) && (poison >= 300)) {
                update["pill_poison_state_100"] = 1;
                update["pill_poison_state_200"] = 1;
                update["pill_poison_state_300"] = 1;
                update["pill_poison_state_400"] = 0;
            }
            if (poison >= 400) {
                update["pill_poison_state_100"] = 1;
                update["pill_poison_state_200"] = 1;
                update["pill_poison_state_300"] = 1;
                update["pill_poison_state_400"] = 1;
            }
            setAttrs(update);
        });

        on("change:pathway", function(eventinfo) {
            let pathway = toInt(eventinfo.newValue);
            let update = {};
            if (pathway < 4) {
                update["pathway_state_4"] = 0;
                update["pathway_state_6"] = 0;
                update["pathway_state_8"] = 0;
                update["pathway_state_10"] = 0;
            }
            if ((pathway < 6) && (pathway >= 4)) {
                update["pathway_state_4"] = 1;
                update["pathway_state_6"] = 0;
                update["pathway_state_8"] = 0;
                update["pathway_state_10"] = 0;
            }
            if ((pathway < 8) && (pathway >= 6)) {
                update["pathway_state_4"] = 1;
                update["pathway_state_6"] = 1;
                update["pathway_state_8"] = 0;
                update["pathway_state_10"] = 0;
            }
            if ((pathway < 10) && (pathway >= 8)) {
                update["pathway_state_4"] = 1;
                update["pathway_state_6"] = 1;
                update["pathway_state_8"] = 1;
                update["pathway_state_10"] = 0;
            }
            if (pathway >= 10) {
                update["pathway_state_4"] = 1;
                update["pathway_state_6"] = 1;
                update["pathway_state_8"] = 1;
                update["pathway_state_10"] = 1;
            }
            setAttrs(update);
        });
        
        // <!-- UPDATE FUNCTIONS -->

        var update_ac = function() {
            getAttrs(["custom_ac_flag", "level"], function(v) {
                if (v.custom_ac_flag === "2") {
                    return;
                } else {
                    var update = {};
                    var cultivator_base = 10;
                    var aclvl = parseInt(v["level"], 10);
                    cultivator_base = (Math.ceil(aclvl / 4) * 10);
                    var ac_attrs = ["simpleinventory", "custom_ac_base", "custom_ac_part1", "custom_ac_part2", "strength_mod", "dexterity_mod", "constitution_mod", "intelligence_mod", "wisdom_mod", "charisma_mod", "custom_ac_shield", "level", "eac", "dac"];
                    getSectionIDs("repeating_acmod", function(acidarray) {
                        _.each(acidarray, function(currentID, i) {
                            ac_attrs.push("repeating_acmod_" + currentID + "_global_ac_val");
                            ac_attrs.push("repeating_acmod_" + currentID + "_global_ac_active_flag");
                        });
                        getSectionIDs("repeating_inventory", function(idarray) {
                            _.each(idarray, function(currentID, i) {
                                ac_attrs.push("repeating_inventory_" + currentID + "_equipped");
                                ac_attrs.push("repeating_inventory_" + currentID + "_itemmodifiers");
                            });
                            getAttrs(ac_attrs, function(b) {
                                var custom_total = 0;
                                if (v.custom_ac_flag === "1") {
                                    var base = isNaN(parseInt(b.custom_ac_base, 10)) === false ? parseInt(b.custom_ac_base, 10) : 10;
                                    var part1attr = b.custom_ac_part1.toLowerCase();
                                    var part2attr = b.custom_ac_part2.toLowerCase();
                                    var part1 = part1attr === "none" ? 0 : parseInt(b[part1attr + "_mod"], 10);
                                    var part2 = part2attr === "none" ? 0 : parseInt(b[part2attr + "_mod"], 10);
                                    custom_total = base + part1 + part2;
                                }
                                var globalacmod = 0;
                                _.each(acidarray, function(currentID, i) {
                                    if (b["repeating_acmod_" + currentID + "_global_ac_active_flag"] == "1") {
                                        globalacmod += parseInt(b["repeating_acmod_" + currentID + "_global_ac_val"], 10);
                                    }
                                });
                                var dexmod = +b["dexterity_mod"];
                                var total = 10 + dexmod;
                                var armorcount = 0;
                                var shieldcount = 0;
                                var armoritems = [];

                                if (dexmod > 50){
                                    base = 50 + Math.floor((dexmod-50)/2);
                                }

                                if (b.simpleinventory === "complex") {
                                    _.each(idarray, function(currentID, i) {
                                        if (b["repeating_inventory_" + currentID + "_equipped"] && b["repeating_inventory_" + currentID + "_equipped"] === "1" && b["repeating_inventory_" + currentID + "_itemmodifiers"] && b["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf("ac") > -1 || b["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf("eac") > -1 || b["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf("dac") > -1) {
                                            var mods = b["repeating_inventory_" + currentID + "_itemmodifiers"].split(",");
                                            var ac = 0;
                                            var dac = cultivator_base;
                                            var eac = cultivator_base;
                                            var type = "mod";
                                            _.each(mods, function(mod) {
                                                if (mod.substring(0, 10) === "Item Type:") {
                                                    type = mod.substring(11, mod.length).trim().toLowerCase();
                                                    console.log(mod.substring(11, mod.length).trim().toLowerCase());
                                                }
                                                if (mod.toLowerCase().indexOf("ac:") > -1 || mod.toLowerCase().indexOf("ac +") > -1 || mod.toLowerCase().indexOf("ac+") > -1) {
                                                    var regex = mod.replace(/[^0-9]/g, "");
                                                    var bonus = regex && regex.length > 0 && isNaN(parseInt(regex, 10)) === false ? parseInt(regex, 10) : 0;
                                                    ac = ac + bonus;
                                                }
                                                if (mod.toLowerCase().indexOf("ac -") > -1 || mod.toLowerCase().indexOf("ac-") > -1) {
                                                    var regex = mod.replace(/[^0-9]/g, "");
                                                    var bonus = regex && regex.length > 0 && isNaN(parseInt(regex, 10)) === false ? parseInt(regex, 10) : 0;
                                                    ac = ac - bonus;
                                                }
                                                if (mod.toLowerCase().indexOf("dac:") > -1 || mod.toLowerCase().indexOf("dac +") > -1 || mod.toLowerCase().indexOf("dac+") > -1) {
                                                    var regex = mod.replace(/[^0-9]/g, "");
                                                    var bonus = regex && regex.length > 0 && isNaN(parseInt(regex, 10)) === false ? parseInt(regex, 10) : 0;
                                                    dac = dac + bonus;
                                                }
                                                if (mod.toLowerCase().indexOf("dac -") > -1 || mod.toLowerCase().indexOf("dac-") > -1) {
                                                    var regex = mod.replace(/[^0-9]/g, "");
                                                    var bonus = regex && regex.length > 0 && isNaN(parseInt(regex, 10)) === false ? parseInt(regex, 10) : 0;
                                                    dac = dac - bonus;
                                                }
                                                if (mod.toLowerCase().indexOf("eac:") > -1 || mod.toLowerCase().indexOf("eac +") > -1 || mod.toLowerCase().indexOf("eac+") > -1) {
                                                    var regex = mod.replace(/[^0-9]/g, "");
                                                    var bonus = regex && regex.length > 0 && isNaN(parseInt(regex, 10)) === false ? parseInt(regex, 10) : 0;
                                                    eac = eac + bonus;
                                                }
                                                if (mod.toLowerCase().indexOf("eac -") > -1 || mod.toLowerCase().indexOf("eac-") > -1) {
                                                    var regex = mod.replace(/[^0-9]/g, "");
                                                    var bonus = regex && regex.length > 0 && isNaN(parseInt(regex, 10)) === false ? parseInt(regex, 10) : 0;
                                                    eac = eac - bonus;
                                                }
                                            });
                                            armoritems.push({
                                                type: type,
                                                ac: ac,
                                                dac: dac,
                                                eac: eac
                                            });
                                        }
                                    });
                                    armorcount = armoritems.filter(function(item) {
                                        return item["type"].indexOf("armor") > -1
                                    }).length;
                                    shieldcount = armoritems.filter(function(item) {
                                        return item["type"].indexOf("shield") > -1
                                    }).length;
                                    var base = dexmod;
                                    var armorac = 10;
                                    var shieldac = 0;
                                    var modac = 0;
        
                                    _.each(armoritems, function(item) {
                                        if (item["type"].indexOf("outer robe") > -1) {
                                            armorac = 11;
                                        } else if (item["type"].indexOf("enforcer robe") > -1) {
                                            armorac = 12;
                                        } else if (item["type"].indexOf("inner robe") > -1) {
                                            armorac = 13;
                                        } else if (item["type"].indexOf("core robe") > -1) {
                                            armorac = 15;
                                        } else if (item["type"].indexOf("shield") > -1) {
                                            shieldac = item["ac"];
                                        } else {
                                            modac = modac + item["ac"]
                                        }
                                    });

                                    if (dexmod > 50){
                                        base = 50 + Math.floor((dexmod-50)/2);
                                    } else {
                                        base = dexmod;
                                    }
        
                                    total = base + armorac + shieldac + modac;
        
                                };
                                update["armorwarningflag"] = "hide";
                                update["customacwarningflag"] = "hide";

                                console.log("UPDATING AC")
                                update["ac"] = total + globalacmod;
                                console.log("UPDATING DAC")
                                update["dac"] = cultivator_base + globalacmod;
                                console.log("UPDATING EAC")
                                update["eac"] = cultivator_base + total + globalacmod - 10;

                                if (custom_total > 0) {
                                    if (armorcount > 0 || (shieldcount > 0 && b.custom_ac_shield != "yes")) {
                                        update["customacwarningflag"] = "show";
                                    } else {
                                        update["ac"] = b.custom_ac_shield == "yes" ? custom_total + shieldac + globalacmod + modac : custom_total + globalacmod + modac;
                                    }
                                }
                                setAttrs(update, {
                                    silent: true
                                });
                            });
                        });
                    });
                };
            });
        };

        var update_all_ability_checks = function() {
            update_initiative();
            update_skills(["athletics", "acrobatics", "sleight_of_hand", "stealth", "absorb_cult", "spirit", "history", "comprehension", "qi_control", "investigation", "nature", "religion", "animal_handling", "insight", "medicine", "perception", "survival", "deception", "intimidation", "performance", "persuasion"]);
        };

        var update_all_saves = function() {
            update_save("strength");
            update_save("dexterity");
            update_save("constitution");
            update_save("intelligence");
            update_save("wisdom");
            update_save("charisma");
            update_save("death");
        };

        var update_attacks = function(update_id, source) {
            console.log("DOING UPDATE_ATTACKS: " + update_id);
            if (update_id.substring(0, 1) === "-" && update_id.length === 20) {
                do_update_attack([update_id], source);
            } else if (["strength", "dexterity", "constitution", "intelligence", "wisdom", "charisma", "all"].indexOf(update_id) > -1) {
                getSectionIDs("repeating_attack", function(idarray) {
                    if (update_id === "all") {
                        do_update_attack(idarray);
                    };
                });
            };
        };
        
        var update_attr = function(attr){
            var update = {};
            var attr_fields = [attr + "_base", attr + "_bonus"];
            getSectionIDs("repeating_inventory", function(idarray) {
                _.each(idarray, function(currentID, i) {
                    attr_fields.push("repeating_inventory_" + currentID + "_equipped");
                    attr_fields.push("repeating_inventory_" + currentID + "_itemmodifiers");
                });
                getAttrs(attr_fields, function(v) {
                    var base = v[attr + "_base"] && !isNaN(parseInt(v[attr + "_base"], 10)) ? parseInt(v[attr + "_base"], 10) : 10;
                    var bonus = v[attr + "_bonus"] && !isNaN(parseInt(v[attr + "_bonus"], 10)) ? parseInt(v[attr + "_bonus"], 10) : 0;
                    var item_base = 0;
                    var item_bonus = 0;
                    _.each(idarray, function(currentID) {
                        if ((!v["repeating_inventory_" + currentID + "_equipped"] || v["repeating_inventory_" + currentID + "_equipped"] === "1") && v["repeating_inventory_" + currentID + "_itemmodifiers"] && v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf(attr > -1)) {
                            var mods = v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().split(",");
                            _.each(mods, function(mod) {
                                if (mod.indexOf(attr) > -1 && mod.indexOf("save") === -1) {
                                    if (mod.indexOf(":") > -1) {
                                        var new_base = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                        item_base = new_base && new_base > item_base ? new_base : item_base;
                                    } else if (mod.indexOf("-") > -1) {
                                        var new_mod = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                        item_bonus = new_mod ? item_bonus - new_mod : item_bonus;
                                    } else {
                                        var new_mod = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                        item_bonus = new_mod ? item_bonus + new_mod : item_bonus;
                                    }
                                };
                            });
                        }
                    });
        
                    update[attr + "_flag"] = bonus != 0 || item_bonus > 0 || item_base > base ? 1 : 0;
                    base = base > item_base ? base : item_base;
                    update[attr] = base + bonus + item_bonus;
                    setAttrs(update);
                });
            });
        };

        var update_globaldamage = function(callback) {
            getSectionIDs("damagemod", function(ids) {
                if (ids) {
                    var fields = {};
                    var attr_name_list = [];
                    ids.forEach(function(id) {
                        fields[id] = {};
                        attr_name_list.push(`repeating_damagemod_${id}_global_damage_active_flag`, `repeating_damagemod_${id}_global_damage_name`, `repeating_damagemod_${id}_global_damage_damage`, `repeating_damagemod_${id}_global_damage_type`);
                    });
            
                    getAttrs(attr_name_list, function(attrs) {
                        var regex = /^repeating_damagemod_(.+)_global_damage_(active_flag|name|damage|type)$/;
                        _.each(attrs, function(obj, name) {
                            var r = regex.exec(name);
                            if (r) {
                                fields[r[1]][r[2]] = obj;
                            };
                        });
            
                        var update = {
                            global_damage_mod_roll: "",
                            global_damage_mod_crit: "",
                            global_damage_mod_type: ""
                        };
            
                        console.log("GLOBALDAMAGE");
                        _.each(fields, function(element) {
                            if (element.active_flag != "0") {
                                if (element.name && element.name !== "") {
                                    update["global_damage_mod_roll"] += element.damage + '[' + element.name + ']' + "+";
                                }
                                if (element.type && element.type !== "") {
                                    update["global_damage_mod_type"] += element.type + "/";
                                }
                            }
                        });
            
                        update["global_damage_mod_roll"] = update["global_damage_mod_roll"].replace(/\+(?=$)/, '');
                        update["global_damage_mod_type"] = update["global_damage_mod_type"].replace(/\/(?=$)/, '');
            
                        // Remove any non-roll damage modifiers from the global damage modifier for the crit rolls
                        // Will also remove any labels attached to these non-roll damage modifiers
                        update["global_damage_mod_crit"] = update["global_damage_mod_roll"].replace(/(?:[+\-*\/%]|\*\*|^)\s*\d+(?:\[.*?])?(?!d\d+)/gi, '')
                            // If what was just replace removed the first damage modifier, remove any now precending plus signs
                            .replace(/(?:^\+)/i, '');
            
                        setAttrs(update, {
                            silent: true
                        }, function() {
                            update_attacks("all");
                            if (typeof callback == "function") callback();
                        });
                    });
                }
            });
        };

        var update_initiative = function() {
            var attrs_to_get = ["dexterity", "dexterity_mod", "initmod"];
            getSectionIDs("repeating_inventory", function(idarray) {
                _.each(idarray, function(currentID, i) {
                    attrs_to_get.push("repeating_inventory_" + currentID + "_equipped");
                    attrs_to_get.push("repeating_inventory_" + currentID + "_itemmodifiers");
                });
                getAttrs(attrs_to_get, function(v) {
                    var update = {};
                    var final_init = parseInt(v["dexterity_mod"], 10);
                    if (v["initmod"] && !isNaN(parseInt(v["initmod"], 10))) {
                        final_init = final_init + parseInt(v["initmod"], 10);
                    }
                    _.each(idarray, function(currentID) {
                        if (v["repeating_inventory_" + currentID + "_equipped"] && v["repeating_inventory_" + currentID + "_equipped"] === "1" && v["repeating_inventory_" + currentID + "_itemmodifiers"] && v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf("ability checks") > -1) {
                            var mods = v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().split(",");
                            _.each(mods, function(mod) {
                                if (mod.indexOf("ability checks") > -1) {
                                    if (mod.indexOf("-") > -1) {
                                        var new_mod = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                        final_init = new_mod ? final_init - new_mod : final_init;
                                    } else {
                                        var new_mod = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                        final_init = new_mod ? final_init + new_mod : final_init;
                                    }
                                }
                            });
                        }
                    });
                    if (final_init % 1 != 0) {
                        final_init = parseFloat(final_init.toPrecision(12));
                    }
                    update["initiative_bonus"] = final_init;
                    setAttrs(update, {
                        silent: true
                    });
                });
            });
        };
        
        var update_mod = function(attr) {
            getAttrs([attr], function(v) {
                var finalattr = v[attr] && isNaN(v[attr]) === false ? Math.floor((parseInt(v[attr], 10) - 10) / 2) : 0;
                var update = {};
                update[attr + "_mod"] = finalattr;
                setAttrs(update);
            });
        };

        var update_passive_perception = function() {
            getAttrs(["pb_type", "passiveperceptionmod", "perception_bonus"], function(v) {
                var passive_perception = 10;
                var mod = !isNaN(parseInt(v["passiveperceptionmod"], 10)) ? parseInt(v["passiveperceptionmod"], 10) : 0;
                var bonus = !isNaN(parseInt(v["perception_bonus"], 10)) ? parseInt(v["perception_bonus"], 10) : 0;
                if (v["pb_type"] && v["pb_type"] === "die" && v["perception_bonus"] && isNaN(v["perception_bonus"]) && v["perception_bonus"].indexOf("+") > -1) {
                    var pieces = v["perception_bonus"].split(/\+|d/);
                    var base = !isNaN(parseInt(pieces[0], 10)) ? parseInt(pieces[0], 10) : 0;
                    var num_dice = !isNaN(parseInt(pieces[1], 10)) ? parseInt(pieces[1], 10) : 1;
                    var half_pb_die = !isNaN(parseInt(pieces[2], 10)) ? parseInt(pieces[2], 10) / 2 : 2;
                    bonus = base + (num_dice * half_pb_die);
                }
                passive_perception = passive_perception + bonus + mod;
                setAttrs({
                    passive_wisdom: passive_perception
                })
            });
        };

        var update_pb = function() {
            callbacks = [];
            getAttrs(["level"], function(v) {
                var update = {};
                var pb = 2;
                var lvl = parseInt(v["level"], 10);
                pb = (Math.ceil((lvl / 4 ) + 1));

                update["pb"] = pb;

                callbacks.push(function() {
                    update_attacks("all");
                });
        
                callbacks.push(function() {
                    update_initiative();
                });
        
                callbacks.push(function() {
                    update_tool("all");
                });
        
                callbacks.push(function() {
                    update_all_saves();
                });
        
                callbacks.push(function() {
                    update_skills(["athletics", "acrobatics", "sleight_of_hand", "stealth", "absorb_cult", "spirit", "history", "comprehension", "qi_control", "investigation", "nature", "religion", "animal_handling", "insight", "medicine", "perception", "survival", "deception", "intimidation", "performance", "persuasion"]);
                });
        
                setAttrs(update, {
                    silent: true
                }, function() {
                    callbacks.forEach(function(callback) {
                        callback();
                    })
                });
            });
        };

        var update_race_display = function() {
            getAttrs(["ancestry", "race"], function(v) {
                var final_race = "";
                if (v.ancestry.toLowerCase() === "human") {
                    v.race = "Bloodline Integration";
                    final_race = v.ancestry;
                } else if (v.ancestry.toLowerCase() === "demi-human") {
                    final_race = v.race + " " + v.ancestry;
                } else if (v.ancestry.toLowerCase() === "beastmen") {
                    final_race = v.race + " " + v.ancestry;
                } else if (v.ancestry.toLowerCase() === "yokai") {
                    final_race = v.race + " " + v.ancestry;
                } else if (v.ancestry.toLowerCase() === "winged") {
                    v.race = "Innate Bloodline";
                    final_race = v.ancestry;
                };
                setAttrs({
                    race_display: final_race
                });
            });
        };
        
        var update_save = function(attr) {
            var save_attrs = [attr + "_mod", attr + "_save_prof", attr + "_save_mod", "pb", "globalsavemod"];
            getSectionIDs("repeating_inventory", function(idarray) {
                _.each(idarray, function(currentID, i) {
                    save_attrs.push("repeating_inventory_" + currentID + "_equipped");
                    save_attrs.push("repeating_inventory_" + currentID + "_itemmodifiers");
                });
        
                getAttrs(save_attrs, function(v) {
                    var attr_mod = v[attr + "_mod"] ? parseInt(v[attr + "_mod"], 10) : 0;
                    var prof = v[attr + "_save_prof"] && v[attr + "_save_prof"] != 0 && !isNaN(v["pb"]) ? parseInt(v["pb"], 10) : 0;
                    var save_mod = v[attr + "_save_mod"] && !isNaN(parseInt(v[attr + "_save_mod"], 10)) ? parseInt(v[attr + "_save_mod"], 10) : 0;
                    var global = v["globalsavemod"] && !isNaN(v["globalsavemod"]) ? parseInt(v["globalsavemod"], 10) : 0;
                    var items = 0;
                    _.each(idarray, function(currentID) {
                        if (v["repeating_inventory_" + currentID + "_equipped"] && v["repeating_inventory_" + currentID + "_equipped"] === "1" && v["repeating_inventory_" + currentID + "_itemmodifiers"] && (v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf("saving throws") > -1 || v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf(attr + " save") > -1)) {
                            var mods = v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().split(",");
                            _.each(mods, function(mod) {
                                if (mod.indexOf(attr + " save") > -1) {
                                    var substr = mod.slice(mod.lastIndexOf(attr + " save") + attr.length + " save".length);
                                    var bonus = substr && substr.length > 0 && !isNaN(parseInt(substr, 10)) ? parseInt(substr, 10) : 0;
                                } else if (mod.indexOf("saving throws") > -1) {
                                    var substr = mod.slice(mod.lastIndexOf("saving throws") + "saving throws".length);
                                    var bonus = substr && substr.length > 0 && !isNaN(parseInt(substr, 10)) ? parseInt(substr, 10) : 0;
                                };
                                if (bonus && bonus != 0) {
                                    items = items + bonus;
                                };
                            });
                        }
                    });
                    var total = attr_mod + prof + save_mod + global + items;
                    var update = {};
                    update[attr + "_save_bonus"] = total;
                    setAttrs(update, {
                        silent: true
                    });
                });
            });
        };

        var update_skills = function(skills_array) {
            var attrs_to_get = ["pb", "pb_type", "strength_mod", "dexterity_mod", "constitution_mod", "intelligence_mod", "wisdom_mod", "charisma_mod"];
            var update = {};
            var callbacks = [];
        
            if (skills_array.indexOf("perception") > -1) {
                callbacks.push(function() {
                    update_passive_perception();
                })
            };
        
            _.each(skills_array, function(s) {
                attrs_to_get.push(s + "_attribute")
                attrs_to_get.push(s + "_prof");
                attrs_to_get.push(s + "_type");
                attrs_to_get.push(s + "_flat");
            });
        
            getSectionIDs("repeating_inventory", function(idarray) {
                _.each(idarray, function(currentID, i) {
                    attrs_to_get.push("repeating_inventory_" + currentID + "_equipped");
                    attrs_to_get.push("repeating_inventory_" + currentID + "_itemmodifiers");
                });
        
                getAttrs(attrs_to_get, function(v) {
                    _.each(skills_array, function(s) {
                        console.log("UPDATING SKILL: " + s);
                        var attr_mod = 0;
                        if (v[s + "_attribute"]) {
                            var attribute = v[s + "_attribute"].toLowerCase() + "_mod";
                            attr_mod = parseInt(v[attribute], 10);
                        }
                        var prof = v[s + "_prof"] != 0 && !isNaN(v["pb"]) ? parseInt(v["pb"], 10) : 0;
                        var flat = v[s + "_flat"] && !isNaN(parseInt(v[s + "_flat"], 10)) ? parseInt(v[s + "_flat"], 10) : 0;
                        var type = v[s + "_type"] && !isNaN(parseInt(v[s + "_type"], 10)) ? parseInt(v[s + "_type"], 10) : 1;
                        var item_bonus = 0;
        
                        _.each(idarray, function(currentID) {
                            if (v["repeating_inventory_" + currentID + "_equipped"] && v["repeating_inventory_" + currentID + "_equipped"] === "1" && v["repeating_inventory_" + currentID + "_itemmodifiers"] && (v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().replace(/ /g, "_").indexOf(s) > -1 || v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().indexOf("ability checks") > -1)) {
                                var mods = v["repeating_inventory_" + currentID + "_itemmodifiers"].toLowerCase().split(",");
                                _.each(mods, function(mod) {
                                    if (mod.replace(/ /g, "_").indexOf(s) > -1 || mod.indexOf("ability checks") > -1) {
                                        if (mod.indexOf("-") > -1) {
                                            var new_mod = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                            item_bonus = new_mod ? item_bonus - new_mod : item_bonus;
                                        } else {
                                            var new_mod = !isNaN(parseInt(mod.replace(/[^0-9]/g, ""), 10)) ? parseInt(mod.replace(/[^0-9]/g, ""), 10) : false;
                                            item_bonus = new_mod ? item_bonus + new_mod : item_bonus;
                                        }
                                    };
                                });
                            };
                        });
        
                        var total = attr_mod + flat + item_bonus;
        
                        if (v["pb_type"] && v["pb_type"] === "die") {
                            if (v[s + "_prof"] != 0) {
                                type === 1 ? "" : "2"
                                total = total + "+" + type + v["pb"];
                            };
                        } else {
                            if (v[s + "_prof"] != 0) {
                                total = total + (prof * type);
                            };
        
                        };
                        update[s + "_bonus"] = total;
                    });
        
                    setAttrs(update, {
                        silent: true
                    }, function() {
                        callbacks.forEach(function(callback) {
                            callback();
                        })
                    });
                });
            });
        };
        
        var update_tool = function(tool_id) {
            if (tool_id.substring(0, 1) === "-" && tool_id.length === 20) {
                do_update_tool([tool_id]);
            } else if (tool_id === "all") {
                getSectionIDs("repeating_tool", function(idarray) {
                    do_update_tool(idarray);
                });
            } else {
                getSectionIDs("repeating_tool", function(idarray) {
                    var tool_attribs = [];
                    _.each(idarray, function(id) {
                        tool_attribs.push("repeating_tool_" + id + "_toolattr_base");
                    });
                    getAttrs(tool_attribs, function(v) {
                        var attr_tool_ids = [];
                        _.each(idarray, function(id) {
                            if (v["repeating_tool_" + id + "_toolattr_base"] && v["repeating_tool_" + id + "_toolattr_base"].indexOf(tool_id) > -1) {
                                attr_tool_ids.push(id);
                            }
                        });
                        if (attr_tool_ids.length > 0) {
                            do_update_tool(attr_tool_ids);
                        }
                    });
                });
            };
        };

        var update_weight = function() {
            var update = {};
            var wtotal = 0;
            var stotal = 0; 
            var weight_attrs = ["cp", "sp", "gp", "ctrb", "ss", "currency_value", "size", "strength", "strength_mod", "carrying_capacity_mod", "inventory_slots_mod", "use_inventory_slots", "itemweightfixed", "itemslotsfixed"];
            getSectionIDs("repeating_inventory", function(idarray) {
                _.each(idarray, function(currentID, i) {
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemweight");
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemcount");
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemsize");
                    weight_attrs.push("repeating_inventory_" + currentID + "_equipped");
                    weight_attrs.push("repeating_inventory_" + currentID + "_carried");
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemcontainer");
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemweightfixed");
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemslotsfixed");
                    weight_attrs.push("repeating_inventory_" + currentID + "_itemcontainer_slots_modifier");
                });
                getAttrs(weight_attrs, function(v) {
                    cp = isNaN(parseInt(v.cp, 10)) === false ? parseInt(v.cp, 10) : 0;
                    sp = isNaN(parseInt(v.sp, 10)) === false ? parseInt(v.sp, 10) : 0;
                    gp = isNaN(parseInt(v.gp, 10)) === false ? parseInt(v.gp, 10) : 0;
                    ctrb = isNaN(parseInt(v.ctrb, 10)) === false ? parseInt(v.ctrb, 10) : 0;
                    ss = isNaN(parseInt(v.ss, 10)) === false ? parseInt(v.ss, 10) : 0;
                    currencyOther = isNaN(parseInt(v.currency_value, 10)) === false ? parseInt(v.currency_value, 10) : 0;
                    wtotal = wtotal + ((cp + sp + gp + ctrb + ss + currencyOther) / 50);
                    stotal += Math.floor(Math.max(0, cp + sp + gp + ctrb + ss + currencyOther - 1) / 100);
                    var slots_modifier = 0;
        
                    _.each(idarray, function(currentID, i) {
                        if (v["repeating_inventory_" + currentID + "_equipped"] == 1 || v["repeating_inventory_" + currentID + "_carried"] == 1) {
                            if (v["repeating_inventory_" + currentID + "_itemcontainer"] == 1) {
                                if (v["repeating_inventory_" + currentID + "_equipped"] == 1) {
                                    var field_id = "repeating_inventory_" + currentID + "_itemcontainer_slots_modifier";
                                    if (v[field_id]) {
                                        if (["+", "-"].indexOf(v[field_id]) > -1) {
                                            var operator = v[field_id].substring(0, 1);
                                            var value = v[field_id].substring(1);
                                            if (isNaN(parseInt(value, 10)) === false) {
                                                if (operator == "+") {
                                                    slots_modifier += parseInt(value, 10);
                                                } else if (operator == "-") {
                                                    slots_modifier -= parseInt(value, 10);
                                                }
                                            }
                                        } else {
                                            if (isNaN(parseInt(v[field_id], 10)) === false) {
                                                slots_modifier += parseInt(v[field_id], 10);
                                            }
                                        }
                                    }
                                }
                            } else {
                                if (v["repeating_inventory_" + currentID + "_itemweight"] && isNaN(parseInt(v["repeating_inventory_" + currentID + "_itemweight"], 10)) === false) {
                                    if (v["repeating_inventory_" + currentID + "_itemweightfixed"] == 1) {
                                        wtotal += parseFloat(v["repeating_inventory_" + currentID + "_itemweight"]);
                                    } else {
                                        count = v["repeating_inventory_" + currentID + "_itemcount"] && isNaN(parseFloat(v["repeating_inventory_" + currentID + "_itemcount"])) === false ? parseFloat(v["repeating_inventory_" + currentID + "_itemcount"]) : 1;
                                        wtotal = wtotal + (parseFloat(v["repeating_inventory_" + currentID + "_itemweight"]) * count);
                                    }
                                }
                                if (v["repeating_inventory_" + currentID + "_itemsize"] && isNaN(parseInt(v["repeating_inventory_" + currentID + "_itemsize"], 10)) === false) {
                                    if (v["repeating_inventory_" + currentID + "_itemslotsfixed"] == 1) {
                                        stotal += parseFloat(v["repeating_inventory_" + currentID + "_itemsize"]);
                                    } else {
                                        count = v["repeating_inventory_" + currentID + "_itemcount"] && isNaN(parseFloat(v["repeating_inventory_" + currentID + "_itemcount"])) === false ? parseFloat(v["repeating_inventory_" + currentID + "_itemcount"]) : 1;
                                        stotal = stotal + (parseFloat(v["repeating_inventory_" + currentID + "_itemsize"]) * count);
                                    }
                                }
                            }
                        }
                    });
                    wtotal = Math.round(wtotal * 100) / 100;
                    stotal = Math.round(stotal * 100) / 100;
        
                    update["weighttotal"] = wtotal;
                    update["slotstotal"] = stotal;
        
                    if (v["use_inventory_slots"] == 1) {
        
                        var size_slots = 18;
                        if (v["size"] && v["size"] != "") {
                            if (v["size"].toLowerCase().trim() == "tiny") {
                                size_slots = 9
                            } else if (v["size"].toLowerCase().trim() == "small") {
                                size_slots = 15
                            } else if (v["size"].toLowerCase().trim() == "large") {
                                size_slots = 21
                            } else if (v["size"].toLowerCase().trim() == "huge") {
                                size_slots = 27
                            } else if (v["size"].toLowerCase().trim() == "gargantuan") {
                                size_slots = 39
                            }
                        }
        
                        size_slots += parseInt(v.strength_mod, 10);
        
                        if (v.inventory_slots_mod) {
                            var operator = v.inventory_slots_mod.substring(0, 1);
                            var value = v.inventory_slots_mod.substring(1);
                            if (["*", "x", "+", "-"].indexOf(operator) > -1 && isNaN(parseInt(value, 10)) === false) {
                                if (operator == "*" || operator == "x") {
                                    size_slots *= parseInt(value, 10);
                                } else if (operator == "+") {
                                    size_slots += parseInt(value, 10);
                                } else if (operator == "-") {
                                    size_slots -= parseInt(value, 10);
                                }
                            }
                        }
        
                        size_slots += slots_modifier;
        
                        update["slotsmaximum"] = size_slots;
                        if (stotal > size_slots) {
                            update["encumberance"] = "OVER CARRYING CAPACITY";
                        } else {
                            update["encumberance"] = " ";
                        }
        
                    } else {
        
                        var str_base = parseInt(v.strength, 10);
                        var size_multiplier = 1;
                        if (v["size"] && v["size"] != "") {
                            if (v["size"].toLowerCase().trim() == "tiny") {
                                size_multiplier = .5
                            } else if (v["size"].toLowerCase().trim() == "large") {
                                size_multiplier = 2
                            } else if (v["size"].toLowerCase().trim() == "huge") {
                                size_multiplier = 4
                            } else if (v["size"].toLowerCase().trim() == "gargantuan") {
                                size_multiplier = 8
                            }
                        }
                        var str = str_base * size_multiplier;
                        if (v.carrying_capacity_mod) {
                            var operator = v.carrying_capacity_mod.substring(0, 1);
                            var value = v.carrying_capacity_mod.substring(1);
                            if (["*", "x", "+", "-"].indexOf(operator) > -1 && isNaN(parseInt(value, 10)) === false) {
                                if (operator == "*" || operator == "x") {
                                    str *= parseInt(value, 10);
                                } else if (operator == "+") {
                                    str += parseInt(value, 10);
                                } else if (operator == "-") {
                                    str -= parseInt(value, 10);
                                }
                            }
                        }
        
                        update["weightmaximum"] = str * 15;
                        if (!v.encumberance_setting || v.encumberance_setting === "off") {
                            if (wtotal > str * 15) {
                                update["encumberance"] = "OVER CARRYING CAPACITY";
                            } else {
                                update["encumberance"] = " ";
                            }
                        } else {
                            update["encumberance"] = " ";
                        }
                    }
        
                    setAttrs(update, {
                        silent: true
                    });
                });
            });
        };
        
        // <!-- SET FUNCTIONS -->
        
        var set_level = function() {
            getAttrs(["minor_realm", "major_realm", "level", "class", "subclass"], function(v) {
                var update = {};
                var callbacks = [];
                var finallevel = 1;
                var major = v.major_realm;
                var minor = v.minor_realm;
                var minor_add = 0;
                var charclass = v.class;
                var subclass = v.subclass 
        
                if (charclass == "Beast Tamer"){
                    subclass = " ";
                } else if (charclass == "Bow"){
                    subclass = " ";
                } else if (charclass == "Corpse"){
                    subclass = " ";
                } else if (charclass == "Poison"){
                    subclass = " ";
                } else if (charclass == "Psychic"){
                    subclass = " ";
                } else if (charclass == "Puppet"){
                    subclass = " ";
                } else if (charclass == "Sabre"){
                    subclass = " ";
                } else if (charclass == "Spear"){
                    subclass = " ";
                };
        
                var class_display = subclass + " " + charclass;
        
                if (minor == "Early"){
                    minor_add = 0;
                } else if (minor == "Middle"){
                    minor_add = 1;
                } else if (minor == "Late"){
                    minor_add = 2;
                } else{
                    minor_add = 3;
                };
        
                if (major == "Qi-Gathering"){
                    finallevel = 1 + minor_add;
                } else if (major == "Foundation"){
                    finallevel = 5 + minor_add;
                } else if (major == "Core Formation"){
                    finallevel = 9 + minor_add;
                } else if (major == "Martial Soul"){
                    finallevel = 13 + minor_add;
                } else if (major == "God Ascendance"){
                    finallevel = 17 + minor_add;
                } else{
                    finallevel = 0;
                };
                
                var level_display = minor + " " + major + " (" + finallevel + ")";
        
                update["level"] = finallevel;
                update["level_display"] = level_display;
                update["class_display"] = class_display;
        
                callbacks.push(function() {
                    update_pb();
                });
        
                setAttrs(update, {
                    silent: true
                }, function() {
                    callbacks.forEach(function(callback) {
                        callback();
                    })
                });
            });
        };
        
        // <!-- DO FUNCTIONS -->
        
        var do_update_attack = function(attack_array, source) {
            var attack_attribs = ["level", "d20", "pb", "pbd_safe", "dtype", "strength_mod", "dexterity_mod", "constitution_mod", "intelligence_mod", "wisdom_mod", "charisma_mod"];
            _.each(attack_array, function(attackid) {
                attack_attribs.push("repeating_attack_" + attackid + "_atkflag");
                attack_attribs.push("repeating_attack_" + attackid + "_atkname");
                attack_attribs.push("repeating_attack_" + attackid + "_atkattr_base");
                attack_attribs.push("repeating_attack_" + attackid + "_atkmod");
                attack_attribs.push("repeating_attack_" + attackid + "_atkprofflag");
                attack_attribs.push("repeating_attack_" + attackid + "_atkbonus");
                attack_attribs.push("repeating_attack_" + attackid + "_dmgflag");
                attack_attribs.push("repeating_attack_" + attackid + "_dmgbase");
                attack_attribs.push("repeating_attack_" + attackid + "_dmgattr");
                attack_attribs.push("repeating_attack_" + attackid + "_dmgmod");
                attack_attribs.push("repeating_attack_" + attackid + "_dmgtype");
                attack_attribs.push("repeating_attack_" + attackid + "_dmg2flag");
                attack_attribs.push("repeating_attack_" + attackid + "_dmg2base");
                attack_attribs.push("repeating_attack_" + attackid + "_dmg2attr");
                attack_attribs.push("repeating_attack_" + attackid + "_dmg2mod");
                attack_attribs.push("repeating_attack_" + attackid + "_dmg2type");
                attack_attribs.push("repeating_attack_" + attackid + "_dmgcustcrit");
                attack_attribs.push("repeating_attack_" + attackid + "_dmg2custcrit");
                attack_attribs.push("repeating_attack_" + attackid + "_saveflag");
                attack_attribs.push("repeating_attack_" + attackid + "_savedc");
                attack_attribs.push("repeating_attack_" + attackid + "_saveeffect");
                attack_attribs.push("repeating_attack_" + attackid + "_saveflat");
                attack_attribs.push("repeating_attack_" + attackid + "_hldmg");
                attack_attribs.push("repeating_attack_" + attackid + "_atkrange");
                attack_attribs.push("repeating_attack_" + attackid + "_itemid");
                attack_attribs.push("repeating_attack_" + attackid + "_ammo");
                attack_attribs.push("repeating_attack_" + attackid + "_global_damage_mod_field");
            });
        
            getAttrs(attack_attribs, function(v) {
                _.each(attack_array, function(attackid) {
                    var callbacks = [];
                    var update = {};
                    var hbonus = "";
                    var hdmg1 = "";
                    var hdmg2 = "";
                    var dmg = "";
                    var dmg2 = "";
                    var rollbase = "";
                    var magicattackmod = 0;
                    var atkattr_abrev = "";
                    var dmgattr_abrev = "";
                    var dmg2attr_abrev = "";
                    var pbd_safe = v["pbd_safe"] ? v["pbd_safe"] : "";
                    var hldmgcrit = v["repeating_attack_" + attackid + "_hldmg"] && v["repeating_attack_" + attackid + "_hldmg"] != "" ? v["repeating_attack_" + attackid + "_hldmg"].slice(0, 7) + "crit" + v["repeating_attack_" + attackid + "_hldmg"].slice(7) : "";
        
                    if (!v["repeating_attack_" + attackid + "_atkattr_base"] || v["repeating_attack_" + attackid + "_atkattr_base"] === "0") {
                        atkattr_base = 0
                    } else if (v["repeating_attack_" + attackid + "_atkattr_base"] && v["repeating_attack_" + attackid + "_atkattr_base"] === "spell") {
                        atkattr_base = parseInt(v[v["spellcasting_ability"].substring(2, v["spellcasting_ability"].length - 2)], 10);
                        atkattr_abrev = v["spellcasting_ability"].substring(2, 5).toUpperCase();
                    } else {
                        atkattr_base = parseInt(v[v["repeating_attack_" + attackid + "_atkattr_base"].substring(2, v["repeating_attack_" + attackid + "_atkattr_base"].length - 1)], 10);
                        atkattr_abrev = v["repeating_attack_" + attackid + "_atkattr_base"].substring(2, 5).toUpperCase();
                    };
        
                    if (!v["repeating_attack_" + attackid + "_dmgattr"] || v["repeating_attack_" + attackid + "_dmgattr"] === "0") {
                        dmgattr = 0;
                    } else if (v["repeating_attack_" + attackid + "_dmgattr"] && v["repeating_attack_" + attackid + "_dmgattr"] === "spell") {
                        dmgattr = parseInt(v[v["spellcasting_ability"].substring(2, v["spellcasting_ability"].length - 2)], 10);
                        dmgattr_abrev = v["spellcasting_ability"].substring(2, 5).toUpperCase();
                    } else {
                        dmgattr = parseInt(v[v["repeating_attack_" + attackid + "_dmgattr"].substring(2, v["repeating_attack_" + attackid + "_dmgattr"].length - 1)], 10);
                        dmgattr_abrev = v["repeating_attack_" + attackid + "_dmgattr"].substring(2, 5).toUpperCase();
                    };
        
                    if (!v["repeating_attack_" + attackid + "_dmg2attr"] || v["repeating_attack_" + attackid + "_dmg2attr"] === "0") {
                        dmg2attr = 0;
                    } else if (v["repeating_attack_" + attackid + "_dmg2attr"] && v["repeating_attack_" + attackid + "_dmg2attr"] === "spell") {
                        dmg2attr = parseInt(v[v["spellcasting_ability"].substring(2, v["spellcasting_ability"].length - 2)], 10);
                        dmg2attr_abrev = v["spellcasting_ability"].substring(2, 5).toUpperCase();
                    } else {
                        dmg2attr = parseInt(v[v["repeating_attack_" + attackid + "_dmg2attr"].substring(2, v["repeating_attack_" + attackid + "_dmg2attr"].length - 1)], 10);
                        dmg2attr_abrev = v["repeating_attack_" + attackid + "_dmg2attr"].substring(2, 5).toUpperCase();
                    };
        
                    var dmgbase = v["repeating_attack_" + attackid + "_dmgbase"] && v["repeating_attack_" + attackid + "_dmgbase"] != "" ? v["repeating_attack_" + attackid + "_dmgbase"] : 0;
                    var dmg2base = v["repeating_attack_" + attackid + "_dmg2base"] && v["repeating_attack_" + attackid + "_dmg2base"] != "" ? v["repeating_attack_" + attackid + "_dmg2base"] : 0;
                    var dmgmod = v["repeating_attack_" + attackid + "_dmgmod"] && isNaN(parseInt(v["repeating_attack_" + attackid + "_dmgmod"], 10)) === false ? parseInt(v["repeating_attack_" + attackid + "_dmgmod"], 10) : 0;
                    var dmg2mod = v["repeating_attack_" + attackid + "_dmg2mod"] && isNaN(parseInt(v["repeating_attack_" + attackid + "_dmg2mod"], 10)) === false ? parseInt(v["repeating_attack_" + attackid + "_dmg2mod"], 10) : 0;
                    var dmgtype = v["repeating_attack_" + attackid + "_dmgtype"] ? v["repeating_attack_" + attackid + "_dmgtype"] + " " : "";
                    var dmg2type = v["repeating_attack_" + attackid + "_dmg2type"] ? v["repeating_attack_" + attackid + "_dmg2type"] + " " : "";
                    var pb = v["repeating_attack_" + attackid + "_atkprofflag"] && v["repeating_attack_" + attackid + "_atkprofflag"] != 0 && v.pb ? v.pb : 0;
                    var atkmod = v["repeating_attack_" + attackid + "_atkmod"] && v["repeating_attack_" + attackid + "_atkmod"] != "" ? parseInt(v["repeating_attack_" + attackid + "_atkmod"], 10) : 0;
                    var atkmag = v["repeating_attack_" + attackid + "_atkmagic"] && v["repeating_attack_" + attackid + "_atkmagic"] != "" ? parseInt(v["repeating_attack_" + attackid + "_atkmagic"], 10) : 0;
                    var dmgmag = isNaN(atkmag) === false && atkmag != 0 && ((v["repeating_attack_" + attackid + "_dmgflag"] && v["repeating_attack_" + attackid + "_dmgflag"] != 0) || (v["repeating_attack_" + attackid + "_dmg2flag"] && v["repeating_attack_" + attackid + "_dmg2flag"] != 0)) ? "+ " + atkmag + " Magic Bonus" : "";
                    if (v["repeating_attack_" + attackid + "_atkflag"] && v["repeating_attack_" + attackid + "_atkflag"] != 0) {
                        bonus_mod = atkattr_base + atkmod + atkmag + magicattackmod;
                        if (v["pb_type"] && v["pb_type"] === "die") {
                            plus_minus = bonus_mod > -1 ? "+" : "";
                            bonus = bonus_mod + "+" + pb;
                        } else {
                            bonus_mod = bonus_mod + parseInt(pb, 10);
                            plus_minus = bonus_mod > -1 ? "+" : "";
                            bonus = plus_minus + bonus_mod;
                        };
                    } else if (v["repeating_attack_" + attackid + "_saveflag"] && v["repeating_attack_" + attackid + "_saveflag"] != 0) {
                        if (!v["repeating_attack_" + attackid + "_savedc"] || (v["repeating_attack_" + attackid + "_savedc"] && v["repeating_attack_" + attackid + "_savedc"] === "(@{spell_save_dc})")) {
                            var tempdc = v["spell_save_dc"];
                        } else if (v["repeating_attack_" + attackid + "_savedc"] && v["repeating_attack_" + attackid + "_savedc"] === "(@{saveflat})") {
                            var tempdc = isNaN(parseInt(v["repeating_attack_" + attackid + "_saveflat"])) === false ? parseInt(v["repeating_attack_" + attackid + "_saveflat"]) : "0";
                        } else {
                            var savedcattr = v["repeating_attack_" + attackid + "_savedc"].replace(/^[^{]*{/, "").replace(/\_.*$/, "");
                            var safe_pb = v["pb_type"] && v["pb_type"] === "die" ? parseInt(pb.substring(1), 10) / 2 : parseInt(pb, 10);
                            var safe_attr = v[savedcattr + "_mod"] ? parseInt(v[savedcattr + "_mod"], 10) : 0;
                            var tempdc = 8 + safe_attr + safe_pb;
                        };
                        bonus = "DC" + tempdc;
                    } else {
                        bonus = "-";
                    }
                    if (v["repeating_attack_" + attackid + "_dmgflag"] && v["repeating_attack_" + attackid + "_dmgflag"] != 0) {
                        if (dmgbase === 0 && (dmgattr + dmgmod === 0)) {
                            dmg = 0;
                        }
                        if (dmgbase != 0) {
                            dmg = dmgbase;
                        }
                        if (dmgbase != 0 && (dmgattr + dmgmod != 0)) {
                            dmg = dmgattr + dmgmod > 0 ? dmg + "+" : dmg;
                        }
                        if (dmgattr + dmgmod != 0) {
                            dmg = dmg + (dmgattr + dmgmod);
                        }
                        dmg = dmg + " " + dmgtype;
                    } else {
                        dmg = "";
                    };
                    if (v["repeating_attack_" + attackid + "_dmg2flag"] && v["repeating_attack_" + attackid + "_dmg2flag"] != 0) {
                        if (dmg2base === 0 && (dmg2attr + dmg2mod === 0)) {
                            dmg2 = 0;
                        }
                        if (dmg2base != 0) {
                            dmg2 = dmg2base;
                        }
                        if (dmg2base != 0 && (dmg2attr + dmg2mod != 0)) {
                            dmg2 = dmg2attr + dmg2mod > 0 ? dmg2 + "+" : dmg2;
                        }
                        if (dmg2attr + dmg2mod != 0) {
                            dmg2 = dmg2 + (dmg2attr + dmg2mod);
                        }
                        dmg2 = dmg2 + " " + dmg2type;
                    } else {
                        dmg2 = "";
                    };
                    dmgspacer = v["repeating_attack_" + attackid + "_dmgflag"] && v["repeating_attack_" + attackid + "_dmgflag"] != 0 && v["repeating_attack_" + attackid + "_dmg2flag"] && v["repeating_attack_" + attackid + "_dmg2flag"] != 0 ? "+ " : "";
                    crit1 = v["repeating_attack_" + attackid + "_dmgcustcrit"] && v["repeating_attack_" + attackid + "_dmgcustcrit"] != "" ? v["repeating_attack_" + attackid + "_dmgcustcrit"] : dmgbase;
                    crit2 = v["repeating_attack_" + attackid + "_dmg2custcrit"] && v["repeating_attack_" + attackid + "_dmg2custcrit"] != "" ? v["repeating_attack_" + attackid + "_dmg2custcrit"] : dmg2base;
                    r1 = v["repeating_attack_" + attackid + "_atkflag"] && v["repeating_attack_" + attackid + "_atkflag"] != 0 ? "@{d20}" : "0d20";
                    r2 = v["repeating_attack_" + attackid + "_atkflag"] && v["repeating_attack_" + attackid + "_atkflag"] != 0 ? "@{rtype}" : "{{r2=[[0d20";
                    if (v["repeating_attack_" + attackid + "_atkflag"] && v["repeating_attack_" + attackid + "_atkflag"] != 0) {
                        if (magicattackmod != 0) {
                            hbonus = " + " + magicattackmod + "[SPELLATK]" + hbonus
                        };
                        if (atkmag != 0) {
                            hbonus = " + " + atkmag + "[MAGIC]" + hbonus
                        };
                        if (pb != 0) {
                            hbonus = " + " + pb + pbd_safe + "[PROF]" + hbonus
                        };
                        if (atkmod != 0) {
                            hbonus = " + " + atkmod + "[MOD]" + hbonus
                        };
                        if (atkattr_base != 0) {
                            hbonus = " + " + atkattr_base + "[" + atkattr_abrev + "]" + hbonus
                        };
                    } else {
                        hbonus = "";
                    }
                    if (v["repeating_attack_" + attackid + "_dmgflag"] && v["repeating_attack_" + attackid + "_dmgflag"] != 0) {
                        if (atkmag != 0) {
                            hdmg1 = " + " + atkmag + "[MAGIC]" + hdmg1
                        };
                        if (dmgmod != 0) {
                            hdmg1 = " + " + dmgmod + "[MOD]" + hdmg1
                        };
                        if (dmgattr != 0) {
                            hdmg1 = " + " + dmgattr + "[" + dmgattr_abrev + "]" + hdmg1
                        };
                        hdmg1 = dmgbase + hdmg1;
                    } else {
                        hdmg1 = "0";
                    }
                    if (v["repeating_attack_" + attackid + "_dmg2flag"] && v["repeating_attack_" + attackid + "_dmg2flag"] != 0) {
                        if (dmg2mod != 0) {
                            hdmg2 = " + " + dmg2mod + "[MOD]" + hdmg2
                        };
                        if (dmg2attr != 0) {
                            hdmg2 = " + " + dmg2attr + "[" + dmg2attr_abrev + "]" + hdmg2
                        };
                        hdmg2 = dmg2base + hdmg2;
                    } else {
                        hdmg2 = "0";
                    }
                    var globaldamage = `[[${v.global_damage_mod_roll && v.global_damage_mod_roll !== "" ? v.global_damage_mod_roll : "0"}]]`;
                    var globaldamagecrit = `[[${v.global_damage_mod_crit && v.global_damage_mod_crit !== "" ? v.global_damage_mod_crit : "0"}]]`;
                    if (v.dtype === "full") {
                        pickbase = "full";
                        rollbase = "@{wtype}&{template:atkdmg} {{mod=@{atkbonus}}} {{rname=@{atkname}}} {{r1=[[" + r1 + "cs>@{atkcritrange}" + hbonus + "]]}} " + r2 + "cs>@{atkcritrange}" + hbonus + "]]}} @{atkflag} {{range=@{atkrange}}} @{dmgflag} {{dmg1=[[" + hdmg1 + "]]}} {{dmg1type=" + dmgtype + "}} @{dmg2flag} {{dmg2=[[" + hdmg2 + "]]}} {{dmg2type=" + dmg2type + "}} {{crit1=[[" + crit1 + "[CRIT]]]}} {{crit2=[[" + crit2 + "[CRIT]]]}} @{saveflag} {{desc=@{atk_desc}}} " + hldmgcrit + " {{globaldamage=" + globaldamage + "}} {{globaldamagecrit=" + globaldamagecrit + "}} {{globaldamagetype=@{global_damage_mod_type}}} @{character_name}";
                    } else if (v["repeating_attack_" + attackid + "_atkflag"] && v["repeating_attack_" + attackid + "_atkflag"] != 0) {
                        pickbase = "pick";
                        rollbase = "@{wtype}&{template:atk} {{mod=@{atkbonus}}} {{rname=[@{atkname}](~repeating_attack_attack_dmg)}} {{rnamec=[@{atkname}](~repeating_attack_attack_crit)}} {{r1=[[" + r1 + "cs>@{atkcritrange}" + hbonus + "]]}} " + r2 + "cs>@{atkcritrange}" + hbonus + "]]}} {{range=@{atkrange}}} {{desc=@{atk_desc}}} @{character_name}";
                    } else if (v["repeating_attack_" + attackid + "_dmgflag"] && v["repeating_attack_" + attackid + "_dmgflag"] != 0) {
                        pickbase = "dmg";
                        rollbase = "@{wtype}&{template:dmg} {{rname=@{atkname}}} @{atkflag} {{range=@{atkrange}}} @{dmgflag} {{dmg1=[[" + hdmg1 + "]]}} {{dmg1type=" + dmgtype + "}} @{dmg2flag} {{dmg2=[[" + hdmg2 + "]]}} {{dmg2type=" + dmg2type + "}} @{saveflag} {{desc=@{atk_desc}}} @{character_name}"
                    } else {
                        pickbase = "empty";
                        rollbase = "@{wtype}&{template:dmg} {{rname=@{atkname}}} @{atkflag} {{range=@{atkrange}}} @{saveflag} {{desc=@{atk_desc}}} @{character_name}"
                    }
                    update["repeating_attack_" + attackid + "_rollbase_dmg"] = "@{wtype}&{template:dmg} {{rname=@{atkname}}} @{atkflag} {{range=@{atkrange}}} @{dmgflag} {{dmg1=[[" + hdmg1 + "]]}} {{dmg1type=" + dmgtype + "}} @{dmg2flag} {{dmg2=[[" + hdmg2 + "]]}} {{dmg2type=" + dmg2type + "}} @{saveflag} {{desc=@{atk_desc}}} @{character_name}";
                    update["repeating_attack_" + attackid + "_rollbase_crit"] = "@{wtype}&{template:dmg} {{crit=1}} {{rname=@{atkname}}} @{atkflag} {{range=@{atkrange}}} @{dmgflag} {{dmg1=[[" + hdmg1 + "]]}} {{dmg1type=" + dmgtype + "}} @{dmg2flag} {{dmg2=[[" + hdmg2 + "]]}} {{dmg2type=" + dmg2type + "}} {{crit1=[[" + crit1 + "]]}} {{crit2=[[" + crit2 + "]]}} @{saveflag} {{desc=@{atk_desc}}} " + hldmgcrit + " {{globaldamage=" + globaldamage + "}} {{globaldamagecrit=" + globaldamagecrit + "}} {{globaldamagetype=@{global_damage_mod_type}}} @{character_name}"
                    update["repeating_attack_" + attackid + "_atkbonus"] = bonus;
                    update["repeating_attack_" + attackid + "_atkdmgtype"] = dmg + dmgspacer + dmg2 + dmgmag + " ";
                    update["repeating_attack_" + attackid + "_rollbase"] = rollbase;
                    if (v["repeating_attack_" + attackid + "_spellid"] && v["repeating_attack_" + attackid + "_spellid"] != "" && (!source || source && source != "spell") && v["repeating_attack_" + attackid + "_spellid"].length == 20) {
                        var spellid = v["repeating_attack_" + attackid + "_spellid"];
                        var lvl = v["repeating_attack_" + attackid + "_spelllevel"];
                        callbacks.push(function() {
                            update_spell_from_attack(lvl, spellid, attackid);
                        });
                    }
                    if (v["repeating_attack_" + attackid + "_itemid"] && v["repeating_attack_" + attackid + "_itemid"] != "" && (!source || source && source != "item")) {
                        var itemid = v["repeating_attack_" + attackid + "_itemid"];
                        callbacks.push(function() {
                            update_item_from_attack(itemid, attackid);
                        });
                    }
                    setAttrs(update, {
                        silent: true
                    }, function() {
                        callbacks.forEach(function(callback) {
                            callback();
                        })
                    });
                });
            });
        };
        
        var do_update_tool = function(tool_array) {
            var tool_attribs = ["pb", "pb_type", "strength_mod", "dexterity_mod", "constitution_mod", "intelligence_mod", "wisdom_mod", "charisma_mod"];
            var update = {};
            _.each(tool_array, function(tool_id) {
                tool_attribs.push("repeating_tool_" + tool_id + "_toolbonus_base");
                tool_attribs.push("repeating_tool_" + tool_id + "_tool_mod");
                tool_attribs.push("repeating_tool_" + tool_id + "_toolattr_base");
            });
        
            getAttrs(tool_attribs, function(v) {
                _.each(tool_array, function(tool_id) {
                    console.log("UPDATING TOOL: " + tool_id);
                    var query = false;
                    if (v["repeating_tool_" + tool_id + "_toolattr_base"] && v["repeating_tool_" + tool_id + "_toolattr_base"].substring(0, 2) === "?{") {
                        update["repeating_tool_" + tool_id + "_toolattr"] = "QUERY";
                        var mod = "?{Attribute?|Strength,@{strength_mod}|Dexterity,@{dexterity_mod}|Constitution,@{constitution_mod}|Intelligence,@{intelligence_mod}|Wisdom,@{wisdom_mod}|Charisma,@{charisma_mod}}";
                        if (v["repeating_tool_" + tool_id + "_tool_mod"]) {
                            mod = mod + "+" + v["repeating_tool_" + tool_id + "_tool_mod"];
                        }
                        query = true;
                    } else {
                        var attr = v["repeating_tool_" + tool_id + "_toolattr_base"].substring(0, v["repeating_tool_" + tool_id + "_toolattr_base"].length - 5).substr(2);
                        var attr_mod = v[attr + "_mod"] ? parseInt(v[attr + "_mod"], 10) : 0;
                        var tool_mod = v["repeating_tool_" + tool_id + "_tool_mod"] && !isNaN(parseInt(v["repeating_tool_" + tool_id + "_tool_mod"], 10)) ? parseInt(v["repeating_tool_" + tool_id + "_tool_mod"], 10) : 0;
                        var mod = attr_mod + tool_mod;
                        if (v["repeating_tool_" + tool_id + "_toolattr_base"] && v["repeating_tool_" + tool_id + "_toolattr_base"].substring(0, 1) === "0"){
                            update["repeating_tool_" + tool_id + "_toolattr"] = "NONE";
                        } else {
                            update["repeating_tool_" + tool_id + "_toolattr"] = attr.toUpperCase();
                        }
                        if (v["repeating_tool_" + tool_id + "_tool_mod"] && v["repeating_tool_" + tool_id + "_tool_mod"].indexOf("@{") > -1) {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = update["repeating_tool_" + tool_id + "_toolbonus"] + "+" + v["repeating_tool_" + tool_id + "_tool_mod"];
                        }
                        if (!v["repeating_tool_" + tool_id + "_tool_mod"]) {
                            update["repeating_tool_" + tool_id + "_tool_mod"] = 0;
                        }
                    };
        
                    if (v["pb_type"] && v["pb_type"] === "die") {
                        if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "(@{pb})") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod + "+" + v.pb
                        } else if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "(@{pb}*2)") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod + "+2" + v.pb
                        } else if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "0") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod
                        };
                    } else if (v["repeating_tool_" + tool_id + "_toolattr_base"] && v["repeating_tool_" + tool_id + "_toolattr_base"].substring(0, 2) === "?{") {
                        if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "(@{pb})") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod + "+" + parseInt(v.pb, 10)
                        } else if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "(@{pb}*2)") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod + "+" + (parseInt(v.pb, 10) * 2)
                        } else if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "0") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod
                        };
                    } else {
                        if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "(@{pb})") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod + parseInt(v.pb, 10)
                        } else if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "(@{pb}*2)") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod + (parseInt(v.pb, 10) * 2)
                        } else if (v["repeating_tool_" + tool_id + "_toolbonus_base"] === "0") {
                            update["repeating_tool_" + tool_id + "_toolbonus"] = mod
                        };
                    };
        
                    if (query) {
                        update["repeating_tool_" + tool_id + "_toolbonus_display"] = "?";
                    } else {
                        update["repeating_tool_" + tool_id + "_toolbonus_display"] = update["repeating_tool_" + tool_id + "_toolbonus"];
                    };
        
                });
        
                setAttrs(update, {
                    silent: true
                });
            });
        };
        
        // <!-- CHECK FUNCTIONS -->
        
        var check_customac = function(attr) {
            getAttrs(["custom_ac_flag", "custom_ac_part1", "custom_ac_part2"], function(v) {
                if (v["custom_ac_flag"] && v["custom_ac_flag"] === "1" && ((v["custom_ac_part1"] && v["custom_ac_part1"] === attr) || (v["custom_ac_part2"] && v["custom_ac_part2"] === attr))) {
                    update_ac();
                }
            });
        };
        
        var check_itemmodifiers = function(modifiers, previousValue) {
            var mods = modifiers.toLowerCase().split(",");
            if (previousValue) {
                prevmods = previousValue.toLowerCase().split(",");
                mods = _.union(mods, prevmods);
            };
            _.each(mods, function(mod) {
                if (mod.indexOf("ac:") > -1 || mod.indexOf("ac +") > -1 || mod.indexOf("ac -") > -1) {
                    update_ac();
                };
                if (mod.indexOf("spell") > -1) {
                    update_spell_info();
                };
                if (mod.indexOf("saving throws") > -1) {
                    update_all_saves();
                };
                if (mod.indexOf("strength save") > -1) {
                    update_save("strength");
                } else if (mod.indexOf("strength") > -1) {
                    update_attr("strength");
                };
                if (mod.indexOf("dexterity save") > -1) {
                    update_save("dexterity");
                } else if (mod.indexOf("dexterity") > -1) {
                    update_attr("dexterity");
                };
                if (mod.indexOf("constitution save") > -1) {
                    update_save("constitution");
                } else if (mod.indexOf("constitution") > -1) {
                    update_attr("constitution");
                };
                if (mod.indexOf("intelligence save") > -1) {
                    update_save("intelligence");
                } else if (mod.indexOf("intelligence") > -1) {
                    update_attr("intelligence");
                };
                if (mod.indexOf("wisdom save") > -1) {
                    update_save("wisdom");
                } else if (mod.indexOf("wisdom") > -1) {
                    update_attr("wisdom");
                };
                if (mod.indexOf("charisma save") > -1) {
                    update_save("charisma");
                } else if (mod.indexOf("charisma") > -1) {
                    update_attr("charisma");
                };
                if (mod.indexOf("ability checks") > -1) {
                    update_all_ability_checks();
                };
                if (mod.indexOf("acrobatics") > -1) {
                    update_skills(["acrobatics"]);
                };
                if (mod.indexOf("animal handling") > -1) {
                    update_skills(["animal_handling"]);
                };
                if (mod.indexOf("arcana") > -1) {
                    update_skills(["arcana"]);
                };
                if (mod.indexOf("athletics") > -1) {
                    update_skills(["athletics"]);
                };
                if (mod.indexOf("deception") > -1) {
                    update_skills(["deception"]);
                };
                if (mod.indexOf("history") > -1) {
                    update_skills(["history"]);
                };
                if (mod.indexOf("insight") > -1) {
                    update_skills(["insight"]);
                };
                if (mod.indexOf("intimidation") > -1) {
                    update_skills(["intimidation"]);
                };
                if (mod.indexOf("investigation") > -1) {
                    update_skills(["investigation"]);
                };
                if (mod.indexOf("medicine") > -1) {
                    update_skills(["medicine"]);
                };
                if (mod.indexOf("nature") > -1) {
                    update_skills(["nature"]);
                };
                if (mod.indexOf("perception") > -1) {
                    update_skills(["perception"]);
                };
                if (mod.indexOf("performance") > -1) {
                    update_skills(["performance"]);
                };
                if (mod.indexOf("persuasion") > -1) {
                    update_skills(["persuasion"]);
                };
                if (mod.indexOf("religion") > -1) {
                    update_skills(["religion"]);
                };
                if (mod.indexOf("sleight of hand") > -1) {
                    update_skills(["sleight_of_hand"]);
                };
                if (mod.indexOf("stealth") > -1) {
                    update_skills(["stealth"]);
                };
                if (mod.indexOf("survival") > -1) {
                    update_skills(["survival"]);
                };
            });
        };
        
        // <!-- REMOVE FUNCTIONS -->
        
        var remove_attack = function(attackid) {
            removeRepeatingRow("repeating_attack_" + attackid);
        };
        
        // <!-- LET FUNCTIONS -->
        
        let clamp = function(value, min, max) {
            return Math.min(Math.max(value, min), max);
        };
        
        let isDefined = function(value) {
            return value !== null && typeof(value) !== 'undefined';
        };
        
        let toInt = function(value) {
            return (value && !isNaN(value)) ? parseInt(value) : 0;
        };
    </script>
</div>
